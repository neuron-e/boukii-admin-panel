<div class="season-form-container">
  <div class="form-header">
    <h2>{{ getPageTitle() }}</h2>
    <p class="subtitle">{{ getPageSubtitle() }}</p>
  </div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="season-form">
    <div class="form-row">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Nombre de la Temporada</mat-label>
        <input 
          matInput 
          formControlName="name" 
          placeholder="Ej: Temporada 2025, Verano 2025"
          required>
        <mat-error *ngIf="form.get('name')?.hasError('required')">
          El nombre es obligatorio
        </mat-error>
        <mat-error *ngIf="form.get('name')?.hasError('minlength')">
          El nombre debe tener al menos 3 caracteres
        </mat-error>
      </mat-form-field>
    </div>

    <div class="form-row two-columns">
      <mat-form-field appearance="outline">
        <mat-label>Fecha de Inicio</mat-label>
        <input 
          matInput 
          [matDatepicker]="startPicker" 
          formControlName="start_date"
          placeholder="DD/MM/YYYY"
          required>
        <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
        <mat-datepicker #startPicker></mat-datepicker>
        <mat-error *ngIf="form.get('start_date')?.hasError('required')">
          La fecha de inicio es obligatoria
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Fecha de Fin</mat-label>
        <input 
          matInput 
          [matDatepicker]="endPicker" 
          formControlName="end_date"
          placeholder="DD/MM/YYYY"
          required>
        <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
        <mat-datepicker #endPicker></mat-datepicker>
        <mat-error *ngIf="form.get('end_date')?.hasError('required')">
          La fecha de fin es obligatoria
        </mat-error>
        <mat-error *ngIf="form.hasError('dateRange')">
          La fecha de fin debe ser posterior a la fecha de inicio
        </mat-error>
      </mat-form-field>
    </div>

    <div class="form-row" *ngIf="!isEditMode">
      <mat-checkbox formControlName="set_as_active" class="set-active-checkbox">
        Marcar como temporada activa
      </mat-checkbox>
      <mat-hint class="checkbox-hint">
        Si está marcado, esta temporada será la activa por defecto
      </mat-hint>
    </div>

    <div class="form-actions">
      <button 
        type="button" 
        mat-stroked-button 
        color="primary"
        (click)="onCancel()"
        [disabled]="loading">
        Cancelar
      </button>
      
      <button 
        type="submit" 
        mat-raised-button 
        color="primary"
        [disabled]="form.invalid || loading">
        <mat-spinner diameter="20" *ngIf="loading"></mat-spinner>
        <span *ngIf="!loading">{{ isEditMode ? 'Actualizar' : 'Crear' }} Temporada</span>
        <span *ngIf="loading">{{ isEditMode ? 'Actualizando...' : 'Creando...' }}</span>
      </button>
    </div>
  </form>

  <!-- Preview Card -->
  <div class="preview-card" *ngIf="form.get('name')?.value || form.get('start_date')?.value || form.get('end_date')?.value">
    <h3>Vista Previa</h3>
    <div class="season-preview">
      <div class="season-info">
        <h4>{{ form.get('name')?.value || 'Nombre de temporada' }}</h4>
        <div class="date-range">
          <mat-icon>date_range</mat-icon>
          <span>
            {{ formatPreviewDate(form.get('start_date')?.value) }} - 
            {{ formatPreviewDate(form.get('end_date')?.value) }}
          </span>
        </div>
        <div class="status-badge" [class.active]="form.get('set_as_active')?.value">
          {{ form.get('set_as_active')?.value ? 'Activa' : 'Inactiva' }}
        </div>
      </div>
    </div>
  </div>
</div>
