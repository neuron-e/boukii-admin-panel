<div class="container py-6" style="max-width: none;">
  <div class="card overflow-hidden">
    <div class="h-64 relative overflow-hidden">
      <img
        class="w-full h-full object-cover"
        src="../../../../assets/img/8.png" />
      <div
        class="absolute bg-black opacity-25 top-0 right-0 bottom-0 left-0 w-full h-full z-0"></div>

      <img
        class="avatar h-24 w-24 absolute top-6 ltr:left-4 rtl:right-4 sm:hidden"
        [src]="defaults.image" />
    </div>

    <div class="z-10 relative -mt-16 px-6 flex items-center" style="margin-top: -6rem !important;position: relative;bottom: 80px;" >
      <img
        @scaleIn
        class="avatar h-24 w-24 flex-none align-start hidden sm:block border-2 border-white"
        [src]="defaults.image" />

      <div class="max-w-full flex-auto sm:ltr:ml-6 sm:rtl:mr-6">
        <div class="h-16 items-end">
          <p @fadeInRight class="headline text-white" style="font-size: 12px;">{{getNacionality(defaults.country)}} · {{getCountry(defaults.country)}} · {{calculateAge(defaults.birth_date)}}</p>

          <h1 @fadeInRight class="headline text-white">{{ defaults.first_name}} {{ defaults.last_name }}</h1>

          <mat-icon svgIcon="mat:chat"></mat-icon>
          <mat-icon svgIcon="mat:mail_outline"></mat-icon>
          <mat-icon svgIcon="mat:contact_phone"></mat-icon>
        </div>

      </div>
    </div>
  </div>

  <div class="mt-6 flex flex-col md:flex-row md:items-start" [formGroup]="formInfoAccount" *ngIf="!loading && !editing">

    <mat-tab-group style="width: 100%" [selectedIndex]="selectedTabPreviewIndex">
      <mat-tab label="About">
        <div class="flex-auto">
          <div class="card">
            <div class="px-6 py-4 border-b">
              <h2 class="title m-0">Données Personnelles
                <mat-icon svgIcon="mat:expand_less" style="float:right;cursor:pointer" *ngIf="!showInfo" (click)="showInfoEvent(true)"></mat-icon>
                <mat-icon svgIcon="mat:expand_less" style="float:right;cursor:pointer" *ngIf="showInfo" (click)="showInfoEvent(false)"></mat-icon>
                <mat-icon svgIcon="mat:edit" style="float:right;cursor:pointer"(click)="showInfoEditEvent(true)"></mat-icon>
              </h2>
            </div>

            <div class="px-6 py-4 grid grid-cols-1 sm:grid-cols-2 gap-4" *ngIf="showInfo">
              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:mail"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Nom</p>
                  <p class="m-0 body-1">{{defaults.first_name}}</p>
                </div>

              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:lock"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Prenom</p>
                  <p class="m-0 body-1">{{defaults.last_name}}</p>
                </div>
              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:business"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Fecha de nacimient</p>
                  <p class="m-0 body-1">{{defaults.birth_date | date: 'dd/MM/YYYY'}}
                  </p>
                </div>
              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:business"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Movil</p>
                  <p class="m-0 body-1">{{defaults.phone}}
                  </p>
                </div>
              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:business"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Email</p>
                  <p class="m-0 body-1">{{defaults.email}}
                  </p>
                </div>
              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:business"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Idiomas</p>
                  <p class="m-0 body-1">{{getSelectedLanguageNames()}}
                  </p>
                </div>
              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:mail"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Nombre de usuario</p>
                  <p class="m-0 body-1">{{defaultsUser.username || 'No asigned'}}</p>
                </div>

              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:lock"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Password</p>
                  <p class="m-0 body-1">*************</p>
                </div>
              </div>
            </div>
          </div>

          <div class="card" style="margin: 3% 0 0 0;">
            <div class="px-6 py-4 border-b">
              <h2 class="title m-0">Deportes
                <mat-icon svgIcon="mat:expand_less" style="float:right;cursor:pointer" *ngIf="!showSportInfo" (click)="showSportInfoEvent(true)"></mat-icon>
                <mat-icon svgIcon="mat:expand_less" style="float:right;cursor:pointer" *ngIf="showSportInfo" (click)="showSportInfoEvent(false)"></mat-icon>
                <mat-icon svgIcon="mat:edit" style="float:right;cursor:pointer" (click)="showSportInfoEditEvent(true)"></mat-icon>
              </h2>
            </div>

            <div class="px-6 py-4 grid grid-cols-1 sm:grid-cols-2 gap-4" *ngIf="showSportInfo">

              <div *ngFor="let item of sportsCurrentData.data">
                <div class="py-3 flex items-center">
                  <div
                    @scaleIn
                    class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                    <img [src]="item.icon_selected" style="border-radius: 10px 0 10px 10px;height:40px !important; width: 40px !important; object-fit: contain !important; " [style.background-color]="item.level.color">
                  </div>

                  <div @fadeInRight *ngIf="!editSportInfo">
                    <p class="m-0 caption text-hint">Sport</p>
                    <p class="m-0 body-1">{{item.name}}
                    </p>
                  </div>

                </div>

                <div class="py-3 flex items-center">

                  <div @fadeInRight *ngIf="!editSportInfo">
                    <p class="m-0 caption text-hint">Level</p>
                    <div style="padding: 5%;color: #fff;width: 100%;border-radius: 10px 0 10px;width: 250px;" [style.background-color]="item.level.color">
                      <p class="m-0 body-1" style="text-wrap: pretty;text-align: center;">{{item.level.annotation}} - {{item.level.name}}</p>
                    </div>
                  </div>


                </div>

                <div class="py-3 flex items-center ">
                  <ng-container *ngFor="let degree of item.degrees">
                    <div *ngIf="checkMonitorAuth(item, degree)" class="chip-level" [style.border]="'cursor:auto; 2px solid ' + item.color"
                    [ngStyle]="{
                      'background': checkMonitorAuth(item, degree) ? degree.color : '#fff'
                    }">
                      <p style="color: #000;text-align: center"
                      [ngStyle]="{
                        'color': checkMonitorAuth(item, degree) ? '#fff': '#000'
                      }"
                      >{{ degree.annotation }}</p>
                  </div>

                </ng-container>
                  <div class="chip-level" style="border: 2px black solid"  (click)="item.allowAdults = !item.allowAdults" [ngStyle]="{
                    'background': checkMonitorAuthAdults(item) ? 'black' : '#fff'
                  }" (click)="authoriseAudlts(item)">
                    <p style="text-align: center"
                    [ngStyle]="{
                      'color': checkMonitorAuthAdults(item) ? '#fff' : 'black'
                    }"
                    >A</p>
                  </div>
                </div>

              </div>
            </div>
          </div>

          <div class="card" style="margin: 3% 0 0 0;">
            <div class="px-6 py-4 border-b">
              <h2 class="title m-0">Direccion
                <mat-icon svgIcon="mat:expand_less" style="float:right;cursor:pointer" *ngIf="!showAddressInfo" (click)="showAddressInfoEvent(true)"></mat-icon>
                <mat-icon svgIcon="mat:expand_less" style="float:right;cursor:pointer" *ngIf="showAddressInfo" (click)="showAddressInfoEvent(false)"></mat-icon>
                <mat-icon svgIcon="mat:edit" style="float:right;cursor:pointer" (click)="showAddressInfoEditEvent(true)"></mat-icon>
              </h2>
            </div>

            <div class="px-6 py-4 grid grid-cols-1 sm:grid-cols-2 gap-4" *ngIf="showAddressInfo">
              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:mail"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Calle -nº</p>
                  <p class="m-0 body-1">{{defaults.address}}</p>
                </div>

              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:lock"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">CP</p>
                  <p class="m-0 body-1">{{defaults.cp}}</p>
                </div>
              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:business"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Ciudad</p>
                  <p class="m-0 body-1">{{getProvince(defaults.province)}}
                  </p>
                </div>
              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:business"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Canton</p>
                  <p class="m-0 body-1">{{getCountry(defaults.country)}}
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="card" style="margin: 3% 0 0 0;">
            <div class="px-6 py-4 border-b">
              <h2 class="title m-0">Work Info
                <mat-icon svgIcon="mat:expand_less" style="float:right;cursor:pointer" *ngIf="!showPersonalInfo" (click)="showPersonalInfoEvent(true)"></mat-icon>
                <mat-icon svgIcon="mat:expand_less" style="float:right;cursor:pointer" *ngIf="showPersonalInfo" (click)="showPersonalInfoEvent(false)"></mat-icon>
                <mat-icon svgIcon="mat:edit" style="float:right;cursor:pointer" (click)="showPersonalInfoEditEvent(true)"></mat-icon>
              </h2>
            </div>

            <div class="px-6 py-4 grid grid-cols-1 sm:grid-cols-2 gap-4" *ngIf="showPersonalInfo">

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:mail"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Work License</p>
                  <p class="m-0 body-1"> {{defaults.work_license}}</p>
                </div>

              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:mail"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">AVS</p>
                  <p class="m-0 body-1"> {{ defaults.avs}}</p>
                </div>

              </div>

            </div>
          </div>

          <div class="card" style="margin: 3% 0 0 0;">
            <div class="px-6 py-4 border-b">
              <h2 class="title m-0">Family Info
                <mat-icon svgIcon="mat:expand_less" style="float:right;cursor:pointer" *ngIf="!showFamilyInfo" (click)="showFamilyInfoEvent(true)"></mat-icon>
                <mat-icon svgIcon="mat:expand_less" style="float:right;cursor:pointer" *ngIf="showFamilyInfo" (click)="showFamilyInfoEvent(false)"></mat-icon>
                <mat-icon svgIcon="mat:edit" style="float:right;cursor:pointer" (click)="showFamilyInfoEditEvent(true)"></mat-icon>
              </h2>
            </div>

            <div class="px-6 py-4 grid grid-cols-1 sm:grid-cols-2 gap-4" *ngIf="showFamilyInfo">
              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:mail"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Civil Status</p>
                  <p class="m-0 body-1">{{defaults.civil_status || 'No asigned'}}</p>
                </div>

              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:lock"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Children</p>
                  <p class="m-0 body-1">{{defaults.children}}</p>
                </div>
              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:mail"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Conjoint works</p>
                  <p class="m-0 body-1">{{defaults.partner_works ? 'Y' : 'N'}}</p>
                </div>

              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:mail"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Conjoint license</p>
                  <p class="m-0 body-1">{{defaults.partner_work_license}}</p>
                </div>

              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:mail"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Conjoint Percentaje</p>
                  <p class="m-0 body-1">{{defaults.partner_percentaje}}</p>
                </div>

              </div>

              <div class="py-3 flex items-center">
                <div
                  @scaleIn
                  class="w-10 h-10 rounded-full bg-primary-600/10 text-primary-600 ltr:mr-3 rtl:ml-3 flex items-center justify-center">
                  <mat-icon class="icon-sm" svgIcon="mat:mail"></mat-icon>
                </div>

                <div @fadeInRight>
                  <p class="m-0 caption text-hint">Family Allowance</p>
                  <p class="m-0 body-1">{{defaults.family_allowance}}</p>
                </div>

              </div>

            </div>
          </div>
        </div>
      </mat-tab>

      <mat-tab label="Cours">
        <vex-page-layout style="margin: 2% 0 0 0;">

            <vex-page-layout-content class="-mt-6 fullwidth" [ngClass]="{'table-show-detail': this.showDetail}">
              <vex-aio-table [columns]="columns" [entity]="entity" [title]="'Reservations'" [route]="'bookings'"
              (showDetailEvent)="showDetailEvent($event)" [filterField]="id" [filterColumn]="'monitor_id'" [with]="'&with[]=booking&with[]=course.courseGroups.courseSubgroups'"
              [showDetail]="showDetail">
            </vex-aio-table>
          </vex-page-layout-content>
        </vex-page-layout>

        <vex-page-layout-content class="-mt-6 fullwidth box-detail-timeline" *ngIf="showDetail">
          <mat-card style="padding: 0 3%;">
          <mat-card-header style="display:block">
              <div style="width: 100%;float: left;">

              </div>
              <div style="width: 100%;float:left;">
              <mat-card-title class="font-bold" style="float: left;width: 80%;">Detalles curso</mat-card-title>
              <mat-icon svgIcon="mat:close" style="float: right;cursor:pointer; color:red;" (click)="close()"></mat-icon>
              </div>
              <div style="width:100%; margin-top:5%;float:left">
              <div style="width: 100%;">
                  <p style="float: left;width: 80%;text-align: left;"><b>Desde</b></p>
                  <p style="float: left;width: 20%;text-align: right;"><b>Hasta</b></p>
              </div>
              <div style="width: 100%;">
                  <p style="float: left;width: 50%;text-align: left;"><b>{{detailData?.course.date_start | date: 'dd/MM/YYYY'}}</b></p>
                  <p style="float: left;width: 50%;text-align: right;"><b>{{detailData?.course.date_end | date: 'dd/MM/YYYY'}}</b></p>
              </div>
              </div>
              <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

              <div style="width:100%; margin-top:5%;float:left">
              <div style="width: 100%;">
                  <p style="float: left;width: 35%;text-align: left;"><b>Precio</b></p>
                  <p style="float: left;width: 65%;text-align: right;"><b>Participantes Max</b></p>
              </div>
              <div style="width: 100%;">
                  <p style="float: left;width: 50%;text-align: left;"><b>{{detailData?.course.price}}</b> {{detailData?.course.currency}}</p>
                  <p style="float: left;width: 50%;text-align: right;"><b>{{detailData?.course.max_participants}}</b></p>
              </div>
              </div>
              <ng-container *ngIf="detailData?.course.course_type == 1">
                  <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>
                  <div style="float: left; width: 100%;margin-top: 5%;">
                  <ul>
                      <ng-container *ngFor="let date of detailData?.course.course_dates">
                          <li [ngClass]="{'font-bold': date.id == detailData?.course_date_id}">{{getDateFormatLong(date.date)}} <i style="text-align: right;float:right">{{getHourRangeFormat(date.hour_start,date.hour_end)}}</i></li>
                      </ng-container>
                  </ul>
                  </div>
              </ng-container>
              <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

          </mat-card-header>
          <mat-card-content>
            <div style="float: left; width: 100%;margin-bottom:24px;">
              <div style="float: left;width: 100%;">
                  <!--ESTAS IMAGENES VENDRAN DEL detailData?.SPORT -> icon box -->
                  <div style="float: left; width: 20%; margin-top: 5%">
                      <img style="width: 75px; height: 75px;" *ngIf="detailData?.course?.course_type == 1" [src]="'https://school.boukii.com/assets/icons/collectif_'+ detailData?.sport?.name.toLowerCase() +'2x.png'" width="100" height="100" />
                      <img style="width: 75px; height: 75px;" *ngIf="detailData?.course?.course_type == 2" [src]="'https://school.boukii.com/assets/icons/prive_'+ detailData?.sport?.name.toLowerCase() +'2x.png'" width="100" height="100" />
                  </div>
                  <div style="float: left; width: 75%;margin:6% 0 0 2%">
                  <p><strong>{{detailData?.course?.name}}</strong></p>
                  <p>
                      <ng-container *ngIf="detailData?.course?.course_type == 1">
                          Collectif
                      </ng-container>
                      <ng-container *ngIf="detailData?.course?.course_type == 2">
                          Private
                      </ng-container>
                      <ng-container *ngIf="detailData?.sport">
                          {{detailData?.sport.name}}
                      </ng-container>
                  </p>
                  </div>
              </div>
            </div>
            <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

              <div *ngIf="detailData?.course?.course_type == 1" class="box-detail-boxes">
                  <div class="box-detail-box" [ngStyle]="{'background': detailData?.degree?.color}">
                      <img src="https://school.boukii.com/assets/icons/award_icon.svg" style="width:24px;height:24px;" />
                      <div class="font-bold font-white">{{detailData?.degree?.annotation}}</div>
                      <div class="font-bold font-white">{{detailData?.degree?.name}}</div>
                      <div class="font-bold font-white">{{getSubGroupsIndex()}}</div>
                  </div>
                  <div class="box-detail-box box-background-grey">
                      <img src="https://school.boukii.com/assets/icons/icons-outline-profile-2-user-white.svg" style="width:24px;height:24px;" />
                      <div>Grupos</div>
                      <div class="font-bold">{{getGroupsQuantity()}}</div>
                  </div>
                  <div class="box-detail-box box-background-grey">
                      <img src="https://school.boukii.com/assets/icons/icons-outline-clock.svg" style="width:24px;height:24px;" />
                      <div>Duración</div>
                      <div class="font-bold">{{getHoursMinutes(detailData?.hour_start,detailData?.hour_end)}}</div>
                  </div>
                  <div class="box-detail-box box-background-grey">
                      <img src="https://school.boukii.com/assets/icons/icons-outline-calendar-tick.svg" style="width:24px;height:24px;" />
                      <div>Días</div>
                      <div class="font-bold">{{getDateIndex()}}/{{detailData?.course?.course_dates?.length}}</div>
                  </div>
              </div>

              <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

              <ng-container *ngIf="detailData?.course.course_type == 2">

                  <div style="width: 100%;float:left;margin-bottom:12px;">
                      <mat-card-title class="font-bold" style="float: left;width: 80%;">Reserva</mat-card-title>
                  </div>

                  <div style="float: left; width: 100%;">
                      <ul>
                          <li class="font-bold">{{getDateFormatLong(detailData?.date_full)}} <i style="text-align: right;float:right">{{getHourRangeFormat(detailData?.hour_start,calculateHourEnd(detailData?.hour_start,detailData.course.duration))}}</i></li>
                      </ul>
                  </div>

                  <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

                  <div style="width: 100%;float:left;margin-bottom:12px;">
                      <mat-card-title class="font-bold" style="float: left;width: 100%;">Utilizador</mat-card-title>
                  </div>

                  <div style="display:flex;width:100%;flex-direction:column;gap:8px;">
                    <div *ngFor="let client of detailData?.users" class="box-detail-user-block">
                      <app-level-user *ngIf="detailData.sport" [allLevels]="getAllLevelsBySport()"
                        [selectLevel]="getClientDegree(detailData?.sport.id, client.sports)" [size]="60" [userImage]="getClient(client.client_id).image ? getClient(client.client_id).image : 'assets/img/avatar.png'"></app-level-user>
                          <div class="box-detail-user-block-text">
                              <div>{{ getClient(client.client_id)?.first_name }} {{ getClient(client.client_id)?.last_name }}</div>
                              <span>
                                  <ng-container *ngIf="getClient(client.client_id)?.language1_id">
                                      {{getLanguageById(getClient(client.client_id)?.language1_id)}} ·
                                  </ng-container>
                                  <ng-container *ngIf="getClient(client.client_id)?.language2_id">
                                      {{getLanguageById(getClient(client.client_id)?.language2_id)}} ·
                                  </ng-container>
                                  <ng-container *ngIf="getClient(client.client_id)?.language3_id">
                                      {{getLanguageById(getClient(client.client_id)?.language3_id)}} ·
                                  </ng-container>
                                  {{getCountryById(getClient(client.client_id)?.country)}} · {{getBirthYears(getClient(client.client_id)?.birth_date)}} ans
                                  · {{getClient(client.client_id)?.phone}} · {{getClient(client.client_id)?.email}}
                              </span>
                              <div *ngIf="detailData?.degree" class="box-detail-user-blocklevel" [ngStyle]="{'background': detailData?.degree.color}">
                                  {{detailData?.degree.name}}
                              </div>
                          </div>
                      </div>
                  </div>

                  <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

              </ng-container>

              <div style="width: 100%;float:left;margin-bottom:12px;">
                  <mat-card-title class="font-bold" style="float: left;width: 80%;">Monitor</mat-card-title>
              </div>

              <div *ngIf="defaults" class="box-detail-user-block">
                  <div class="box-detail-user-block-img">
                      <img [src]="defaults.image ? defaults.image : 'assets/img/avatar.png'" />
                  </div>
                  <div class="box-detail-user-block-text">
                      <div>{{ defaults.first_name }} {{ defaults.last_name }}</div>
                      <span>
                          <ng-container *ngIf="defaults.language1_id">
                              {{getLanguageById(defaults.language1_id)}} ·
                          </ng-container>
                          {{getCountryById(defaults.country)}} · {{getBirthYears(defaults.birth_date)}} ans
                          · {{defaults.phone}} · {{defaults.email}}
                      </span>
                  </div>
              </div>

              <ng-container *ngIf="detailData?.course.course_type == 1">
                  <div style="width: 100%;float:left;margin-top:32px;margin-bottom:12px;">
                      <mat-card-title class="font-bold" style="float: left;width: 80%;">Alumnos {{detailData?.users.length}}/{{detailData?.course.max_participants}}</mat-card-title>
                      <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:swap_horiz"></mat-icon>
                  </div>

                  <div style="display:flex;width:100%;flex-direction:column;gap:8px;">
                      <div *ngFor="let client of detailData?.users" class="box-detail-user-block">
                          <app-level-user *ngIf="detailData.sport" [allLevels]="getAllLevelsBySport()"
                            [selectLevel]="getClientDegree(detailData?.sport.id, client.sports)" [size]="60" [userImage]="getClient(client.client_id).image ? getClient(client.client_id).image : 'assets/img/avatar.png'"></app-level-user>
                          <div class="box-detail-user-block-text">
                              <div>{{ getClient(client.client_id)?.first_name }} {{ getClient(client.client_id)?.last_name }}</div>
                              <span>
                                  <ng-container *ngIf="getClient(client.client_id)?.language1_id">
                                      {{getLanguageById(getClient(client.client_id)?.language1_id)}} ·
                                  </ng-container>
                                  <ng-container *ngIf="getClient(client.client_id)?.language2_id">
                                      {{getLanguageById(getClient(client.client_id)?.language2_id)}} ·
                                  </ng-container>
                                  <ng-container *ngIf="getClient(client.client_id)?.language3_id">
                                      {{getLanguageById(getClient(client.client_id)?.language3_id)}} ·
                                  </ng-container>
                                  {{getCountryById(getClient(client.client_id)?.country)}} · {{getBirthYears(getClient(client.client_id)?.birth_date)}} ans
                                  · {{getClient(client.client_id)?.phone}} · {{getClient(client.client_id)?.email}}
                              </span>
                          </div>
                      </div>
                  </div>
              </ng-container>

          </mat-card-content>
        </mat-card>
        </vex-page-layout-content>
      </mat-tab>


      <!-- PLANIFICADOR-->
      <mat-tab label="Planning">

        <div class="full-page-timeline" [ngClass]="{'timeline-with-detail': showDetailTimeline || showBlockTimeline}">
          <div class="header-navigation">
              <div class="date-navigation">
              <span *ngIf="timelineView == 'day'">{{ currentDate | date: 'longDate' }}</span>
              <span *ngIf="timelineView == 'week'">{{ currentWeek }}</span>
              <span *ngIf="timelineView == 'month'">{{ currentMonth }}</span>
              <button (click)="goToPrevious()">&lt;</button>
              <button (click)="goToNext()">&gt;</button>
              </div>
              
              <div class="view-selection">
                  <span class="view-option" [ngClass]="{'selected': timelineView == 'day'}" (click)="changeView('day')">Jour</span>
                  <span class="view-option" [ngClass]="{'selected': timelineView == 'week'}" (click)="changeView('week')">Semaine</span>
                  <span class="view-option" [ngClass]="{'selected': timelineView == 'month'}" (click)="changeView('month')">Mois</span>
              </div>
          </div>
          
          <div>

              <div class="schedule-container" *ngIf="timelineView != 'month'">
                  <div class="hours-container">
                  <div class="hours-row" *ngIf="timelineView == 'day'">
                      <div class="hour" *ngFor="let hour of hoursRange">{{ hour }}</div>
                  </div>
                  <div class="hours-row" *ngIf="timelineView == 'week'">
                      <div class="day" *ngFor="let day of weekDays;let dayIndex = index">{{ day }} {{ getDayOfWeek(dayIndex) }}</div>
                  </div>
                  <div class="grid-container">
                      <div class="grid-row"  [ngClass]="{'outside-month-day': !isDayVisibleDay() && timelineView == 'day'}">
                          <ng-container *ngIf="timelineView == 'day'">
                              <div class="grid-cell" *ngFor="let hour of hoursRange" (dblclick)="handleDbClickEvent('Clicked', $event, 'day', hour)">
                              </div>
                          </ng-container>
                          <ng-container *ngIf="timelineView == 'week'">
                              <div class="grid-cell-day" *ngFor="let day of weekDays;let dayIndex = index" [ngClass]="{'outside-month': !isDayVisibleWeek(dayIndex)}">
                                  <div class="grid-cell-inside" *ngFor="let hour of hoursRangeMinusLast" (dblclick)="handleDbClickEvent('Clicked', $event, 'week', dayIndex, hour)"></div>
                              </div>
                          </ng-container>
                      </div>

                      <!--TASKS-->
                      <ng-container *ngFor="let task of plannerTasks">
                          <!--DAY-->
                          <div *ngIf="timelineView == 'day'" (click)="task.block_id ? toggleBlockTimeline(task) : toggleDetailTimeline(task)" class="task-wrapper cursor-pointer" [ngClass]="[
                              (task.booking_id && idDetailTimeline == task.booking_id) ? 
                              (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') : 
                              '', 
                              task.class,
                              (task.block_id && idBlockTimeline == task.block_id) ? 'border-selected' : ''
                          ]" [ngStyle]="task.style">
                              <div class="task-text">
                                  <img *ngIf="(task.type=='collective' || task.type=='private') && task.sport" [src]="task.sport.icon_selected" />
                                  <div>{{ task.name }}</div>
                              </div>
                              <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks">
                                  <!-- PENDING LEVEL -->
                                  <div class="task-block-level" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                                  <div *ngIf="task.type=='collective'" class="task-block-people">{{task.clients_number}}/{{task.max_participants}}</div>
                              </div>
                          </div>
                          <!--WEEK-->
                          <div *ngIf="timelineView == 'week'" (click)="task.block_id ? toggleBlockTimeline(task) : toggleDetailTimeline(task)" class="task-wrapper-week cursor-pointer" [ngClass]="[
                              (task.booking_id && idDetailTimeline == task.booking_id) ? 
                              (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') : 
                              '', 
                              task.class,
                              (task.block_id && idBlockTimeline == task.block_id) ? 'border-selected' : ''
                          ]" [ngStyle]="task.styleWeek">
                              <img class="sport-img-week" *ngIf="(task.type=='collective' || task.type=='private') && task.sport" [src]="task.sport.icon_selected" />
                              <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks-week">
                                  <!-- PENDING LEVEL -->
                                  <div class="task-block-level-week" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                                  <div *ngIf="task.type=='collective'" class="task-block-people-week">{{task.clients_number}}/{{task.max_participants}}</div>
                              </div>
                          </div>
                      </ng-container>

                  </div>
                  </div>
              </div>


              <div class="schedule-container" *ngIf="timelineView == 'month'">
                  <div class="hours-container">
                  <div class="hours-row">
                      <div class="day" *ngFor="let day of weekDays">{{ day }}</div>
                  </div>
                  <div class="grid-container">
                          <div class="grid-row" *ngFor="let week of weeksInMonth;let weekIndex = index">
                              <div class="grid-cell-day" *ngFor="let day of weekDays;let dayIndex = index" [ngClass]="{'outside-month': !isDayInMonth(dayIndex, weekIndex)}">
                                  <div class="grid-cell-inside" *ngFor="let hour of hoursRangeMinusLast" (dblclick)="handleDbClickEvent('Clicked', $event, 'month', dayIndex, hour, weekIndex)"></div>
                              </div>
                          </div>

                      <!--TASKS-->
                      <ng-container *ngFor="let task of plannerTasks">
                          <!--MONTH-->
                          <div class="task-wrapper-week cursor-pointer" (click)="task.block_id ? toggleBlockTimeline(task) : toggleDetailTimeline(task)" [ngClass]="[
                              (task.booking_id && idDetailTimeline == task.booking_id) ? 
                              (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') : 
                              '', 
                              task.class,
                              (task.block_id && idBlockTimeline == task.block_id) ? 'border-selected' : ''
                          ]" [ngStyle]="task.styleMonth">
                              <img class="sport-img-week" *ngIf="(task.type=='collective' || task.type=='private') && task.sport" [src]="task.sport.icon_selected" />
                              <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks-week">
                                  <!-- PENDING LEVEL -->
                                  <div class="task-block-level-week" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                                  <div *ngIf="task.type=='collective'" class="task-block-people-week">{{task.clients_number}}/{{task.max_participants}}</div>
                              </div>
                          </div>
                      </ng-container>

                  </div>
                  </div>
              </div>
              
          </div>
        </div>

        <vex-page-layout-content class="-mt-6 fullwidth box-detail-timeline-monitor" *ngIf="showDetailTimeline && taskDetailTimeline">
          <mat-card style="padding: 0 3%;">
          <mat-card-header style="display:block">
              <div style="width: 100%;float: left;">
              <mat-icon class="cursor-pointer" svgIcon="mat:close" (click)="hideDetailTimeline()"></mat-icon>
              <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:edit" (click)="goToEditCourse()"></mat-icon>

              </div>
              <div style="width: 100%;float:left;">
              <mat-card-title class="font-bold" style="float: left;width: 80%;">Detalles curso</mat-card-title>
              </div>
              <div style="width:100%; margin-top:5%;float:left">
              <div style="width: 100%;">
                  <p style="float: left;width: 80%;text-align: left;"><b>Desde</b></p>
                  <p style="float: left;width: 20%;text-align: right;"><b>Hasta</b></p>
              </div>
              <div style="width: 100%;">
                  <p style="float: left;width: 50%;text-align: left;"><b>{{taskDetailTimeline.date_start}}</b></p>
                  <p style="float: left;width: 50%;text-align: right;"><b>{{taskDetailTimeline.date_end}}</b></p>
              </div>
              </div>
              <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

              <div style="width:100%; margin-top:5%;float:left">
              <div style="width: 100%;">
                  <p style="float: left;width: 35%;text-align: left;"><b>Precio</b></p>
                  <p style="float: left;width: 65%;text-align: right;"><b>Participantes Max</b></p>
              </div>
              <div style="width: 100%;">
                  <p style="float: left;width: 50%;text-align: left;"><b>{{taskDetailTimeline.course.price}}</b> {{taskDetailTimeline.course.currency}}</p>
                  <p style="float: left;width: 50%;text-align: right;"><b>{{taskDetailTimeline.course.max_participants}}</b></p>
              </div>
              </div>
              <ng-container *ngIf="taskDetailTimeline.type == 'collective'">
                  <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>
                  <div style="float: left; width: 100%;margin-top: 5%;">
                  <ul>
                      <ng-container *ngFor="let date of taskDetailTimeline.course.course_dates">
                          <li [ngClass]="{'font-bold': date.id == taskDetailTimeline.course_date_id}">{{getDateFormatLong(date.date)}} <i style="text-align: right;float:right">{{getHourRangeFormat(date.hour_start,date.hour_end)}}</i></li>
                      </ng-container>
                  </ul>
                  </div>
              </ng-container>
              <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

          </mat-card-header>
          <mat-card-content>
              <div style="float: left; width: 100%;margin-bottom:24px;">
              <div style="float: left;width: 100%;">
                  <!--ESTAS IMAGENES VENDRAN DEL taskDetailTimeline.SPORT -> icon box -->
                  <div style="float: left; width: 20%; margin-top: 5%">
                      <img *ngIf="taskDetailTimeline.type == 'collective'" src="https://school.boukii.com/assets/icons/collectif_ski2x.png" class="img-box-detail" />
                      <img *ngIf="taskDetailTimeline.type == 'private'" src="https://school.boukii.com/assets/icons/prive_ski2x.png" class="img-box-detail" />
                  </div>
                  <div style="float: left; width: 75%;margin:6% 0 0 2%">
                  <p><strong>{{taskDetailTimeline.name}}</strong></p>
                  <p>
                      <ng-container *ngIf="taskDetailTimeline.type == 'collective'">
                          Collectif
                      </ng-container>
                      <ng-container *ngIf="taskDetailTimeline.type == 'private'">
                          Private
                      </ng-container>
                      <ng-container *ngIf="taskDetailTimeline.sport">
                          {{taskDetailTimeline.sport.name}}
                      </ng-container>
                  </p>
                  </div>
              </div>
              </div>

              <div *ngIf="taskDetailTimeline.type == 'collective'" class="box-detail-boxes">
                  <div class="box-detail-box" [ngStyle]="{'background': taskDetailTimeline.degree.color}">
                      <img src="https://school.boukii.com/assets/icons/award_icon.svg" style="width:24px;height:24px;" />
                      <div class="font-bold font-white">{{taskDetailTimeline.degree.annotation}}</div>
                      <div class="font-bold font-white">{{taskDetailTimeline.degree.name}}</div>
                      <div class="font-bold font-white">{{taskDetailTimeline.subgroup_number}}</div>
                  </div>
                  <div class="box-detail-box box-background-grey">
                      <img src="https://school.boukii.com/assets/icons/icons-outline-profile-2-user-white.svg" style="width:24px;height:24px;" />
                      <div>Grupos</div>
                      <div class="font-bold">{{taskDetailTimeline.total_subgroups}}</div>
                  </div>
                  <div class="box-detail-box box-background-grey">
                      <img src="https://school.boukii.com/assets/icons/icons-outline-clock.svg" style="width:24px;height:24px;" />
                      <div>Duración</div>
                      <div class="font-bold">{{getHoursMinutes(taskDetailTimeline.hour_start,taskDetailTimeline.hour_end)}}</div>
                  </div>
                  <div class="box-detail-box box-background-grey">
                      <img src="https://school.boukii.com/assets/icons/icons-outline-calendar-tick.svg" style="width:24px;height:24px;" />
                      <div>Días</div>
                      <div class="font-bold">{{taskDetailTimeline.date_index}}/{{taskDetailTimeline.course.course_dates.length}}</div>
                  </div>
              </div>

              <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

              <ng-container *ngIf="taskDetailTimeline.type == 'private'">

                  <div style="width: 100%;float:left;margin-bottom:12px;">
                      <mat-card-title class="font-bold" style="float: left;width: 80%;">Reserva</mat-card-title>
                      <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:edit"></mat-icon>
                  </div>

                  <div style="float: left; width: 100%;">
                      <ul>
                          <li class="font-bold">{{getDateFormatLong(taskDetailTimeline.date_full)}} <i style="text-align: right;float:right">{{getHourRangeFormat(taskDetailTimeline.hour_start,taskDetailTimeline.hour_end)}}</i></li>
                      </ul>
                  </div>

                  <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>
                  
                  <div style="width: 100%;float:left;margin-bottom:12px;">
                      <mat-card-title class="font-bold" style="float: left;width: 100%;">Utilizador</mat-card-title>
                  </div>

                  <div style="display:flex;width:100%;flex-direction:column;gap:8px;">
                      <div *ngFor="let client of taskDetailTimeline.all_clients" class="box-detail-user-block">
                          <app-level-user *ngIf="taskDetailTimeline.degrees_sport && taskDetailTimeline.degrees_sport.length" [allLevels]="taskDetailTimeline.degrees_sport" [selectLevel]="getClientDegree(taskDetailTimeline.sport_id,client.client.sports)" [size]="80" [userImage]="client.client.image ? client.client.image : 'assets/img/avatar.png'"></app-level-user>
                          <div class="box-detail-user-block-text">
                              <div>{{ client.client.first_name }} {{ client.client.last_name }}</div>
                              <span>
                                  <ng-container *ngIf="client.client.language1_id">
                                      {{getLanguageById(client.client.language1_id)}} ·
                                  </ng-container>
                                  <ng-container *ngIf="client.client.language2_id">
                                      {{getLanguageById(client.client.language2_id)}} ·
                                  </ng-container>
                                  <ng-container *ngIf="client.client.language3_id">
                                      {{getLanguageById(client.client.language3_id)}} ·
                                  </ng-container>
                                  {{getCountryById(client.client.country)}} · {{getBirthYears(client.client.birth_date)}} ans
                                  · {{client.client.phone}} · {{client.client.email}}
                              </span>
                              <div *ngIf="taskDetailTimeline.degree" class="box-detail-user-blocklevel" [ngStyle]="{'background': taskDetailTimeline.degree.color}">
                                  {{taskDetailTimeline.degree.name}}
                              </div>
                          </div>
                      </div>
                  </div>

                  <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

              </ng-container>

              <div style="width: 100%;float:left;margin-bottom:12px;">
                  <mat-card-title class="font-bold" style="float: left;width: 80%;">Monitor</mat-card-title>
              </div>

              <div *ngIf="taskDetailTimeline.monitor" class="box-detail-user-block">
                  <div class="box-detail-user-block-img">
                      <img [src]="taskDetailTimeline.monitor.image ? taskDetailTimeline.monitor.image : 'assets/img/avatar.png'" />
                  </div>
                  <div class="box-detail-user-block-text">
                      <div>{{ taskDetailTimeline.monitor.first_name }} {{ taskDetailTimeline.monitor.last_name }}</div>
                      <span>
                          <ng-container *ngIf="taskDetailTimeline.monitor.language1_id">
                              {{getLanguageById(taskDetailTimeline.monitor.language1_id)}} ·
                          </ng-container>
                          {{getCountryById(taskDetailTimeline.monitor.country)}} · {{getBirthYears(taskDetailTimeline.monitor.birth_date)}} ans
                          · {{taskDetailTimeline.monitor.phone}} · {{taskDetailTimeline.monitor.email}}
                      </span>
                  </div>
              </div>
              <div *ngIf="!taskDetailTimeline.monitor">
                  Ningún monitor asignado
              </div>

              <ng-container *ngIf="taskDetailTimeline.type == 'collective'">
                  <div style="width: 100%;float:left;margin-top:32px;margin-bottom:12px;">
                      <mat-card-title class="font-bold" style="float: left;width: 80%;">Alumnos {{taskDetailTimeline.clients_number}}/{{taskDetailTimeline.max_participants}}</mat-card-title>
                      <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:swap_horiz"></mat-icon>
                  </div>

                  <div style="display:flex;width:100%;flex-direction:column;gap:8px;">
                      <div *ngFor="let client of taskDetailTimeline.all_clients" class="box-detail-user-block">
                          <app-level-user *ngIf="taskDetailTimeline.degrees_sport && taskDetailTimeline.degrees_sport.length" [allLevels]="taskDetailTimeline.degrees_sport" [selectLevel]="getClientDegree(taskDetailTimeline.sport_id,client.client.sports)" [size]="60" [userImage]="client.client.image ? client.client.image : 'assets/img/avatar.png'"></app-level-user>
                          <div class="box-detail-user-block-text">
                              <div>{{ client.client.first_name }} {{ client.client.last_name }}</div>
                              <span>
                                  <ng-container *ngIf="client.client.language1_id">
                                      {{getLanguageById(client.client.language1_id)}} ·
                                  </ng-container>
                                  <ng-container *ngIf="client.client.language2_id">
                                      {{getLanguageById(client.client.language2_id)}} ·
                                  </ng-container>
                                  <ng-container *ngIf="client.client.language3_id">
                                      {{getLanguageById(client.client.language3_id)}} ·
                                  </ng-container>
                                  {{getCountryById(client.client.country)}} · {{getBirthYears(client.client.birth_date)}} ans
                                  · {{client.client.phone}} · {{client.client.email}}
                              </span>
                          </div>
                      </div>
                  </div>
              </ng-container>

          </mat-card-content>
          </mat-card>
        </vex-page-layout-content>


        <vex-page-layout-content class="-mt-6 fullwidth box-detail-timeline-monitor" *ngIf="showBlockTimeline && blockDetailTimeline">
          <mat-card style="padding: 0 3%;">
          <mat-card-header style="display:block">
              <div style="width: 100%;float: left;">
              <mat-icon class="cursor-pointer" svgIcon="mat:close" (click)="hideBlockTimeline()"></mat-icon>

              </div>
              <div style="width: 100%;float:left;">
              <mat-card-title class="font-bold" style="float: left;width: 80%;">Detalles bloqueo</mat-card-title>
              <div style="float: right;display: flex;gap: 6px;align-items: center;">
                  <mat-icon (click)="openEditBlock()" class="cursor-pointer" svgIcon="mat:edit"></mat-icon>
                  <mat-icon (click)="deleteEditedBlock()" class="cursor-pointer" svgIcon="mat:delete"></mat-icon>
              </div>
              </div>
              <div style="width:100%; margin-top:5%;float:left">
              <div style="width: 100%;">
                  <p style="float: left;width: 80%;text-align: left;"><b>{{blockDetailTimeline.date_format}}</b></p>
              </div>
              </div>
              <div style="width:100%; margin-top:5%;float:left">
              <div style="width: 100%;">
                  <p style="float: left;width: 80%;text-align: left;"><b>Desde</b></p>
                  <p style="float: left;width: 20%;text-align: right;"><b>Hasta</b></p>
              </div>
              <div style="width: 100%;">
                  <p style="float: left;width: 50%;text-align: left;"><b>{{blockDetailTimeline.hour_start}}</b></p>
                  <p style="float: left;width: 50%;text-align: right;"><b>{{blockDetailTimeline.hour_end}}</b></p>
              </div>
              </div>
              <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

              <div style="width:100%; margin-top:5%;float:left">
              <div style="width: 100%;">
                  <p style="float: left;width: 100%;text-align: left;"><b>
                      <ng-container *ngIf="blockDetailTimeline.type=='block_personal'">No working day</ng-container>
                      <ng-container *ngIf="blockDetailTimeline.type=='block_payed'">Bloqueo pagado</ng-container>
                      <ng-container *ngIf="blockDetailTimeline.type=='block_no_payed'">Bloqueo no pagado</ng-container>
                  </b></p>
              </div>
              <div style="width: 100%;">
                  <p style="float: left;width: 50%;text-align: left;">{{blockDetailTimeline.name}}</p>
              </div>
              </div>
              <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

              <ng-container *ngIf="showEditBlock">
                  <div style="width: 100%;float:left;margin-top:16px;margin-bottom:12px;">
                      <mat-card-title class="font-bold" style="float: left;width: 100%;">Editar Bloqueo</mat-card-title>
                  </div>

                  <mat-checkbox [(ngModel)]="allHoursDay" [ngModelOptions]="{standalone: true}">Todo el día</mat-checkbox>

                  <ng-container *ngIf="!allHoursDay">
                      <mat-form-field class="flex-auto" style="width: 100%;">
                          <mat-select placeholder="Hora inicio" [(ngModel)]="startTimeDay" [ngModelOptions]="{standalone: true}" (change)="onStartTimeDayChange()">
                          <ng-container *ngFor="let hour of hoursRangeMinutes">
                              <mat-option [value]="hour">
                                  {{hour}}
                              </mat-option>
                          </ng-container>
                          </mat-select>
                      </mat-form-field>

                      <mat-form-field class="flex-auto" style="width: 100%;">
                          <mat-select placeholder="Hora final" [(ngModel)]="endTimeDay" [ngModelOptions]="{standalone: true}">
                          <ng-container *ngFor="let hour of filteredEndHoursDay">
                              <mat-option [value]="hour">
                                  {{hour}}
                              </mat-option>
                          </ng-container>
                          </mat-select>
                      </mat-form-field>
                  </ng-container>

                  <mat-form-field class="flex-auto" style="width: 100%;">
                      <input matInput placeholder="Title" [(ngModel)]="nameBlockDay" [ngModelOptions]="{standalone: true}">
                  </mat-form-field>

                  <mat-checkbox [(ngModel)]="divideDay" [ngModelOptions]="{standalone: true}">Dividir</mat-checkbox>

                  <ng-container *ngIf="divideDay">
                      <mat-form-field class="flex-auto" style="width: 100%;">
                          <mat-select placeholder="Inicio división" [(ngModel)]="startTimeDivision" [ngModelOptions]="{standalone: true}" (change)="onStartTimeDivisionChange()">
                          <ng-container *ngFor="let hour of filteredStartHoursDivision">
                              <mat-option [value]="hour">
                                  {{hour}}
                              </mat-option>
                          </ng-container>
                          </mat-select>
                      </mat-form-field>

                      <mat-form-field class="flex-auto" style="width: 100%;">
                          <mat-select placeholder="Fin división" [(ngModel)]="endTimeDivision" [ngModelOptions]="{standalone: true}">
                          <ng-container *ngFor="let hour of filteredEndHoursDivision">
                              <mat-option [value]="hour">
                                  {{hour}}
                              </mat-option>
                          </ng-container>
                          </mat-select>
                      </mat-form-field>
                  </ng-container>

                  <div class="actions flex items-center justify-end gap-2">
                      <button (click)="hideEditBlock()" mat-button type="button">Cancelar</button>
                      <button (click)="saveEditedBlock()" [disabled]="!isButtonDayEnabled()" color="primary" mat-raised-button>
                        Guardar
                      </button>
                  </div>

              </ng-container>

          </mat-card-header>
          <mat-card-content>

              <div style="width: 100%;float:left;margin-bottom:12px;">
                  <mat-card-title class="font-bold" style="float: left;width: 80%;">Monitor</mat-card-title>
              </div>

              <div *ngIf="blockDetailTimeline.monitor" class="box-detail-user-block">
                  <div class="box-detail-user-block-img">
                      <img [src]="blockDetailTimeline.monitor.image ? blockDetailTimeline.monitor.image : 'assets/img/avatar.png'" />
                  </div>
                  <div class="box-detail-user-block-text">
                      <div>{{ blockDetailTimeline.monitor.first_name }} {{ blockDetailTimeline.monitor.last_name }}</div>
                      <span>
                          <ng-container *ngIf="blockDetailTimeline.monitor.language1_id">
                              {{getLanguageById(blockDetailTimeline.monitor.language1_id)}} ·
                          </ng-container>
                          {{getCountryById(blockDetailTimeline.monitor.country)}} · {{getBirthYears(blockDetailTimeline.monitor.birth_date)}} ans
                          · {{blockDetailTimeline.monitor.phone}} · {{blockDetailTimeline.monitor.email}}
                      </span>
                  </div>
              </div>

          </mat-card-content>
          </mat-card>
        </vex-page-layout-content>

      </mat-tab>
      <!-- /PLANIFICADOR-->

      <mat-tab label="Statistiques" *ngIf="false">

      </mat-tab>
    </mat-tab-group>

  </div>


<div class="mt-6 flex flex-col md:flex-row md:items-start" *ngIf="!loading && editing">
  <mat-tab-group style="width: 100%">
    <mat-tab label="Profile">
      <mat-vertical-stepper #stepper="matHorizontalStepper" [linear]="true"  [selectedIndex]="selectedTabIndex">

        <ng-template matStepperIcon="edit">
          <mat-icon svgIcon="mat:done_all"></mat-icon>
        </ng-template>

        <ng-template matStepperIcon="done">
          <mat-icon svgIcon="mat:done_all"></mat-icon>
        </ng-template>

        <mat-step [stepControl]="formInfoAccount">
          <form [formGroup]="formInfoAccount">
            <ng-template matStepLabel>Info de compte</ng-template>

            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
              <div class="image-container">
                <img [src]="defaults.image !== null ? defaults.image : '../../../../assets/img/no-image.jpg'" alt="Image Preview" width="400" height="290" style="width: 400px;height: 290px;object-fit: contain;">
              </div>

              <div class="input-container">

                <input type="file" formControlName="image" placeholder="Select an image" (change)="onFileChanged($event)" id="file"/>
                <label for="file" class="btn-1">upload file</label>
                <p>Maximum 2mb</p>
                <p>Formats supportés: PNG, JPG</p>
              </div>
            </div>

              <div class="flex flex-col sm:flex-row gap-2 sm:gap-6" style="margin: 3% 0 0 0;">
                <mat-form-field class="flex-auto">
                  <mat-label>Nom</mat-label>
                  <input formControlName="name" matInput required type="text" [(ngModel)]="defaults.first_name">

                </mat-form-field>

                <mat-form-field class="flex-auto">
                  <mat-label>Prenom</mat-label>
                  <input formControlName="surname" matInput required type="text" [(ngModel)]="defaults.last_name">
                </mat-form-field>
             </div>

              <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
                <mat-form-field class="flex-auto">
                  <mat-label>Email</mat-label>
                  <input formControlName="email" matInput required type="mail" [(ngModel)]="defaults.email">

                </mat-form-field>

                <mat-form-field class="flex-auto">
                  <mat-label>Nom d'utilisateur</mat-label>
                  <input formControlName="username" matInput required type="text" [(ngModel)]="defaultsUser.username">
                </mat-form-field>
              </div>


            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
              <mat-form-field class="flex-auto" style="width: 50%">
                <mat-label>Password</mat-label>
                <input formControlName="password" matInput required [type]="inputType" [(ngModel)]="defaultsUser.password">
                <button (click)="toggleVisibility()" mat-icon-button matSuffix matTooltip="Ver contraseña" type="button">
                  <mat-icon *ngIf="visible" svgIcon="mat:visibility"></mat-icon>
                  <mat-icon *ngIf="!visible" svgIcon="mat:visibility_off"></mat-icon>
                </button>
              </mat-form-field>

              <mat-form-field class="vex-flex-form-field flex-auto" style="width: 50%">
                <mat-label>Station</mat-label>

                <input type="text" placeholder="Selecciona una opción" matInput [formControl]="myControlStations" [matAutocomplete]="autoStation" formControlName="station">

                <mat-autocomplete #autoStation="matAutocomplete">
                  <mat-option *ngFor="let option of filteredStations | async" [value]="option.name" (onSelectionChange)="defaults.active_station = option.id">
                    {{option.name}}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>
            </div>
            <div class="actions flex items-center justify-end gap-2">
              <button mat-button type="button" (click)="editing = false;">Ir a Preview</button>

              <button mat-button type="button" (click)="goTo('/monitors')">Ir al listado</button>

              <button (click)="stepper.reset()" [disabled]="formInfoAccount.pristine" color="primary" mat-button type="button">Reset</button>
              <button color="primary" mat-raised-button matStepperNext>
                Next
              </button>
            </div>
          </form>
        </mat-step>
        <mat-step [stepControl]="formPersonalInfo">
          <form [formGroup]="formPersonalInfo">
            <ng-template matStepLabel>Données Personnelles</ng-template>

            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6" style="margin: 3% 0 0 0;">

              <mat-form-field class="flex-auto">
                <input matInput [matDatepicker]="pickerFrom" placeholder="Date de naissance" formControlName="fromDate" [max]="minDate" [(ngModel)]="defaults.birth_date">
                <mat-datepicker-toggle matSuffix [for]="pickerFrom"></mat-datepicker-toggle>
                <mat-datepicker #pickerFrom [startAt]="minDate"></mat-datepicker>
              </mat-form-field>

            </div>

            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
              <mat-form-field class="flex-auto">
                <mat-label>Teléphone</mat-label>

                <input formControlName="phone" matInput required type="tel" [(ngModel)]="defaults.telephone">
              </mat-form-field>

              <mat-form-field class="flex-auto">
                <mat-label>Portable</mat-label>
                <input formControlName="mobile" matInput required type="tel" [(ngModel)]="defaults.phone">

              </mat-form-field>
            </div>

            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
              <mat-form-field class="flex-auto">
                <mat-label>Addresse</mat-label>

                <input formControlName="address" matInput required type="text" [(ngModel)]="defaults.address">
              </mat-form-field>

              <mat-form-field class="flex-auto">
                <mat-label>Code Postal</mat-label>
                <input formControlName="postalCode" matInput required type="text" [(ngModel)]="defaults.cp">

              </mat-form-field>
            </div>



            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
              <mat-form-field class="vex-flex-form-field flex-auto">
                <mat-label>Pays</mat-label>
                <input type="text" placeholder="Selecciona una opción" matInput [formControl]="myControlCountries" [matAutocomplete]="autoCountry" formControlName="country">
                <mat-autocomplete #autoCountry="matAutocomplete" [displayWith]="displayFnCountry">
                  <mat-option *ngFor="let country of filteredCountries | async" [value]="country" (onSelectionChange)="defaults.country = country.id">
                    {{country.name}}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>

              <mat-form-field class="vex-flex-form-field flex-auto">
                <mat-label>Canton</mat-label>
                <input type="text" placeholder="Selecciona una opción" matInput [formControl]="myControlProvinces" [matAutocomplete]="autoProvince" formControlName="province">
                <mat-autocomplete #autoProvince="matAutocomplete" [displayWith]="displayFnProvince">
                  <mat-option *ngFor="let province of filteredProvinces | async" [value]="province" (onSelectionChange)="defaults.province = province.id">
                    {{province.name}}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>

              <mat-form-field class="flex-auto" appearance="fill">
                <mat-label>Idiomas</mat-label>
                <mat-select [formControl]="languagesControl" multiple>
                  <mat-select-trigger>
                    <div *ngIf="selectedLanguages.length > 0; else placeholderLangs">
                      {{ getSelectedLanguageNames() }}
                    </div>
                    <ng-template #placeholderLangs>Selecciona los idiomas</ng-template>
                  </mat-select-trigger>
                  <mat-option *ngFor="let language of filteredLanguages | async" [value]="language" (onSelectionChange)="toggleSelectionLanguages($event, language)">
                    {{language.name}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>

            <div class="actions flex items-center justify-end gap-2">
              <button mat-button type="button" (click)="editing = false">Ir a Preview</button>

              <button mat-button type="button" (click)="goTo('/monitors')">Ir al listado</button>


              <button  color="primary" mat-raised-button matStepperNext>
                Next
              </button>
            </div>

            <div class="actions flex items-center justify-end gap-2">
              <button mat-button type="button" (click)="editing = false">Ir a Preview</button>
              <button mat-button type="button" (click)="goTo('/monitors')">Ir al listado</button>


              <button  color="primary" mat-raised-button matStepperNext>
                Next
              </button>
            </div>
          </form>
        </mat-step>

        <mat-step [stepControl]="formWorkInfo">
          <form [formGroup]="formWorkInfo">
            <ng-template matStepLabel>Information de travail</ng-template>

            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6" style="margin: 3% 0 0 0;">
              <mat-form-field class="flex-auto">
                <mat-label>Nº AVS</mat-label>
                <input formControlName="avs" matInput required type="text" [(ngModel)]="defaults.avs">

              </mat-form-field>

              <mat-form-field class="flex-auto">
                <mat-label>Permis de travail</mat-label>
                <input formControlName="workId" matInput required type="text" [(ngModel)]="defaults.work_license">
              </mat-form-field>
            </div>

            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
              <mat-form-field class="flex-auto">
                <mat-label>IBAN</mat-label>
                <input formControlName="iban" matInput required type="text" [(ngModel)]="defaults.bank_details">

              </mat-form-field>
            </div>

            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
              <mat-form-field class="vex-flex-form-field flex-auto">
                <mat-label>Pays</mat-label>
                <input type="text" placeholder="Selecciona una opción" matInput [formControl]="myControlWorkCountries" [matAutocomplete]="autoCountryWork" formControlName="countryWork">
                <mat-autocomplete #autoCountryWork="matAutocomplete" [displayWith]="displayFnCountry">
                  <mat-option *ngFor="let country of filteredWorkCountries | async" [value]="country" (onSelectionChange)="defaults.world_country = country.id">
                    {{country.name}}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>

              <mat-form-field class="flex-auto">
                <mat-label>Children</mat-label>
                <input formControlName="children" matInput required type="number" (input)="updateChildren($event)" [(ngModel)]="defaults.children">

              </mat-form-field>
            </div>
            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">

             <!-- Añadir niños con modal -->
              <mat-table #childrenTable [dataSource]="childrenData" *ngIf="formWorkInfo.value.children > 0">

                <!-- Otros contenedores según tu descripción -->

                <ng-container matColumnDef="name">
                  <mat-header-cell *matHeaderCellDef> Name </mat-header-cell>
                  <mat-cell *matCellDef="let element">
                    <mat-form-field class="flex-auto" style="margin: 2% 0 0 0;">
                      <mat-label>Name</mat-label>
                      <input matInput [(ngModel)]="element.name" formControlName="childName" type="text">
                    </mat-form-field>
                  </mat-cell>
                </ng-container>

                <ng-container matColumnDef="date">
                  <mat-header-cell *matHeaderCellDef>  Date de naissance </mat-header-cell>
                  <mat-cell *matCellDef="let element">
                    <mat-form-field class="flex-auto" style="margin: 2% 0 0 0;">
                      <input matInput [matDatepicker]="pickerFromChild" placeholder="Date de naissance" [(ngModel)]="element.date" [max]="minDateChild" formControlName="childAge">
                      <mat-datepicker-toggle matSuffix [for]="pickerFromChild"></mat-datepicker-toggle>
                      <mat-datepicker #pickerFromChild [startAt]="minDateChild"></mat-datepicker>
                    </mat-form-field>
                  </mat-cell>
                </ng-container>

                <!-- Ícono para eliminar
                <ng-container matColumnDef="delete">
                  <mat-header-cell *matHeaderCellDef> Eliminar </mat-header-cell>
                  <mat-cell *matCellDef="let element">
                    <mat-icon svgIcon="mat:delete" (click)="removeChild(element)"></mat-icon>
                  </mat-cell>
                </ng-container> -->

                <mat-header-row *matHeaderRowDef="displayedColumnsChildren"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumnsChildren;"></mat-row>
              </mat-table>
            </div>


          </form>
        </mat-step>

        <mat-step [stepControl]="formSportInfo">
          <ng-template matStepLabel>Deportes</ng-template>

          <div style="margin: 3% 0 0 0;">


            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
              <mat-form-field class="flex-auto" appearance="fill">
                <mat-label>Deportes</mat-label>
                <mat-select [formControl]="sportsControl" multiple>

                  <mat-select-trigger>
                    <div *ngIf="sportsControl.value?.length > 0; else placeholder">
                      {{ getSelectedSportsNames() }}
                    </div>
                    <ng-template #placeholder>Selecciona los deportes</ng-template>
                  </mat-select-trigger>

                  <mat-option *ngFor="let sport of filteredSports | async" [value]="sport" (onSelectionChange)="toggleSelection($event, sport)">
                    {{sport.name}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>

            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
              <mat-table class="sports-table" #sportsCurrentTable [dataSource]="sportsCurrentData">
                <caption style="width: 100px"> Current sports</caption>
                 <!-- Otros contenedores según tu descripción -->
                 <ng-container matColumnDef="delete">
                  <mat-header-cell *matHeaderCellDef class="delete-column" style="width: 6% !important;float: left;">Eliminar</mat-header-cell>
                  <mat-cell *matCellDef="let element; let i = index" class="delete-column" style="width: 20%;float: left;">
                    <mat-icon svgIcon="mat:delete" (click)="removeSport(i, element)"></mat-icon>
                  </mat-cell>
                </ng-container>
                 <ng-container matColumnDef="name" >
                  <mat-header-cell *matHeaderCellDef style="width: 27%;float: left;"> Name </mat-header-cell>
                  <mat-cell *matCellDef="let element" style="width: 25%;float: left;">
                    <mat-form-field class="flex-auto" style="margin: 2% 0 0 0;">
                      <mat-label>Name</mat-label>
                      <input matInput [value]="element.name" type="text" [readonly]="true">
                    </mat-form-field>
                  </mat-cell>
                </ng-container>

                <ng-container matColumnDef="level">
                  <mat-header-cell *matHeaderCellDef style="width: 27%;float: left;">Niveaux</mat-header-cell>
                  <mat-cell *matCellDef="let element" style="width: 25%;float: left;">
                    <mat-form-field class="flex-auto" style="margin: 2% 0 0 0;">
                     <mat-label>Niveaux</mat-label>
                     <input type="text" placeholder="Pick one" aria-label="Number" matInput [matAutocomplete]="autoLevel" [value]="element.level.name" [(ngModel)]="element.level"/>
                     <mat-autocomplete #autoLevel="matAutocomplete" [displayWith]="displayFnLevel">
                       <mat-option *ngFor="let level of element.degrees" [value]="level"  (onSelectionChange)="element.level = level" (onSelectionChange)="updateLevel(element, level)">
                         {{level.annotation}} - {{level.name}}
                       </mat-option>
                     </mat-autocomplete>
                    </mat-form-field>
                  </mat-cell>
                </ng-container>

                <ng-container matColumnDef="salary">
                  <mat-header-cell *matHeaderCellDef style="width: 27%;float: left;">Salary</mat-header-cell>
                  <mat-cell *matCellDef="let element" style="width: 25%;float: left;">
                    <mat-form-field class="flex-auto" style="margin: 2% 0 0 0;">
                     <mat-label>Salary</mat-label>
                     <input type="text" placeholder="Pick one" aria-label="Number" matInput [value]="getSalary(element.salary_level)?.name" [matAutocomplete]="autoSalary"/>
                     <mat-autocomplete #autoSalary="matAutocomplete" [displayWith]="displayFnSalary">
                       <mat-option *ngFor="let salary of filteredSalary | async" [value]="salary" (onSelectionChange)="element.salary_id = salary.id" (onSelectionChange)="updateSalary(element, salary)">
                         {{salary.name}}
                       </mat-option>
                     </mat-autocomplete>
                    </mat-form-field>
                  </mat-cell>
                </ng-container>

                <ng-container matColumnDef="auth">
                  <mat-header-cell *matHeaderCellDef [hidden]="true" style="width: 100%;float: left;"> Authorised Levels </mat-header-cell>
                  <mat-cell *matCellDef="let element" style="width: 100%;float: left;">
                    <div style="width: 100%; float:left">
                      <div *ngFor="let level of element.degrees" class="chip-level" [style.border]="'2px solid ' + level.color"
                      [ngStyle]="{
                        'background': checkMonitorAuth(element, level) ? level.color : '#fff'
                      }"
                        (click)="authoriseCurrentLevel(level, element)">
                        <p style="color: #000;text-align: center"
                        [ngStyle]="{
                          'color': checkMonitorAuth(element, level) ? '#fff': '#000'
                        }"
                        >{{ level.annotation }}</p>
                      </div>
                      <div class="chip-level" style="border: 2px black solid"  (click)="element.allowAdults = !element.allowAdults" [ngStyle]="{
                        'background': checkMonitorAuthAdults(element) ? 'black' : '#fff'
                      }" (click)="authoriseAudlts(element)">
                        <p style="text-align: center"
                        [ngStyle]="{
                          'color': checkMonitorAuthAdults(element) ? '#fff' : 'black'
                        }"
                        >A</p>
                      </div>
                     </div>

                  </mat-cell>
                </ng-container>

                 <mat-header-row *matHeaderRowDef="displayedCurrentColumns"></mat-header-row>
                 <mat-row *matRowDef="let row; columns: displayedCurrentColumns;"></mat-row>
               </mat-table>
             </div>

             <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">

              <mat-table class="sports-table" #sportsTable [dataSource]="sportsData" *ngIf="this.sportsData.data.length > 0">
                <caption style="width: 100px"> New sports</caption>

                <!-- Otros contenedores según tu descripción -->
                <ng-container matColumnDef="name">
                 <mat-header-cell *matHeaderCellDef style="width: 33%;float: left;"> Name </mat-header-cell>
                 <mat-cell *matCellDef="let element" style="width: 30%;float: left;">
                   <mat-form-field class="flex-auto" style="margin: 2% 0 0 0;">
                     <mat-label>Name</mat-label>
                     <input matInput [value]="element.name" type="text" [readonly]="true">
                   </mat-form-field>
                 </mat-cell>
               </ng-container>

               <ng-container matColumnDef="level">
                 <mat-header-cell *matHeaderCellDef style="width: 33%;float: left;">Niveaux</mat-header-cell>
                 <mat-cell *matCellDef="let element" style="width: 30%;float: left;">
                   <mat-form-field class="flex-auto" style="margin: 2% 0 0 0;">
                    <mat-label>Niveaux</mat-label>
                    <input type="text" placeholder="Pick one" aria-label="Number" matInput [formControl]="levelForm" [matAutocomplete]="autoLevel" [(ngModel)]="element.level"/>
                    <mat-autocomplete #autoLevel="matAutocomplete" [displayWith]="displayFnLevel">
                      <mat-option *ngFor="let level of element.degrees" [value]="level">
                        {{level.annotation}} - {{level.name}}
                      </mat-option>
                    </mat-autocomplete>
                   </mat-form-field>
                 </mat-cell>
               </ng-container>

               <ng-container matColumnDef="salary">
                 <mat-header-cell *matHeaderCellDef style="width: 33%;float: left;">Salary</mat-header-cell>
                 <mat-cell *matCellDef="let element" style="width: 30%;float: left;">
                   <mat-form-field class="flex-auto" style="margin: 2% 0 0 0;">
                    <mat-label>Salary</mat-label>
                    <input type="text" placeholder="Pick one" aria-label="Number" matInput [formControl]="salaryForm" [matAutocomplete]="autoSalary"/>
                    <mat-autocomplete #autoSalary="matAutocomplete" [displayWith]="displayFnSalary">
                      <mat-option *ngFor="let salary of filteredSalary | async" [value]="salary" (onSelectionChange)="element.salary_id = salary.id">
                        {{salary.name}}
                      </mat-option>
                    </mat-autocomplete>
                   </mat-form-field>
                 </mat-cell>
               </ng-container>

               <ng-container matColumnDef="auth">
                <mat-header-cell *matHeaderCellDef style="width: 100%;float: left;" [hidden]="true"> Authorised Levels </mat-header-cell>
                <mat-cell *matCellDef="let element" style="width: 100%;float: left;">
                  <div style="width: 100%; float:left">
                    <div *ngFor="let item of element.degrees" class="chip-level" [style.border]="'2px solid ' + item.color"
                    [ngStyle]="{
                      'background': isAuthorized(item) ? item.color : '#fff'
                    }"
                      (click)="authoriseLevel(item)">
                      <p style="color: #000;text-align: center"
                      [ngStyle]="{
                        'color': isAuthorized(item) ? '#fff': '#000'
                      }"
                      >{{ item.annotation }}</p>
                    </div>
                    <div class="chip-level" style="border: 1px black solid" (click)="element.allowAdults = !element.allowAdults" [ngStyle]="{
                     'background': element.allowAdults ? 'black' : '#fff'
                   }">
                     <p style="text-align: center"
                     [ngStyle]="{
                       'color': element.allowAdults ? '#fff' : 'black'
                     }"
                     >A</p>
                   </div>
                  </div>
                </mat-cell>
              </ng-container>
                <!-- Ícono para eliminar
                <ng-container matColumnDef="delete">
                  <mat-header-cell *matHeaderCellDef> Eliminar </mat-header-cell>
                  <mat-cell *matCellDef="let element">
                    <mat-icon svgIcon="mat:delete" (click)="removeChild(element)"></mat-icon>
                  </mat-cell>
                </ng-container> -->

                <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
              </mat-table>


            </div>
            <div class="actions flex items-center justify-end gap-2">
              <button mat-button type="button" (click)="editing = false">Ir a Preview</button>
              <button mat-button type="button" (click)="goTo('/monitors')">Ir al listado</button>


              <button  color="primary" mat-raised-button matStepperNext>
                Next
              </button>
            </div>

          </div>
        </mat-step>

        <mat-step [stepControl]="formCivilStatusInfo">
          <form [formGroup]="formCivilStatusInfo">
            <ng-template matStepLabel>Etat civil</ng-template>

            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6" style="margin: 3% 0 0 0;">
              <mat-form-field class="flex-auto">
                <mat-label>Estado Civil</mat-label>
                <input type="text" matInput [formControl]="myControlCivilStatus" formControlName="civilStatus" [matAutocomplete]="autoCivilStatus" [value]="defaults.civil_status" >
                <mat-autocomplete #autoCivilStatus="matAutocomplete">
                  <mat-option *ngFor="let civilStatus of filteredCivilStatus | async" [value]="civilStatus" (onSelectionChange)="defaults.civil_status = civilStatus">
                    {{ civilStatus }}
                  </mat-option>
                </mat-autocomplete>

              </mat-form-field>

              <mat-form-field class="flex-auto">
                <mat-label>Conjoint travaille?</mat-label>
                <mat-select formControlName="spouse" (selectionChange)="setValueSpouse($event)">
                  <mat-option value="y">Yes</mat-option>
                  <mat-option value="n">No</mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field class="flex-auto">
                <mat-label>Demande d'allocation familiales?</mat-label>
                <mat-select formControlName="workMobility" (selectionChange)="setValueLocation($event)">
                  <mat-option value="y" >Yes</mat-option>
                  <mat-option value="n" >No</mat-option>
                </mat-select>
              </mat-form-field>
            </div>

            <div class="flex flex-col sm:flex-row gap-2 sm:gap-6" *ngIf="defaults.partner_works">
              <mat-form-field class="flex-auto">
                <mat-label>Permis travail du conjoint</mat-label>
                <input formControlName="spouseWorkId" matInput required type="text" [disabled]="!defaults.partner_works" [(ngModel)]="defaults.partner_work_license">

              </mat-form-field>
              <mat-form-field class="flex-auto">
                <mat-label>Pourcentage du conjoint (%)</mat-label>
                <input formControlName="spousePercentage" matInput required type="text" [disabled]="!defaults.partner_works" [(ngModel)]="defaults.partner_percentaje">

              </mat-form-field>
            </div>
            <div class="actions flex items-center justify-end gap-2">
              <button mat-button type="button" (click)="editing = false">Ir a Preview</button>
              <button mat-button type="button" (click)="goTo('/monitors')">Ir al listado</button>


              <button  color="primary" mat-raised-button matStepperNext (click)="save()">
                Save
              </button>
            </div>
          </form>
        </mat-step>
      </mat-vertical-stepper>
    </mat-tab>

    <mat-tab label="Cours">
      <vex-page-layout style="margin: 2% 0 0 0;">

          <vex-page-layout-content class="-mt-6 fullwidth" [ngClass]="{'table-show-detail': this.showDetail}">
            <vex-aio-table [columns]="columns" [entity]="entity" [title]="'Reservations'" [route]="'bookings'"
            (showDetailEvent)="showDetailEvent($event)" [filterField]="id" [filterColumn]="'monitor_id'" [with]="'&with[]=booking&with[]=course.courseGroups.courseSubgroups'"
            [showDetail]="showDetail">
          </vex-aio-table>
        </vex-page-layout-content>
      </vex-page-layout>

      <vex-page-layout-content class="-mt-6 fullwidth box-detail-timeline" *ngIf="showDetail">
        <mat-card style="padding: 0 3%;">
        <mat-card-header style="display:block">
            <div style="width: 100%;float: left;">

            </div>
            <div style="width: 100%;float:left;">
            <mat-card-title class="font-bold" style="float: left;width: 80%;">Detalles curso</mat-card-title>
            </div>
            <div style="width:100%; margin-top:5%;float:left">
            <div style="width: 100%;">
                <p style="float: left;width: 80%;text-align: left;"><b>Desde</b></p>
                <p style="float: left;width: 20%;text-align: right;"><b>Hasta</b></p>
            </div>
            <div style="width: 100%;">
                <p style="float: left;width: 50%;text-align: left;"><b>{{detailData?.course.date_start | date: 'dd/MM/YYYY'}}</b></p>
                <p style="float: left;width: 50%;text-align: right;"><b>{{detailData?.course.date_end | date: 'dd/MM/YYYY'}}</b></p>
            </div>
            </div>
            <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

            <div style="width:100%; margin-top:5%;float:left">
            <div style="width: 100%;">
                <p style="float: left;width: 35%;text-align: left;"><b>Precio</b></p>
                <p style="float: left;width: 65%;text-align: right;"><b>Participantes Max</b></p>
            </div>
            <div style="width: 100%;">
                <p style="float: left;width: 50%;text-align: left;"><b>{{detailData?.course.price}}</b> {{detailData?.course.currency}}</p>
                <p style="float: left;width: 50%;text-align: right;"><b>{{detailData?.course.max_participants}}</b></p>
            </div>
            </div>
            <ng-container *ngIf="detailData?.course.course_type == 1">
                <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>
                <div style="float: left; width: 100%;margin-top: 5%;">
                <ul>
                    <ng-container *ngFor="let date of detailData?.course.course_dates">
                        <li [ngClass]="{'font-bold': date.id == detailData?.course_date_id}">{{getDateFormatLong(date.date)}} <i style="text-align: right;float:right">{{getHourRangeFormat(date.hour_start,date.hour_end)}}</i></li>
                    </ng-container>
                </ul>
                </div>
            </ng-container>
            <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

        </mat-card-header>
        <mat-card-content>
          <div style="float: left; width: 100%;margin-bottom:24px;">
            <div style="float: left;width: 100%;">
                <!--ESTAS IMAGENES VENDRAN DEL detailData?.SPORT -> icon box -->
                <div style="float: left; width: 20%; margin-top: 5%">
                    <img style="width: 75px; height: 75px;" *ngIf="detailData?.course?.course_type == 1" [src]="'https://school.boukii.com/assets/icons/collectif_'+ detailData?.sport?.name.toLowerCase() +'2x.png'" width="100" height="100" />
                    <img style="width: 75px; height: 75px;" *ngIf="detailData?.course?.course_type == 2" [src]="'https://school.boukii.com/assets/icons/prive_'+ detailData?.sport?.name.toLowerCase() +'2x.png'" width="100" height="100" />
                </div>
                <div style="float: left; width: 75%;margin:6% 0 0 2%">
                <p><strong>{{detailData?.course?.name}}</strong></p>
                <p>
                    <ng-container *ngIf="detailData?.course?.course_type == 1">
                        Collectif
                    </ng-container>
                    <ng-container *ngIf="detailData?.course?.course_type == 2">
                        Private
                    </ng-container>
                    <ng-container *ngIf="detailData?.sport">
                        {{detailData?.sport.name}}
                    </ng-container>
                </p>
                </div>
            </div>
          </div>
          <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

            <div *ngIf="detailData?.course?.course_type == 1" class="box-detail-boxes">
                <div class="box-detail-box" [ngStyle]="{'background': detailData?.degree?.color}">
                    <img src="https://school.boukii.com/assets/icons/award_icon.svg" style="width:24px;height:24px;" />
                    <div class="font-bold font-white">{{detailData?.degree?.annotation}}</div>
                    <div class="font-bold font-white">{{detailData?.degree?.name}}</div>
                    <div class="font-bold font-white">{{getSubGroupsIndex()}}</div>
                </div>
                <div class="box-detail-box box-background-grey">
                    <img src="https://school.boukii.com/assets/icons/icons-outline-profile-2-user-white.svg" style="width:24px;height:24px;" />
                    <div>Grupos</div>
                    <div class="font-bold">{{getGroupsQuantity()}}</div>
                </div>
                <div class="box-detail-box box-background-grey">
                    <img src="https://school.boukii.com/assets/icons/icons-outline-clock.svg" style="width:24px;height:24px;" />
                    <div>Duración</div>
                    <div class="font-bold">{{getHoursMinutes(detailData?.hour_start,detailData?.hour_end)}}</div>
                </div>
                <div class="box-detail-box box-background-grey">
                    <img src="https://school.boukii.com/assets/icons/icons-outline-calendar-tick.svg" style="width:24px;height:24px;" />
                    <div>Días</div>
                    <div class="font-bold">{{getDateIndex()}}/{{detailData?.course?.course_dates?.length}}</div>
                </div>
            </div>

            <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

            <ng-container *ngIf="detailData?.course.course_type == 2">

                <div style="width: 100%;float:left;margin-bottom:12px;">
                    <mat-card-title class="font-bold" style="float: left;width: 80%;">Reserva</mat-card-title>
                </div>

                <div style="float: left; width: 100%;">
                    <ul>
                        <li class="font-bold">{{getDateFormatLong(detailData?.date_full)}} <i style="text-align: right;float:right">{{getHourRangeFormat(detailData?.hour_start,calculateHourEnd(detailData?.hour_start,detailData.course.duration))}}</i></li>
                    </ul>
                </div>

                <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

                <div style="width: 100%;float:left;margin-bottom:12px;">
                    <mat-card-title class="font-bold" style="float: left;width: 100%;">Utilizador</mat-card-title>
                </div>

                <div style="display:flex;width:100%;flex-direction:column;gap:8px;">
                  <div *ngFor="let client of detailData?.users" class="box-detail-user-block">
                    <app-level-user *ngIf="detailData.sport" [allLevels]="getAllLevelsBySport()"
                      [selectLevel]="getClientDegree(detailData?.sport.id, client.sports)" [size]="60" [userImage]="getClient(client.client_id).image ? getClient(client.client_id).image : 'assets/img/avatar.png'"></app-level-user>
                        <div class="box-detail-user-block-text">
                            <div>{{ getClient(client.client_id)?.first_name }} {{ getClient(client.client_id)?.last_name }}</div>
                            <span>
                                <ng-container *ngIf="getClient(client.client_id)?.language1_id">
                                    {{getLanguageById(getClient(client.client_id)?.language1_id)}} ·
                                </ng-container>
                                <ng-container *ngIf="getClient(client.client_id)?.language2_id">
                                    {{getLanguageById(getClient(client.client_id)?.language2_id)}} ·
                                </ng-container>
                                <ng-container *ngIf="getClient(client.client_id)?.language3_id">
                                    {{getLanguageById(getClient(client.client_id)?.language3_id)}} ·
                                </ng-container>
                                {{getCountryById(getClient(client.client_id)?.country)}} · {{getBirthYears(getClient(client.client_id)?.birth_date)}} ans
                                · {{getClient(client.client_id)?.phone}} · {{getClient(client.client_id)?.email}}
                            </span>
                            <div *ngIf="detailData?.degree" class="box-detail-user-blocklevel" [ngStyle]="{'background': detailData?.degree.color}">
                                {{detailData?.degree.name}}
                            </div>
                        </div>
                    </div>
                </div>

                <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

            </ng-container>

            <div style="width: 100%;float:left;margin-bottom:12px;">
                <mat-card-title class="font-bold" style="float: left;width: 80%;">Monitor</mat-card-title>
            </div>

            <div *ngIf="defaults" class="box-detail-user-block">
                <div class="box-detail-user-block-img">
                    <img [src]="defaults.image ? defaults.image : 'assets/img/avatar.png'" />
                </div>
                <div class="box-detail-user-block-text">
                    <div>{{ defaults.first_name }} {{ defaults.last_name }}</div>
                    <span>
                        <ng-container *ngIf="defaults.language1_id">
                            {{getLanguageById(defaults.language1_id)}} ·
                        </ng-container>
                        {{getCountryById(defaults.country)}} · {{getBirthYears(defaults.birth_date)}} ans
                        · {{defaults.phone}} · {{defaults.email}}
                    </span>
                </div>
            </div>

            <ng-container *ngIf="detailData?.course.course_type == 1">
                <div style="width: 100%;float:left;margin-top:32px;margin-bottom:12px;">
                    <mat-card-title class="font-bold" style="float: left;width: 80%;">Alumnos {{detailData?.users.length}}/{{detailData?.course.max_participants}}</mat-card-title>
                    <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:swap_horiz"></mat-icon>
                </div>

                <div style="display:flex;width:100%;flex-direction:column;gap:8px;">
                    <div *ngFor="let client of detailData?.users" class="box-detail-user-block">
                        <app-level-user *ngIf="detailData.sport" [allLevels]="getAllLevelsBySport()"
                          [selectLevel]="getClientDegree(detailData?.sport.id, client.sports)" [size]="60" [userImage]="getClient(client.client_id).image ? getClient(client.client_id).image : 'assets/img/avatar.png'"></app-level-user>
                        <div class="box-detail-user-block-text">
                            <div>{{ getClient(client.client_id)?.first_name }} {{ getClient(client.client_id)?.last_name }}</div>
                            <span>
                                <ng-container *ngIf="getClient(client.client_id)?.language1_id">
                                    {{getLanguageById(getClient(client.client_id)?.language1_id)}} ·
                                </ng-container>
                                <ng-container *ngIf="getClient(client.client_id)?.language2_id">
                                    {{getLanguageById(getClient(client.client_id)?.language2_id)}} ·
                                </ng-container>
                                <ng-container *ngIf="getClient(client.client_id)?.language3_id">
                                    {{getLanguageById(getClient(client.client_id)?.language3_id)}} ·
                                </ng-container>
                                {{getCountryById(getClient(client.client_id)?.country)}} · {{getBirthYears(getClient(client.client_id)?.birth_date)}} ans
                                · {{getClient(client.client_id)?.phone}} · {{getClient(client.client_id)?.email}}
                            </span>
                        </div>
                    </div>
                </div>
            </ng-container>

        </mat-card-content>
      </mat-card>
      </vex-page-layout-content>
    </mat-tab>
    <mat-tab label="Planning">

      <vex-monitor-calendar></vex-monitor-calendar>
    </mat-tab>
    <mat-tab label="Statistiques" *ngIf="false">

    </mat-tab>
  </mat-tab-group>
</div>

</div>
