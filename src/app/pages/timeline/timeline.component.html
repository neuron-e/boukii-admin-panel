<vex-page-layout>

    <vex-secondary-toolbar>
      <vex-breadcrumbs [crumbs]="['timeline.timeline', 'list']" class="flex-auto"></vex-breadcrumbs>

      <button class="ml-2" color="primary" mat-icon-button type="button">
        <mat-icon svgIcon="mat:more_vert"></mat-icon>
      </button>
    </vex-secondary-toolbar>
    <vex-page-layout-content class="-mt-6 fullwidth">

        <div class="full-page-timeline" [ngClass]="{'timeline-with-detail': showDetail || showBlock}">
            <div class="header-navigation">
                <div class="header-navigation-flex">
                    <div class="date-navigation">
                    <span *ngIf="timelineView == 'day'">{{ currentDate | date: 'longDate' }}</span>
                    <span *ngIf="timelineView == 'week'">{{ currentWeek }}</span>
                    <span *ngIf="timelineView == 'month'">{{ currentMonth }}</span>
                    <button (click)="goToPrevious()">&lt;</button>
                    <button (click)="goToNext()">&gt;</button>
                    <button (click)="showFilter = !showFilter" class="filter-button"><mat-icon svgIcon="mat:filter_list"></mat-icon></button>

                    <button *ngIf="showResetFilters()" mat-button type="button" (click)="resetFilters()">{{'timeline.reset_filters' | translate}}</button>
                    <button *ngIf="showFilter" color="primary" mat-raised-button (click)="applyFilters()">{{'timeline.apply_filters' | translate}}</button>

                    <mat-form-field class="flex-auto">
                        <input matInput [matDatepicker]="pickerFrom" placeholder="{{'date' | translate }}" [(ngModel)]="searchDate" (ngModelChange)="onDateChange()">
                        <mat-datepicker-toggle matSuffix [for]="pickerFrom"></mat-datepicker-toggle>
                        <mat-datepicker #pickerFrom></mat-datepicker>
                    </mat-form-field>

                    <button (click)="toggleBlockGeneral()" class="filter-button"><mat-icon svgIcon="mat:block"></mat-icon></button>
                    </div>

                    <div class="view-selection">
                        <span class="view-option" [ngClass]="{'selected': timelineView == 'day'}" (click)="changeView('day')">{{'day' | translate}}</span>
                        <span class="view-option" [ngClass]="{'selected': timelineView == 'week'}" (click)="changeView('week')">{{'week' | translate}}</span>
                        <span class="view-option" [ngClass]="{'selected': timelineView == 'month'}" (click)="changeView('month')">{{'month' | translate}}</span>
                    </div>
                </div>

                <div *ngIf="showFilter" class="filter-container">
                    <div class="filter-container-column">
                        <span>{{ 'monitor' | translate | uppercase }}</span>
                        <mat-form-field appearance="fill">
                        <mat-select [(ngModel)]="filterMonitor" color="primary">
                            <ng-container *ngFor="let monitor of allMonitors">
                                <mat-option *ngIf="monitor.id" [value]="monitor.id">{{monitor.first_name}} {{monitor.last_name}}</mat-option>
                            </ng-container>
                        </mat-select>
                        </mat-form-field>
                    </div>

                    <!--
                    <div class="filter-container-column">
                      <span>MONITEURS</span>
                      <mat-checkbox color="primary" [(ngModel)]="filterFree">Libre</mat-checkbox>
                      <mat-checkbox color="primary" [(ngModel)]="filterOccupied">Ocupé</mat-checkbox>
                    </div>
                    -->

                    <div class="filter-container-column">
                      <span>{{"timeline.event_type" | translate | uppercase }}</span>
                      <mat-checkbox color="primary" [(ngModel)]="filterCollective">{{ 'course_colective' | translate}}</mat-checkbox>
                      <mat-checkbox color="primary" [(ngModel)]="filterPrivate">{{ 'course_private' | translate}}</mat-checkbox>
                      <mat-checkbox color="primary" [(ngModel)]="filterNwd">{{ 'no_disponible' | translate}}</mat-checkbox>
                      <mat-checkbox color="primary" [(ngModel)]="filterBlockPayed">{{ 'paid_block' | translate}}</mat-checkbox>
                      <mat-checkbox color="primary" [(ngModel)]="filterBlockNotPayed">{{ 'no_paid_block' | translate}}</mat-checkbox>
                    </div>

                    <div class="filter-container-column">
                      <span>{{'sport' | translate | uppercase}}</span>
                      <mat-checkbox *ngFor="let sport of sports" color="primary"
                            [checked]="checkedSports.has(sport.id)"
                            (change)="onCheckChange(sport.id, $event.checked)">
                        {{ sport.name }}
                      </mat-checkbox>
                    </div>
                </div>
            </div>

            <div>

                <div class="schedule-container" *ngIf="filteredMonitors && filteredMonitors.length && timelineView != 'month'">
                    <div class="monitors-column">
                        <ng-container *ngFor="let monitor of filteredMonitors">
                            <div class="monitor">
                                <ng-container *ngIf="monitor.id">
                                    <div class="monitor-left">
                                        <div class="monitor-img-wrapper">
                                            <img [src]="monitor.image ? monitor.image : 'assets/img/avatar.png'" />
                                        </div>
                                        <div class="monitor-text">
                                            <div class="monitor-lang">
                                                <ng-container *ngIf="monitor.language1_id">
                                                    {{getLanguageById(monitor.language1_id)}} ·
                                                </ng-container>
                                                <ng-container *ngIf="monitor.language2_id">
                                                    {{getLanguageById(monitor.language2_id)}} ·
                                                </ng-container>
                                                <ng-container *ngIf="monitor.language3_id">
                                                    {{getLanguageById(monitor.language3_id)}} ·
                                                </ng-container>
                                            </div>
                                            <div class="monitor-title">
                                                {{ monitor.first_name }} {{ monitor.last_name }}
                                            </div>
                                            <div class="monitor-icons">
                                                <img src="assets/img/icons/icon-message-grey.png" />
                                                <img src="assets/img/icons/icon-mail-grey.png" />
                                                <img src="assets/img/icons/icon-phone-grey.png" />
                                                <img src="assets/img/icons/icon-calendar-grey.png" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="monitor-right">
                                        <div *ngFor="let sport of monitor.sports" class="monitor-sport">
                                            <img [src]="sport.icon_selected" [title]="sport.name"/>
                                        </div>
                                    </div>
                                </ng-container>
                                <ng-container *ngIf="!monitor.id">
                                    <div class="monitor-left">
                                        <div class="monitor-img-wrapper"></div>
                                        <div class="monitor-text">
                                            <div class="monitor-title">
                                                {{'no_monitor' | translate}}
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </div>
                        </ng-container>
                    </div>
                    <div class="hours-container">
                    <div class="hours-row" *ngIf="timelineView == 'day'">
                        <div class="hour" *ngFor="let hour of hoursRange">{{ hour }}</div>
                    </div>
                    <div class="hours-row" *ngIf="timelineView == 'week'">
                        <div class="day" *ngFor="let day of weekDays;let dayIndex = index">{{ day | translate }} {{ getDayOfWeek(dayIndex) }}</div>
                    </div>
                    <div class="grid-container">
                        <div class="grid-row" *ngFor="let monitor of filteredMonitors;let monitorIndex = index"  [ngClass]="{'outside-month-day': !isDayVisibleDay() && timelineView == 'day', 'select-row': moveTask && monitor.id !== taskMoved.monitor_id}" (click)="moveMonitor(monitor.id,$event)">
                            <ng-container *ngIf="timelineView == 'day'">
                                <div class="grid-cell" *ngFor="let hour of hoursRange" (dblclick)="handleDbClickEvent('Clicked', $event, 'day', hour, monitor.id)">
                                    <div *ngIf="monitorIndex % 5 === 0  && monitorIndex !== 0" class="hour-day-scroll">{{ hour }}</div>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="timelineView == 'week'">
                                <div class="grid-cell-day" *ngFor="let day of weekDays;let dayIndex = index" [ngClass]="{'outside-month': !isDayVisibleWeek(dayIndex)}">
                                    <div class="grid-cell-inside" *ngFor="let hour of hoursRangeMinusLast" (dblclick)="handleDbClickEvent('Clicked', $event, 'week', dayIndex, monitor.id, hour)"></div>
                                    <div *ngIf="monitorIndex % 5 === 0  && monitorIndex !== 0" class="hour-day-scroll">{{ day }} {{ getDayOfWeek(dayIndex) }}</div>
                                </div>
                            </ng-container>
                        </div>

                        <!--TASKS-->
                        <ng-container *ngFor="let task of plannerTasks">
                            <!--DAY-->
                            <div *ngIf="timelineView == 'day'" (click)="task.block_id ? toggleBlock(task) : toggleDetail(task)" (contextmenu)="toggleDetailMove(task, $event)" class="task-wrapper cursor-pointer" [ngClass]="[
                                (task.booking_id && ((idDetail == task.booking_id && hourDetail == task.hour_start && dateDetail == task.date && monitorDetail == task.monitor_id) || (idGroupedTasks == task.booking_id && hourGrouped == task.hour_start && dateGrouped == task.date))) ?
                                (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') :
                                '',
                                task.class,
                                (task.block_id && idBlock == task.block_id) ? 'border-selected' : ''
                            ]" [ngStyle]="task.style">
                                <div class="task-text">
                                    <img *ngIf="(task.type=='collective' || task.type=='private') && task.sport" [src]="task.sport.icon_selected" />
                                    <div>{{ task.name }}</div>
                                </div>
                                <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks">
                                    <!-- PENDING LEVEL -->
                                    <ng-container *ngIf="!task.grouped_tasks || !(task.grouped_tasks.length > 1)">
                                        <div class="task-block-level" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                                        <div *ngIf="task.type=='collective'" class="task-block-people">{{task.clients_number}}/{{task.max_participants}}</div>
                                    </ng-container>
                                    <ng-container *ngIf="task.grouped_tasks && task.grouped_tasks.length > 1">
                                        <div class="task-block-grouped">+ {{task.grouped_tasks.length}}</div>
                                    </ng-container>
                                </div>
                            </div>
                            <!--WEEK-->
                            <div *ngIf="timelineView == 'week'" (click)="task.block_id ? toggleBlock(task) : toggleDetail(task)" (contextmenu)="toggleDetailMove(task, $event)" class="task-wrapper-week cursor-pointer" [ngClass]="[
                                (task.booking_id && ((idDetail == task.booking_id && hourDetail == task.hour_start && dateDetail == task.date && monitorDetail == task.monitor_id) || (idGroupedTasks == task.booking_id && hourGrouped == task.hour_start && dateGrouped == task.date))) ?
                                (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') :
                                '',
                                task.class,
                                (task.block_id && idBlock == task.block_id) ? 'border-selected' : ''
                            ]" [ngStyle]="task.styleWeek">
                                <img class="sport-img-week" *ngIf="(!task.styleWeek.height || (task.styleWeek.height && task.styleWeek.height == '100px')) && ((task.type=='collective' || task.type=='private') && task.sport)" [src]="task.sport.icon_selected" />
                                <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks-week">
                                    <!-- PENDING LEVEL -->
                                    <ng-container *ngIf="!task.grouped_tasks || !(task.grouped_tasks.length > 1)">
                                        <div class="task-block-level-week" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                                        <div *ngIf="task.type=='collective'" class="task-block-people-week">{{task.clients_number}}/{{task.max_participants}}</div>
                                    </ng-container>
                                    <ng-container *ngIf="task.grouped_tasks && task.grouped_tasks.length > 1">
                                        <div class="task-block-grouped-week">+ {{task.grouped_tasks.length}}</div>
                                    </ng-container>
                                </div>
                            </div>
                        </ng-container>

                    </div>
                    </div>
                </div>


                <div class="schedule-container" *ngIf="filteredMonitors && filteredMonitors.length && timelineView == 'month'">
                    <div class="monitors-column">
                    <ng-container *ngFor="let monitor of filteredMonitors; let monitorIndex = index">
                        <ng-container *ngFor="let week of weeksInMonth; let weekIndex = index">
                            <div class="monitor" [ngClass]="{'big-border': weekIndex === 0 && monitorIndex !== 0}">
                                <ng-container *ngIf="weekIndex === 0">
                                    <ng-container *ngIf="monitor.id">
                                        <div class="monitor-left">
                                            <div class="monitor-img-wrapper">
                                                <img [src]="monitor.image ? monitor.image : 'assets/img/avatar.png'" />
                                            </div>
                                            <div class="monitor-text">
                                                <div class="monitor-lang">
                                                    FR · EN · ES
                                                </div>
                                                <div class="monitor-title">
                                                    {{ monitor.first_name }} {{ monitor.last_name }}
                                                </div>
                                                <div class="monitor-icons">
                                                    <img src="assets/img/icons/icon-message-grey.png" />
                                                    <img src="assets/img/icons/icon-mail-grey.png" />
                                                    <img src="assets/img/icons/icon-phone-grey.png" />
                                                    <img src="assets/img/icons/icon-calendar-grey.png" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="monitor-right">
                                            <div *ngFor="let sport of monitor.sports" class="monitor-sport">
                                                <img [src]="sport.icon_selected" [title]="sport.name"/>
                                            </div>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="!monitor.id">
                                        <div class="monitor-left">
                                            <div class="monitor-img-wrapper"></div>
                                            <div class="monitor-text">
                                                <div class="monitor-title">
                                                    {{ 'no_monitor' | translate}}
                                                </div>
                                            </div>
                                        </div>
                                    </ng-container>
                                </ng-container>

                                <div class="day-start-week">
                                    {{ week.startDay }}
                                </div>
                                <div class="day-end-week">
                                    {{ week.endDay }}
                                </div>

                            </div>
                        </ng-container>
                    </ng-container>
                    </div>
                    <div class="hours-container">
                    <div class="hours-row">
                        <div class="day" *ngFor="let day of weekDays">{{ day }}</div>
                    </div>
                    <div class="grid-container">
                        <ng-container *ngFor="let monitor of filteredMonitors; let monitorIndex = index">
                            <div class="grid-row" *ngFor="let week of weeksInMonth;let weekIndex = index" [ngClass]="{'select-row': moveTask && monitor.id !== taskMoved.monitor_id}" (click)="moveMonitor(monitor.id,$event)">
                                <div class="grid-cell-day" *ngFor="let day of weekDays;let dayIndex = index" [ngClass]="{'outside-month': !isDayInMonth(dayIndex, weekIndex),'big-border': weekIndex === 0 && monitorIndex !== 0}">
                                    <div class="grid-cell-inside" *ngFor="let hour of hoursRangeMinusLast" (dblclick)="handleDbClickEvent('Clicked', $event, 'month', dayIndex, monitor.id, hour, weekIndex)"></div>
                                    <div *ngIf="weekIndex === 0 && monitorIndex !== 0" class="hour-day-scroll">{{ day }}</div>
                                </div>
                            </div>
                        </ng-container>

                        <!--TASKS-->
                        <ng-container *ngFor="let task of plannerTasks">
                            <!--MONTH-->
                            <div class="task-wrapper-week cursor-pointer" (click)="task.block_id ? toggleBlock(task) : toggleDetail(task)" (contextmenu)="toggleDetailMove(task, $event)" [ngClass]="[
                                (task.booking_id && ((idDetail == task.booking_id && hourDetail == task.hour_start && dateDetail == task.date && monitorDetail == task.monitor_id) || (idGroupedTasks == task.booking_id && hourGrouped == task.hour_start && dateGrouped == task.date))) ?
                                (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') :
                                '',
                                task.class,
                                (task.block_id && idBlock == task.block_id) ? 'border-selected' : ''
                            ]" [ngStyle]="task.styleMonth">
                                <img class="sport-img-week" *ngIf="(!task.styleMonth.height || (task.styleMonth.height && task.styleMonth.height == '100px')) && ((task.type=='collective' || task.type=='private') && task.sport)" [src]="task.sport.icon_selected" />
                                <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks-week">
                                    <!-- PENDING LEVEL -->
                                    <ng-container *ngIf="!task.grouped_tasks || !(task.grouped_tasks.length > 1)">
                                        <div class="task-block-level-week" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                                        <div *ngIf="task.type=='collective'" class="task-block-people-week">{{task.clients_number}}/{{task.max_participants}}</div>
                                    </ng-container>
                                    <ng-container *ngIf="task.grouped_tasks && task.grouped_tasks.length > 1">
                                        <div class="task-block-grouped-week">+ {{task.grouped_tasks.length}}</div>
                                    </ng-container>
                                </div>
                            </div>
                        </ng-container>

                    </div>
                    </div>
                </div>

            </div>

            <!--Modal Grouped Tasks-->
            <div *ngIf="showGrouped" class="modal-grouped">
                <div class="modal-grouped-close">
                    <mat-icon class="cursor-pointer" svgIcon="mat:close" (click)="hideGrouped()"></mat-icon>
                </div>
                <div *ngFor="let task of groupedTasks" (click)="toggleDetail(task)" class="modal-grouped-task-wrapper cursor-pointer" (contextmenu)="toggleDetailMove(task, $event)" [ngClass]="[
                    (task.booking_id && (idDetail == task.booking_id && hourDetail == task.hour_start && dateDetail == task.date && monitorDetail == task.monitor_id && subgroupDetail == task.course_subgroup_id)) ?
                    (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') :
                    '',
                    task.class
                ]">
                    <div class="task-text">
                        <img *ngIf="(task.type=='collective' || task.type=='private') && task.sport" [src]="task.sport.icon_selected" />
                        <div>{{ task.name }}</div>
                    </div>
                    <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks">
                        <!-- PENDING LEVEL -->
                        <div class="task-block-level" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                        <div *ngIf="task.type=='collective'" class="task-block-people">{{task.clients_number}}/{{task.max_participants}}</div>
                    </div>
                </div>
            </div>


        </div>


        <vex-page-layout-content class="-mt-6 fullwidth box-detail-timeline" *ngIf="showDetail && taskDetail">
            <mat-card style="padding: 0 3%;">
            <mat-card-header style="display:block">
                <div style="width: 100%;float: left;">
                <mat-icon class="cursor-pointer" svgIcon="mat:close" (click)="hideDetail()"></mat-icon>
                <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:edit" (click)="goToEditCourse()"></mat-icon>

                </div>
                <div style="width: 100%;float:left;">
                <mat-card-title class="font-bold" style="float: left;width: 80%;">{{ 'course_detail' | translate}}</mat-card-title>
                </div>
                <div style="width:100%; margin-top:5%;float:left">
                <div style="width: 100%;">
                    <p style="float: left;width: 80%;text-align: left;"><b>{{ 'from' | translate}}</b></p>
                    <p style="float: left;width: 20%;text-align: right;"><b>{{ 'to' | translate}}</b></p>
                </div>
                <div style="width: 100%;">
                    <p style="float: left;width: 50%;text-align: left;"><b>{{taskDetail.date_start}}</b></p>
                    <p style="float: left;width: 50%;text-align: right;"><b>{{taskDetail.date_end}}</b></p>
                </div>
                </div>
                <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

                <div style="width:100%; margin-top:5%;float:left">
                <div style="width: 100%;">
                    <p style="float: left;width: 35%;text-align: left;"><b>{{ 'price' | translate}}</b></p>
                    <p style="float: left;width: 65%;text-align: right;"><b>{{ 'max_pax' | translate}}</b></p>
                </div>
                <div style="width: 100%;">
                    <p style="float: left;width: 50%;text-align: left;"><b>{{taskDetail.course.price}}</b> {{taskDetail.course.currency}}</p>
                    <p style="float: left;width: 50%;text-align: right;"><b>{{taskDetail.course.max_participants}}</b></p>
                </div>
                </div>
                <ng-container *ngIf="taskDetail.type == 'collective'">
                    <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>
                    <div style="float: left; width: 100%;margin-top: 5%;">
                    <ul>
                        <ng-container *ngFor="let date of taskDetail.course.course_dates">
                            <li [ngClass]="{'font-bold': date.id == taskDetail.course_date_id}">{{getDateFormatLong(date.date)}} <i style="text-align: right;float:right">{{getHourRangeFormat(date.hour_start,date.hour_end)}}</i></li>
                        </ng-container>
                    </ul>
                    </div>
                </ng-container>
                <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

            </mat-card-header>
            <mat-card-content>
                <div style="float: left; width: 100%;margin-bottom:24px;">
                <div style="float: left;width: 100%;">
                    <!--ESTAS IMAGENES VENDRAN DEL TASKDETAIL.SPORT -> icon box -->
                    <div style="float: left; width: 20%; margin-top: 5%">
                        <img *ngIf="taskDetail.type == 'collective'" src="https://school.boukii.com/assets/icons/collectif_ski2x.png" width="100" height="100" />
                        <img *ngIf="taskDetail.type == 'private'" src="https://school.boukii.com/assets/icons/prive_ski2x.png" width="100" height="100" />
                    </div>
                    <div style="float: left; width: 75%;margin:6% 0 0 2%">
                    <p><strong>{{taskDetail.name}}</strong></p>
                    <p>
                        <ng-container *ngIf="taskDetail.type == 'collective'">
                            {{ 'colective' | translate}}
                        </ng-container>
                        <ng-container *ngIf="taskDetail.type == 'private'">
                            {{ 'private' | translate}}
                        </ng-container>
                        <ng-container *ngIf="taskDetail.sport">
                            {{taskDetail.sport.name}}
                        </ng-container>
                    </p>
                    </div>
                </div>
                </div>

                <div *ngIf="taskDetail.type == 'collective'" class="box-detail-boxes">
                    <div class="box-detail-box" [ngStyle]="{'background': taskDetail.degree.color}">
                        <img src="https://school.boukii.com/assets/icons/award_icon.svg" style="width:24px;" />
                        <div class="font-bold font-white">{{taskDetail.degree.annotation}}</div>
                        <div class="font-bold font-white">{{taskDetail.degree.name}}</div>
                        <div class="font-bold font-white">{{taskDetail.subgroup_number}}</div>
                    </div>
                    <div class="box-detail-box box-background-grey">
                        <img src="https://school.boukii.com/assets/icons/icons-outline-profile-2-user-white.svg" style="width:24px;" />
                        <div>{{'groups' |translate}}</div>
                        <div class="font-bold">{{taskDetail.total_subgroups}}</div>
                    </div>
                    <div class="box-detail-box box-background-grey">
                        <img src="https://school.boukii.com/assets/icons/icons-outline-clock.svg" style="width:24px;" />
                        <div>{{'duration' |translate}}</div>
                        <div class="font-bold">{{getHoursMinutes(taskDetail.hour_start,taskDetail.hour_end)}}</div>
                    </div>
                    <div class="box-detail-box box-background-grey">
                        <img src="https://school.boukii.com/assets/icons/icons-outline-calendar-tick.svg" style="width:24px;" />
                        <div>{{'days' |translate}}</div>
                        <div class="font-bold">{{taskDetail.date_index}}/{{taskDetail.course.course_dates.length}}</div>
                    </div>
                </div>

                <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

                <ng-container *ngIf="taskDetail.type == 'private'">

                    <div style="width: 100%;float:left;margin-bottom:12px;">
                        <mat-card-title class="font-bold" style="float: left;width: 80%;">{{'booking' | translate}}</mat-card-title>
                        <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:edit" (click)="detailBooking()"></mat-icon>
                    </div>

                    <div style="float: left; width: 100%;">
                        <ul>
                            <li class="font-bold">{{getDateFormatLong(taskDetail.date_full)}} <i style="text-align: right;float:right">{{getHourRangeFormat(taskDetail.hour_start,taskDetail.hour_end)}}</i></li>
                        </ul>
                    </div>

                    <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

                    <div style="width: 100%;float:left;margin-bottom:12px;">
                        <mat-card-title class="font-bold" style="float: left;width: 100%;">{{'user' | translate }}</mat-card-title>
                    </div>

                    <div style="display:flex;width:100%;flex-direction:column;gap:8px;">
                        <div *ngFor="let client of taskDetail.all_clients" class="box-detail-user-block">
                            <app-level-user *ngIf="taskDetail.degrees_sport && taskDetail.degrees_sport.length" [allLevels]="taskDetail.degrees_sport" [selectLevel]="getClientDegree(taskDetail.sport_id,client.client.sports)" [size]="80" [userImage]="client.client.image ? client.client.image : 'assets/img/avatar.png'"></app-level-user>
                            <div class="box-detail-user-block-text">
                                <div>{{ client.client.first_name }} {{ client.client.last_name }}</div>
                                <span>
                                    <ng-container *ngIf="client.client.language1_id">
                                        {{getLanguageById(client.client.language1_id)}} ·
                                    </ng-container>
                                    <ng-container *ngIf="client.client.language2_id">
                                        {{getLanguageById(client.client.language2_id)}} ·
                                    </ng-container>
                                    <ng-container *ngIf="client.client.language3_id">
                                        {{getLanguageById(client.client.language3_id)}} ·
                                    </ng-container>
                                    {{getCountryById(client.client.country)}} · {{getBirthYears(client.client.birth_date)}} {{'years' |translate}}
                                    · {{client.client.phone}} · {{client.client.email}}
                                </span>
                                <div *ngIf="taskDetail.degree" class="box-detail-user-blocklevel" [ngStyle]="{'background': taskDetail.degree.color}">
                                    {{taskDetail.degree.name}}
                                </div>
                            </div>
                        </div>
                    </div>

                    <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

                </ng-container>

                <div style="width: 100%;float:left;margin-bottom:12px;">
                    <mat-card-title class="font-bold" style="float: left;width: 80%;">{{'monitor' |translate}}</mat-card-title>
                    <mat-icon (click)="openEditMonitor()" class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:edit"></mat-icon>
                </div>

                <div *ngIf="taskDetail.monitor" class="box-detail-user-block">
                    <div class="box-detail-user-block-img">
                        <img [src]="taskDetail.monitor.image ? taskDetail.monitor.image : 'assets/img/avatar.png'" />
                    </div>
                    <div class="box-detail-user-block-text">
                        <div>{{ taskDetail.monitor.first_name }} {{ taskDetail.monitor.last_name }}</div>
                        <span>
                            <ng-container *ngIf="taskDetail.monitor.language1_id">
                                {{getLanguageById(taskDetail.monitor.language1_id)}} ·
                            </ng-container>
                            {{getCountryById(taskDetail.monitor.country)}} · {{getBirthYears(taskDetail.monitor.birth_date)}}{{'years' | translate }}
                            · {{taskDetail.monitor.phone}} · {{taskDetail.monitor.email}}
                        </span>
                    </div>
                </div>
                <div *ngIf="!taskDetail.monitor">
                    {{'no_monitor' | translate}}
                </div>

                <ng-container *ngIf="showEditMonitor">
                  <mat-spinner *ngIf="loadingMonitors"></mat-spinner>

                    <div style="width: 100%;float:left;margin-top:16px;margin-bottom:12px;">
                        <mat-card-title class="font-bold" style="float: left;width: 100%;">{{'new_monitor' | translate}}</mat-card-title>
                    </div>
                    <mat-form-field class="flex-auto" style="width: 100%;">
                        <mat-select placeholder="{{'new_monitor' | translate}}" [(ngModel)]="editedMonitor"  *ngIf="!loadingMonitors">
                            <mat-option *ngIf="taskDetail.monitor_id" [value]="nullMonitor">
                                {{'no_monitor_choose' | translate}}
                            </mat-option>
                            <ng-container *ngFor="let monitor of monitorsForm" >
                                <mat-option *ngIf="monitor.id != taskDetail.monitor_id" [value]="monitor">
                                    {{ monitor.first_name }} {{ monitor.last_name }}
                                </mat-option>
                            </ng-container>
                        </mat-select>
                    </mat-form-field>

                    <div class="actions flex items-center justify-end gap-2">
                        <button (click)="hideEditMonitor()" mat-button type="button">{{'cancel' | translate}}</button>
                        <button (click)="saveEditedMonitor()" [disabled]="!editedMonitor" color="primary" mat-raised-button matStepperNext>
                          {{'save' | translate}}
                        </button>
                      </div>
                </ng-container>

                <ng-container *ngIf="taskDetail.type == 'collective'">
                    <div style="width: 100%;float:left;margin-top:32px;margin-bottom:12px;">
                        <mat-card-title class="font-bold" style="float: left;width: 80%;">{{'students' | translate}} {{taskDetail.clients_number}}/{{taskDetail.max_participants}}</mat-card-title>
                        <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:swap_horiz" (click)="openUserTransfer()"></mat-icon>
                    </div>

                    <div style="display:flex;width:100%;flex-direction:column;gap:8px;">
                        <div *ngFor="let client of taskDetail.all_clients" class="box-detail-user-block">
                            <app-level-user *ngIf="taskDetail.degrees_sport && taskDetail.degrees_sport.length" [allLevels]="taskDetail.degrees_sport" [selectLevel]="getClientDegree(taskDetail.sport_id,client.client.sports)" [size]="60" [userImage]="client.client.image ? client.client.image : 'assets/img/avatar.png'"></app-level-user>
                            <div class="box-detail-user-block-text">
                                <div>{{ client.client.first_name }} {{ client.client.last_name }}</div>
                                <span>
                                    <ng-container *ngIf="client.client.language1_id">
                                        {{getLanguageById(client.client.language1_id)}} ·
                                    </ng-container>
                                    <ng-container *ngIf="client.client.language2_id">
                                        {{getLanguageById(client.client.language2_id)}} ·
                                    </ng-container>
                                    <ng-container *ngIf="client.client.language3_id">
                                        {{getLanguageById(client.client.language3_id)}} ·
                                    </ng-container>
                                    {{getCountryById(client.client.country)}} · {{getBirthYears(client.client.birth_date)}} {{'years' |translate}}
                                    · {{client.client.phone}} · {{client.client.email}}
                                </span>
                            </div>
                        </div>
                    </div>
                </ng-container>

            </mat-card-content>
            </mat-card>
        </vex-page-layout-content>


        <vex-page-layout-content class="-mt-6 fullwidth box-detail-timeline" *ngIf="showBlock && blockDetail">
            <mat-card style="padding: 0 3%;">
            <mat-card-header style="display:block">
                <div style="width: 100%;float: left;">
                <mat-icon class="cursor-pointer" svgIcon="mat:close" (click)="hideBlock()"></mat-icon>

                </div>
                <div style="width: 100%;float:left;">
                <mat-card-title class="font-bold" style="float: left;width: 80%;">{{'block_detail' | translate }}</mat-card-title>
                <div style="float: right;display: flex;gap: 6px;align-items: center;">
                    <mat-icon (click)="openEditBlock()" class="cursor-pointer" svgIcon="mat:edit"></mat-icon>
                    <mat-icon (click)="deleteEditedBlock()" class="cursor-pointer" svgIcon="mat:delete"></mat-icon>
                </div>
                </div>
                <div style="width:100%; margin-top:5%;float:left">
                <div style="width: 100%;">
                    <p style="float: left;width: 80%;text-align: left;"><b>{{blockDetail.date_format}}</b></p>
                </div>
                </div>
                <div style="width:100%; margin-top:5%;float:left">
                <div style="width: 100%;">
                    <p style="float: left;width: 80%;text-align: left;"><b>{{'from' | translate}}</b></p>
                    <p style="float: left;width: 20%;text-align: right;"><b>{{'to' | translate}}</b></p>
                </div>
                <div style="width: 100%;">
                    <p style="float: left;width: 50%;text-align: left;"><b>{{blockDetail.hour_start}}</b></p>
                    <p style="float: left;width: 50%;text-align: right;"><b>{{blockDetail.hour_end}}</b></p>
                </div>
                </div>
                <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

                <div style="width:100%; margin-top:5%;float:left">
                <div style="width: 100%;">
                    <p style="float: left;width: 100%;text-align: left;"><b>
                        <ng-container *ngIf="blockDetail.type=='block_personal'">{{'no_working_day' | translate}}</ng-container>
                        <ng-container *ngIf="blockDetail.type=='block_payed'">{{'paid_block' | translate}}</ng-container>
                        <ng-container *ngIf="blockDetail.type=='block_no_payed'">{{'no_paid_block' | translate}}</ng-container>
                    </b></p>
                </div>
                <div style="width: 100%;">
                    <p style="float: left;width: 50%;text-align: left;">{{blockDetail.name}}</p>
                </div>
                </div>
                <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

                <ng-container *ngIf="showEditBlock">
                    <div style="width: 100%;float:left;margin-top:16px;margin-bottom:12px;">
                        <mat-card-title class="font-bold" style="float: left;width: 100%;">{{'edit_block' | translate }}</mat-card-title>
                    </div>

                    <mat-checkbox [(ngModel)]="allHoursDay">{{'full_day' | translate }}</mat-checkbox>

                    <ng-container *ngIf="!allHoursDay">
                        <mat-form-field class="flex-auto" style="width: 100%;">
                            <mat-select placeholder="{{'start_hour' | translate}}" [(ngModel)]="startTimeDay" (change)="onStartTimeDayChange()">
                            <ng-container *ngFor="let hour of hoursRangeMinutes">
                                <mat-option [value]="hour">
                                    {{hour}}
                                </mat-option>
                            </ng-container>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field class="flex-auto" style="width: 100%;">
                            <mat-select placeholder="{{'end_hour' | translate}}" [(ngModel)]="endTimeDay">
                            <ng-container *ngFor="let hour of filteredEndHoursDay">
                                <mat-option [value]="hour">
                                    {{hour}}
                                </mat-option>
                            </ng-container>
                            </mat-select>
                        </mat-form-field>
                    </ng-container>

                    <mat-form-field class="flex-auto" style="width: 100%;">
                        <input matInput placeholder="{{'title' | translate}}" [(ngModel)]="nameBlockDay">
                    </mat-form-field>

                    <mat-checkbox [(ngModel)]="divideDay">{{'split' | translate}}</mat-checkbox>

                    <ng-container *ngIf="divideDay">
                        <mat-form-field class="flex-auto" style="width: 100%;">
                            <mat-select placeholder="{{'start_split' | translate}}" [(ngModel)]="startTimeDivision" (change)="onStartTimeDivisionChange()">
                            <ng-container *ngFor="let hour of filteredStartHoursDivision">
                                <mat-option [value]="hour">
                                    {{hour}}
                                </mat-option>
                            </ng-container>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field class="flex-auto" style="width: 100%;">
                            <mat-select placeholder="{{'end_splite' | translate}}" [(ngModel)]="endTimeDivision">
                            <ng-container *ngFor="let hour of filteredEndHoursDivision">
                                <mat-option [value]="hour">
                                    {{hour}}
                                </mat-option>
                            </ng-container>
                            </mat-select>
                        </mat-form-field>
                    </ng-container>

                    <div class="actions flex items-center justify-end gap-2">
                        <button (click)="hideEditBlock()" mat-button type="button">{{'cancel' | translate}}</button>
                        <button (click)="saveEditedBlock()" [disabled]="!isButtonDayEnabled()" color="primary" mat-raised-button matStepperNext>
                          {{'save' | translate}}
                        </button>
                    </div>

                </ng-container>

            </mat-card-header>
            <mat-card-content>

                <div style="width: 100%;float:left;margin-bottom:12px;">
                    <mat-card-title class="font-bold" style="float: left;width: 80%;">{{'monitor' |translate}}</mat-card-title>
                </div>

                <div *ngIf="blockDetail.monitor" class="box-detail-user-block">
                    <div class="box-detail-user-block-img">
                        <img [src]="blockDetail.monitor.image ? blockDetail.monitor.image : 'assets/img/avatar.png'" />
                    </div>
                    <div class="box-detail-user-block-text">
                        <div>{{ blockDetail.monitor.first_name }} {{ blockDetail.monitor.last_name }}</div>
                        <span>
                            <ng-container *ngIf="blockDetail.monitor.language1_id">
                                {{getLanguageById(blockDetail.monitor.language1_id)}} ·
                            </ng-container>
                            {{getCountryById(blockDetail.monitor.country)}} · {{getBirthYears(blockDetail.monitor.birth_date)}} &ensp;{{'years' | translate}}
                            · {{blockDetail.monitor.phone}} · {{blockDetail.monitor.email}}
                        </span>
                    </div>
                </div>

            </mat-card-content>
            </mat-card>
        </vex-page-layout-content>


    </vex-page-layout-content>

  </vex-page-layout>
