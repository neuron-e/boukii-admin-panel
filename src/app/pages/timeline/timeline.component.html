<vex-page-layout>

    <vex-secondary-toolbar>
      <vex-breadcrumbs [crumbs]="['Timeline', 'List']" class="flex-auto"></vex-breadcrumbs>
  
      <button class="ml-2" color="primary" mat-icon-button type="button">
        <mat-icon svgIcon="mat:more_vert"></mat-icon>
      </button>
    </vex-secondary-toolbar>
    <vex-page-layout-content class="-mt-6 fullwidth">

        <div class="full-page-timeline" [ngClass]="{'timeline-with-detail': showDetail || showBlock}">
            <div class="header-navigation">
                <div class="date-navigation">
                <span *ngIf="timelineView == 'day'">{{ currentDate | date: 'longDate' }}</span>
                <span *ngIf="timelineView == 'week'">{{ currentWeek }}</span>
                <span *ngIf="timelineView == 'month'">{{ currentMonth }}</span>
                <button (click)="goToPrevious()">&lt;</button>
                <button (click)="goToNext()">&gt;</button>
                </div>
                
                <div class="view-selection">
                    <span class="view-option" [ngClass]="{'selected': timelineView == 'day'}" (click)="changeView('day')">Jour</span>
                    <span class="view-option" [ngClass]="{'selected': timelineView == 'week'}" (click)="changeView('week')">Semaine</span>
                    <span class="view-option" [ngClass]="{'selected': timelineView == 'month'}" (click)="changeView('month')">Mois</span>
                </div>
            </div>
            
            <div>

                <div class="schedule-container" *ngIf="allMonitors && allMonitors.length && timelineView != 'month'">
                    <div class="monitors-column">
                        <ng-container *ngFor="let monitor of allMonitors">
                            <div class="monitor">
                                <ng-container *ngIf="monitor.id">
                                    <div class="monitor-left">
                                        <div class="monitor-img-wrapper">
                                            <img [src]="monitor.image ? monitor.image : 'assets/img/avatar.png'" />
                                        </div>
                                        <div class="monitor-text">
                                            <div class="monitor-lang">
                                                FR · EN · ES
                                            </div>
                                            <div class="monitor-title">
                                                {{ monitor.first_name }} {{ monitor.last_name }}
                                            </div>
                                            <div class="monitor-icons">
                                                <img src="assets/img/icons/icon-message-grey.png" />
                                                <img src="assets/img/icons/icon-mail-grey.png" />
                                                <img src="assets/img/icons/icon-phone-grey.png" />
                                                <img src="assets/img/icons/icon-calendar-grey.png" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="monitor-right">
                                        <div class="monitor-sport">
                                            <img src="assets/img/icons/icon-ski-box.png" />
                                            <div>Ski</div>
                                        </div>
                                        <div class="monitor-sport">
                                            <img src="assets/img/icons/icon-ski-box.png" />
                                            <div>Snow</div>
                                        </div>
                                    </div>
                                </ng-container>
                                <ng-container *ngIf="!monitor.id">
                                    <div class="monitor-left">
                                        <div class="monitor-img-wrapper"></div>
                                        <div class="monitor-text">
                                            <div class="monitor-title">
                                                Aucun moniteur assigné
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </div>
                        </ng-container>
                    </div>
                    <div class="hours-container">
                    <div class="hours-row" *ngIf="timelineView == 'day'">
                        <div class="hour" *ngFor="let hour of hoursRange">{{ hour }}</div>
                    </div>
                    <div class="hours-row" *ngIf="timelineView == 'week'">
                        <div class="day" *ngFor="let day of weekDays">{{ day }}</div>
                    </div>
                    <div class="grid-container">
                        <div class="grid-row" *ngFor="let monitor of allMonitors;let monitorIndex = index"  [ngClass]="{'outside-month-day': !isDayVisibleDay() && timelineView == 'day', 'select-row': moveTask && monitor.id !== taskMoved.monitor_id}" (click)="moveMonitor(monitor.id,$event)">
                            <ng-container *ngIf="timelineView == 'day'">
                                <div class="grid-cell" *ngFor="let hour of hoursRange" (dblclick)="handleDbClickEvent('Clicked', $event)">
                                    <div *ngIf="monitorIndex % 5 === 0  && monitorIndex !== 0" class="hour-day-scroll">{{ hour }}</div>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="timelineView == 'week'">
                                <div class="grid-cell-day" *ngFor="let day of weekDays;let dayIndex = index" [ngClass]="{'outside-month': !isDayVisibleWeek(dayIndex)}">
                                    <div class="grid-cell-inside" *ngFor="let hour of hoursRange"></div>
                                    <div *ngIf="monitorIndex % 5 === 0  && monitorIndex !== 0" class="hour-day-scroll">{{ day }}</div>
                                </div>
                            </ng-container>
                        </div>

                        <!--TASKS-->
                        <ng-container *ngFor="let task of plannerTasks">
                            <!--DAY-->
                            <div *ngIf="timelineView == 'day'" (click)="task.block_id ? toggleBlock(task) : toggleDetail(task)" (contextmenu)="toggleDetailMove(task, $event)" class="task-wrapper cursor-pointer" [ngClass]="[
                                (task.booking_id && (idDetail == task.booking_id || idGroupedTasks == task.booking_id)) ? 
                                (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') : 
                                '', 
                                task.class,
                                (task.block_id && idBlock == task.block_id) ? 'border-selected' : ''
                            ]" [ngStyle]="task.style">
                                <div class="task-text">
                                    <img *ngIf="(task.type=='collective' || task.type=='private') && task.sport" [src]="task.sport.icon_selected" />
                                    <div>{{ task.name }}</div>
                                </div>
                                <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks">
                                    <!-- PENDING LEVEL -->
                                    <ng-container *ngIf="!task.grouped_tasks || !(task.grouped_tasks.length > 1)">
                                        <div class="task-block-level" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                                        <div *ngIf="task.type=='collective'" class="task-block-people">{{task.clients_number}}/{{task.max_participants}}</div>
                                    </ng-container>
                                    <ng-container *ngIf="task.grouped_tasks && task.grouped_tasks.length > 1">
                                        <div class="task-block-grouped">+ {{task.grouped_tasks.length}}</div>
                                    </ng-container>
                                </div>
                            </div>
                            <!--WEEK-->
                            <div *ngIf="timelineView == 'week'" (click)="task.block_id ? toggleBlock(task) : toggleDetail(task)" class="task-wrapper-week cursor-pointer" [ngClass]="[
                                (task.booking_id && (idDetail == task.booking_id || idGroupedTasks == task.booking_id)) ? 
                                (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') : 
                                '', 
                                task.class,
                                (task.block_id && idBlock == task.block_id) ? 'border-selected' : ''
                            ]" [ngStyle]="task.styleWeek">
                                <img class="sport-img-week" *ngIf="(task.type=='collective' || task.type=='private') && task.sport" [src]="task.sport.icon_selected" />
                                <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks-week">
                                    <!-- PENDING LEVEL -->
                                    <ng-container *ngIf="!task.grouped_tasks || !(task.grouped_tasks.length > 1)">
                                        <div class="task-block-level-week" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                                        <div *ngIf="task.type=='collective'" class="task-block-people-week">{{task.clients_number}}/{{task.max_participants}}</div>
                                    </ng-container>
                                    <ng-container *ngIf="task.grouped_tasks && task.grouped_tasks.length > 1">
                                        <div class="task-block-grouped-week">+ {{task.grouped_tasks.length}}</div>
                                    </ng-container>
                                </div>
                            </div>
                        </ng-container>

                    </div>
                    </div>
                </div>


                <div class="schedule-container" *ngIf="allMonitors && allMonitors.length && timelineView == 'month'">
                    <div class="monitors-column">
                    <ng-container *ngFor="let monitor of allMonitors; let monitorIndex = index">
                        <ng-container *ngFor="let week of weeksInMonth; let weekIndex = index">
                            <div class="monitor" [ngClass]="{'big-border': weekIndex === 0 && monitorIndex !== 0}">
                                <ng-container *ngIf="weekIndex === 0">
                                    <ng-container *ngIf="monitor.id">
                                        <div class="monitor-left">
                                            <div class="monitor-img-wrapper">
                                                <img [src]="monitor.image ? monitor.image : 'assets/img/avatar.png'" />
                                            </div>
                                            <div class="monitor-text">
                                                <div class="monitor-lang">
                                                    FR · EN · ES
                                                </div>
                                                <div class="monitor-title">
                                                    {{ monitor.first_name }} {{ monitor.last_name }}
                                                </div>
                                                <div class="monitor-icons">
                                                    <img src="assets/img/icons/icon-message-grey.png" />
                                                    <img src="assets/img/icons/icon-mail-grey.png" />
                                                    <img src="assets/img/icons/icon-phone-grey.png" />
                                                    <img src="assets/img/icons/icon-calendar-grey.png" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="monitor-right">
                                            <div class="monitor-sport">
                                                <img src="assets/img/icons/icon-ski-box.png" />
                                                <div>Ski</div>
                                            </div>
                                            <div class="monitor-sport">
                                                <img src="assets/img/icons/icon-ski-box.png" />
                                                <div>Snow</div>
                                            </div>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="!monitor.id">
                                        <div class="monitor-left">
                                            <div class="monitor-img-wrapper"></div>
                                            <div class="monitor-text">
                                                <div class="monitor-title">
                                                    Aucun moniteur assigné
                                                </div>
                                            </div>
                                        </div>
                                    </ng-container>
                                </ng-container>

                                <div class="day-start-week">
                                    {{ week.startDay }}
                                </div>
                                <div class="day-end-week">
                                    {{ week.endDay }}
                                </div>

                            </div>
                        </ng-container>
                    </ng-container>
                    </div>
                    <div class="hours-container">
                    <div class="hours-row">
                        <div class="day" *ngFor="let day of weekDays">{{ day }}</div>
                    </div>
                    <div class="grid-container">
                        <ng-container *ngFor="let monitor of allMonitors; let monitorIndex = index">
                            <div class="grid-row" *ngFor="let week of weeksInMonth;let weekIndex = index" [ngClass]="{'select-row': moveTask && monitor.id !== taskMoved.monitor_id}" (click)="moveMonitor(monitor.id,$event)">
                                <div class="grid-cell-day" *ngFor="let day of weekDays;let dayIndex = index" [ngClass]="{'outside-month': !isDayInMonth(dayIndex, weekIndex),'big-border': weekIndex === 0 && monitorIndex !== 0}">
                                    <div class="grid-cell-inside" *ngFor="let hour of hoursRange"></div>
                                    <div *ngIf="weekIndex === 0 && monitorIndex !== 0" class="hour-day-scroll">{{ day }}</div>
                                </div>
                            </div>
                        </ng-container>

                        <!--TASKS-->
                        <ng-container *ngFor="let task of plannerTasks">
                            <!--MONTH-->
                            <div class="task-wrapper-week cursor-pointer" (click)="task.block_id ? toggleBlock(task) : toggleDetail(task)" [ngClass]="[
                                (task.booking_id && (idDetail == task.booking_id || idGroupedTasks == task.booking_id)) ? 
                                (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') : 
                                '', 
                                task.class,
                                (task.block_id && idBlock == task.block_id) ? 'border-selected' : ''
                            ]" [ngStyle]="task.styleMonth">
                                <img class="sport-img-week" *ngIf="(task.type=='collective' || task.type=='private') && task.sport" [src]="task.sport.icon_selected" />
                                <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks-week">
                                    <!-- PENDING LEVEL -->
                                    <ng-container *ngIf="!task.grouped_tasks || !(task.grouped_tasks.length > 1)">
                                        <div class="task-block-level-week" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                                        <div *ngIf="task.type=='collective'" class="task-block-people-week">{{task.clients_number}}/{{task.max_participants}}</div>
                                    </ng-container>
                                    <ng-container *ngIf="task.grouped_tasks && task.grouped_tasks.length > 1">
                                        <div class="task-block-grouped-week">+ {{task.grouped_tasks.length}}</div>
                                    </ng-container>
                                </div>
                            </div>
                        </ng-container>

                    </div>
                    </div>
                </div>
                
            </div>

            <!--Modal Grouped Tasks-->
            <div *ngIf="showGrouped" class="modal-grouped">
                <div class="modal-grouped-close">
                    <mat-icon class="cursor-pointer" svgIcon="mat:close" (click)="hideGrouped()"></mat-icon>
                </div>
                <div *ngFor="let task of groupedTasks" (click)="toggleDetail(task)" class="modal-grouped-task-wrapper cursor-pointer" [ngClass]="[
                    (task.booking_id && (idDetail == task.booking_id)) ? 
                    (task.type === 'collective' ? 'task-selected-collective' : 'task-selected-private') : 
                    '', 
                    task.class
                ]">
                    <div class="task-text">
                        <img *ngIf="(task.type=='collective' || task.type=='private') && task.sport" [src]="task.sport.icon_selected" />
                        <div>{{ task.name }}</div>
                    </div>
                    <div *ngIf="task.type=='collective' || task.type=='private'" class="task-blocks">
                        <!-- PENDING LEVEL -->
                        <div class="task-block-level" *ngIf="task.degree" [ngStyle]="{'background': task.degree.color}">{{task.degree.annotation}} {{task.subgroup_number}}</div>
                        <div *ngIf="task.type=='collective'" class="task-block-people">{{task.clients_number}}/{{task.max_participants}}</div>
                    </div>
                </div>
            </div>


        </div>


        <vex-page-layout-content class="-mt-6 fullwidth box-detail-timeline" *ngIf="showDetail && taskDetail">
            <mat-card style="padding: 0 3%;">
            <mat-card-header style="display:block">
                <div style="width: 100%;float: left;">
                <mat-icon class="cursor-pointer" svgIcon="mat:close" (click)="hideDetail()"></mat-icon>

                </div>
                <div style="width: 100%;float:left;">
                <mat-card-title class="font-bold" style="float: left;width: 80%;">Detalles curso</mat-card-title>
                <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:edit"></mat-icon>
                </div>
                <div style="width:100%; margin-top:5%;float:left">
                <div style="width: 100%;">
                    <p style="float: left;width: 80%;text-align: left;"><b>Desde</b></p>
                    <p style="float: left;width: 20%;text-align: right;"><b>Hasta</b></p>
                </div>
                <div style="width: 100%;">
                    <p style="float: left;width: 50%;text-align: left;"><b>{{taskDetail.date_start}}</b></p>
                    <p style="float: left;width: 50%;text-align: right;"><b>{{taskDetail.date_end}}</b></p>
                </div>
                </div>
                <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

                <div style="width:100%; margin-top:5%;float:left">
                <div style="width: 100%;">
                    <p style="float: left;width: 35%;text-align: left;"><b>Precio</b></p>
                    <p style="float: left;width: 65%;text-align: right;"><b>Participantes Max</b></p>
                </div>
                <div style="width: 100%;">
                    <p style="float: left;width: 50%;text-align: left;"><b>{{taskDetail.course.price}}</b> {{taskDetail.course.currency}}</p>
                    <p style="float: left;width: 50%;text-align: right;"><b>{{taskDetail.course.max_participants}}</b></p>
                </div>
                </div>
                <ng-container *ngIf="taskDetail.type == 'collective'">
                    <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>
                    <div style="float: left; width: 100%;margin-top: 5%;">
                    <ul>
                        <ng-container *ngFor="let date of taskDetail.course.course_dates">
                            <li [ngClass]="{'font-bold': date.id == taskDetail.course_date_id}">{{getDateFormatLong(date.date)}} <i style="text-align: right;float:right">{{getHourRangeFormat(date.hour_start,date.hour_end)}}</i></li>
                        </ng-container>
                    </ul>
                    </div>
                </ng-container>
                <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

            </mat-card-header>
            <mat-card-content>
                <div style="float: left; width: 100%;margin-bottom:24px;">
                <div style="float: left;width: 100%;">
                    <!--ESTAS IMAGENES VENDRAN DEL TASKDETAIL.SPORT -> icon box -->
                    <div style="float: left; width: 20%; margin-top: 5%">
                        <img *ngIf="taskDetail.type == 'collective'" src="https://school.boukii.com/assets/icons/collectif_ski2x.png" width="100" height="100" />
                        <img *ngIf="taskDetail.type == 'private'" src="https://school.boukii.com/assets/icons/prive_ski2x.png" width="100" height="100" />
                    </div>
                    <div style="float: left; width: 75%;margin:6% 0 0 2%">
                    <p><strong>{{taskDetail.name}}</strong></p>
                    <p>
                        <ng-container *ngIf="taskDetail.type == 'collective'">
                            Collectif
                        </ng-container>
                        <ng-container *ngIf="taskDetail.type == 'private'">
                            Private
                        </ng-container>
                        <ng-container *ngIf="taskDetail.sport">
                            {{taskDetail.sport.name}}
                        </ng-container>
                    </p>
                    </div>
                </div>
                </div>

                <div *ngIf="taskDetail.type == 'collective'" class="box-detail-boxes">
                    <div class="box-detail-box" [ngStyle]="{'background': taskDetail.degree.color}">
                        <img src="https://school.boukii.com/assets/icons/award_icon.svg" style="width:24px;" />
                        <div class="font-bold font-white">{{taskDetail.degree.annotation}}</div>
                        <div class="font-bold font-white">{{taskDetail.degree.name}}</div>
                        <div class="font-bold font-white">{{taskDetail.subgroup_number}}</div>
                    </div>
                    <div class="box-detail-box box-background-grey">
                        <img src="https://school.boukii.com/assets/icons/icons-outline-profile-2-user-white.svg" style="width:24px;" />
                        <div>Grupos</div>
                        <div class="font-bold">{{taskDetail.total_subgroups}}</div>
                    </div>
                    <div class="box-detail-box box-background-grey">
                        <img src="https://school.boukii.com/assets/icons/icons-outline-clock.svg" style="width:24px;" />
                        <div>Duración</div>
                        <div class="font-bold">{{getHoursMinutes(taskDetail.hour_start,taskDetail.hour_end)}}</div>
                    </div>
                    <div class="box-detail-box box-background-grey">
                        <img src="https://school.boukii.com/assets/icons/icons-outline-calendar-tick.svg" style="width:24px;" />
                        <div>Días</div>
                        <div class="font-bold">{{taskDetail.date_index}}/{{taskDetail.course.course_dates.length}}</div>
                    </div>
                </div>

                <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

                <ng-container *ngIf="taskDetail.type == 'private'">

                    <div style="width: 100%;float:left;margin-bottom:12px;">
                        <mat-card-title class="font-bold" style="float: left;width: 80%;">Reserva</mat-card-title>
                        <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:edit"></mat-icon>
                    </div>

                    <div style="float: left; width: 100%;">
                        <ul>
                            <li class="font-bold">{{getDateFormatLong(taskDetail.date_full)}} <i style="text-align: right;float:right">{{getHourRangeFormat(taskDetail.hour_start,taskDetail.hour_end)}}</i></li>
                        </ul>
                    </div>

                    <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>
                    
                    <div style="width: 100%;float:left;margin-bottom:12px;">
                        <mat-card-title class="font-bold" style="float: left;width: 100%;">Utilizador</mat-card-title>
                    </div>

                    <div style="display:flex;width:100%;flex-direction:column;gap:8px;">
                        <div *ngFor="let client of taskDetail.all_clients" class="box-detail-user-block">
                            <app-level-user *ngIf="taskDetail.degrees_sport && taskDetail.degrees_sport.length" [allLevels]="taskDetail.degrees_sport" [selectLevel]="getClientDegree(taskDetail.sport_id,client.client.sports)" [size]="80" [userImage]="client.client.image ? client.client.image : 'assets/img/avatar.png'"></app-level-user>
                            <div class="box-detail-user-block-text">
                                <div>{{ client.client.first_name }} {{ client.client.last_name }}</div>
                                <span>
                                    <ng-container *ngIf="client.client.language1_id">
                                        {{getLanguageById(client.client.language1_id)}} ·
                                    </ng-container>
                                    <ng-container *ngIf="client.client.language2_id">
                                        {{getLanguageById(client.client.language2_id)}} ·
                                    </ng-container>
                                    <ng-container *ngIf="client.client.language3_id">
                                        {{getLanguageById(client.client.language3_id)}} ·
                                    </ng-container>
                                    {{getCountryById(client.client.country)}} · {{getBirthYears(client.client.birth_date)}} ans
                                    · {{client.client.phone}} · {{client.client.email}}
                                </span>
                                <div *ngIf="taskDetail.degree" class="box-detail-user-blocklevel" [ngStyle]="{'background': taskDetail.degree.color}">
                                    {{taskDetail.degree.name}}
                                </div>
                            </div>
                        </div>
                    </div>

                    <mat-divider style="float: left;width: 100%;margin: 5% 0 5% 0;"></mat-divider>

                </ng-container>

                <div style="width: 100%;float:left;margin-bottom:12px;">
                    <mat-card-title class="font-bold" style="float: left;width: 80%;">Monitor</mat-card-title>
                    <mat-icon (click)="openEditMonitor()" class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:edit"></mat-icon>
                </div>

                <div *ngIf="taskDetail.monitor" class="box-detail-user-block">
                    <div class="box-detail-user-block-img">
                        <img [src]="taskDetail.monitor.image ? taskDetail.monitor.image : 'assets/img/avatar.png'" />
                    </div>
                    <div class="box-detail-user-block-text">
                        <div>{{ taskDetail.monitor.first_name }} {{ taskDetail.monitor.last_name }}</div>
                        <span>
                            <ng-container *ngIf="taskDetail.monitor.language1_id">
                                {{getLanguageById(taskDetail.monitor.language1_id)}} ·
                            </ng-container>
                            {{getCountryById(taskDetail.monitor.country)}} · {{getBirthYears(taskDetail.monitor.birth_date)}} ans
                            · {{taskDetail.monitor.phone}} · {{taskDetail.monitor.email}}
                        </span>
                    </div>
                </div>
                <div *ngIf="!taskDetail.monitor">
                    Ningún monitor asignado
                </div>

                <ng-container *ngIf="showEditMonitor">
                    <div style="width: 100%;float:left;margin-top:16px;margin-bottom:12px;">
                        <mat-card-title class="font-bold" style="float: left;width: 100%;">Nuevo monitor</mat-card-title>
                    </div>

                    <mat-form-field class="flex-auto" style="width: 100%;">
                        <mat-select placeholder="Nuevo monitor" [(ngModel)]="editedMonitor">
                        <ng-container *ngFor="let monitor of allMonitors" >
                            <mat-option *ngIf="monitor.id != taskDetail.monitor_id" [value]="monitor">
                                {{ monitor.first_name }} {{ monitor.last_name }}
                            </mat-option>
                        </ng-container>
                        </mat-select>
                    </mat-form-field>

                    <div class="actions flex items-center justify-end gap-2">
                        <button (click)="hideEditMonitor()" mat-button type="button">Cancelar</button>
                        <button (click)="saveEditedMonitor()" [disabled]="!editedMonitor" color="primary" mat-raised-button matStepperNext>
                          Guardar
                        </button>
                      </div>
                </ng-container>

                <ng-container *ngIf="taskDetail.type == 'collective'">
                    <div style="width: 100%;float:left;margin-top:32px;margin-bottom:12px;">
                        <mat-card-title class="font-bold" style="float: left;width: 80%;">Alumnos {{taskDetail.clients_number}}/{{taskDetail.max_participants}}</mat-card-title>
                        <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:swap_horiz"></mat-icon>
                    </div>

                    <div style="display:flex;width:100%;flex-direction:column;gap:8px;">
                        <div *ngFor="let client of taskDetail.all_clients" class="box-detail-user-block">
                            <app-level-user *ngIf="taskDetail.degrees_sport && taskDetail.degrees_sport.length" [allLevels]="taskDetail.degrees_sport" [selectLevel]="getClientDegree(taskDetail.sport_id,client.client.sports)" [size]="60" [userImage]="client.client.image ? client.client.image : 'assets/img/avatar.png'"></app-level-user>
                            <div class="box-detail-user-block-text">
                                <div>{{ client.client.first_name }} {{ client.client.last_name }}</div>
                                <span>
                                    <ng-container *ngIf="client.client.language1_id">
                                        {{getLanguageById(client.client.language1_id)}} ·
                                    </ng-container>
                                    <ng-container *ngIf="client.client.language2_id">
                                        {{getLanguageById(client.client.language2_id)}} ·
                                    </ng-container>
                                    <ng-container *ngIf="client.client.language3_id">
                                        {{getLanguageById(client.client.language3_id)}} ·
                                    </ng-container>
                                    {{getCountryById(client.client.country)}} · {{getBirthYears(client.client.birth_date)}} ans
                                    · {{client.client.phone}} · {{client.client.email}}
                                </span>
                            </div>
                        </div>
                    </div>
                </ng-container>

            </mat-card-content>
            </mat-card>
        </vex-page-layout-content>


        <vex-page-layout-content class="-mt-6 fullwidth box-detail-timeline" *ngIf="showBlock && blockDetail">
            <mat-card style="padding: 0 3%;">
            <mat-card-header style="display:block">
                <div style="width: 100%;float: left;">
                <mat-icon class="cursor-pointer" svgIcon="mat:close" (click)="hideBlock()"></mat-icon>

                </div>
                <div style="width: 100%;float:left;">
                <mat-card-title class="font-bold" style="float: left;width: 80%;">Detalles bloqueo</mat-card-title>
                <mat-icon class="cursor-pointer" style="float: right;width: 10%;" svgIcon="mat:edit"></mat-icon>
                </div>
                <div style="width:100%; margin-top:5%;float:left">
                <div style="width: 100%;">
                    <p style="float: left;width: 80%;text-align: left;"><b>{{blockDetail.date_format}}</b></p>
                </div>
                </div>
                <div style="width:100%; margin-top:5%;float:left">
                <div style="width: 100%;">
                    <p style="float: left;width: 80%;text-align: left;"><b>Desde</b></p>
                    <p style="float: left;width: 20%;text-align: right;"><b>Hasta</b></p>
                </div>
                <div style="width: 100%;">
                    <p style="float: left;width: 50%;text-align: left;"><b>{{blockDetail.hour_start}}</b></p>
                    <p style="float: left;width: 50%;text-align: right;"><b>{{blockDetail.hour_end}}</b></p>
                </div>
                </div>
                <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

                <div style="width:100%; margin-top:5%;float:left">
                <div style="width: 100%;">
                    <p style="float: left;width: 100%;text-align: left;"><b>
                        <ng-container *ngIf="blockDetail.type=='block_personal'">No working day</ng-container>
                        <ng-container *ngIf="blockDetail.type=='block_payed'">Bloqueo pagado</ng-container>
                        <ng-container *ngIf="blockDetail.type=='block_no_payed'">Bloqueo no pagado</ng-container>
                    </b></p>
                </div>
                <div style="width: 100%;">
                    <p style="float: left;width: 50%;text-align: left;">{{blockDetail.name}}</p>
                </div>
                </div>
                <mat-divider style="float: left;width: 100%;margin: 2% 0 0 0;"></mat-divider>

            </mat-card-header>
            <mat-card-content>

                <div style="width: 100%;float:left;margin-bottom:12px;">
                    <mat-card-title class="font-bold" style="float: left;width: 80%;">Monitor</mat-card-title>
                </div>

                <div *ngIf="blockDetail.monitor" class="box-detail-user-block">
                    <div class="box-detail-user-block-img">
                        <img [src]="blockDetail.monitor.image ? blockDetail.monitor.image : 'assets/img/avatar.png'" />
                    </div>
                    <div class="box-detail-user-block-text">
                        <div>{{ blockDetail.monitor.first_name }} {{ blockDetail.monitor.last_name }}</div>
                        <span>
                            <ng-container *ngIf="blockDetail.monitor.language1_id">
                                {{getLanguageById(blockDetail.monitor.language1_id)}} ·
                            </ng-container>
                            {{getCountryById(blockDetail.monitor.country)}} · {{getBirthYears(blockDetail.monitor.birth_date)}} ans
                            · {{blockDetail.monitor.phone}} · {{blockDetail.monitor.email}}
                        </span>
                    </div>
                </div>

            </mat-card-content>
            </mat-card>
        </vex-page-layout-content>
          

    </vex-page-layout-content>
  
  </vex-page-layout>
  