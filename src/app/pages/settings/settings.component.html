<vex-page-layout mode="card">

  <vex-page-layout-header class="flex flex-col items-start justify-center" style="background-color: #ececec;">
    <div class="container" style="max-width: none;">
      <i class="fa fa-cog" style="float: left;font-size: 30px;margin: 0 10px 0 0;color: #f53d7c;"></i>
      <h2 class="title m-0" style="float: left;font-size: 30px;">Reglajes</h2>
    </div>
  </vex-page-layout-header>

  <vex-page-layout-content class="container" style="max-width: none !important;" *ngIf="!loading">
    <div class="card">
      <mat-tab-group>
        <mat-tab label="Temporada" [formGroup]="seasonForm">

          <vex-page-layout>
            <vex-page-layout-content class="-mt-6 fullwidth" style="margin: 1% 0 0 0">
              <h1 style="color:#808080;font-size:24px">Nueva Temporada</h1>
              <p style="padding: 1%; color:#808080">Gracias a las múltiples opciones configurables y otros servicios, tu escuela podrá aportar a sus clientes un gran valor añadido.</p>
              <div style="width: 100%; float: left;padding: 1%">
                <div style="padding: 1%;width: 100%;float: left;border: #e6e6e6 1px solid;">
                  <div style="float:left; width:30%">

                    <p style="font-weight: bold; color:#808080">Datos generales</p>
                  </div>
                  <div style="float:left; width:70%">
                    <button mat-raised-button color="accent" style="background: #E91E63;height: 30px;width: 15%;float: right;color: #fff;" (click)="saveSeason()">Save season</button>
                  </div>

                </div>
                <div style="width: 100%; float: left; border:#e6e6e6 1px solid;padding: 1%;">
                  <div class="flex flex-col sm:flex-row gap-2 sm:gap-6" >

                    <div class="flex-auto">
                      <label for="dateFrom">Inicio de temporada</label>
                      <mat-form-field style="width: 100%">

                        <input matInput id="dateFrom" [matDatepicker]="pickerFrom" formControlName="fromDate" [min]="today" [(ngModel)]="selectedFrom" [value]="selectedFrom | date: 'dd/MM/YYYY'">
                        <mat-datepicker-toggle matSuffix [for]="pickerFrom"></mat-datepicker-toggle>
                        <mat-datepicker #pickerFrom [startAt]="selectedFrom"></mat-datepicker>
                      </mat-form-field>
                    </div>
                    <div class="flex-auto">
                      <label for="dateTo">Fin de temporada</label>

                      <mat-form-field style="width: 100%">

                        <input matInput id="dateTo" [matDatepicker]="pickerTo" formControlName="toDate" [disabled]="selectedFrom === null" [min]="selectedFrom" [(ngModel)]="selectedTo" [value]="selectedTo | date: 'dd/MM/YYYY'">
                        <mat-datepicker-toggle matSuffix [for]="pickerTo"></mat-datepicker-toggle>
                        <mat-datepicker #pickerTo [startAt]="selectedTo"></mat-datepicker>
                      </mat-form-field>
                    </div>
                  </div>
                  <div class="flex flex-col sm:flex-row gap-2 sm:gap-6" >

                    <div class="flex-auto">
                      <label for="hour">Hora de inicio de cursos</label>
                      <mat-form-field style="width: 100%;">
                        <input id="hour" type="text" placeholder="Hora " matInput [matAutocomplete]="matHourFrom" formControlName="startHour">
                        <mat-autocomplete #matHourFrom="matAutocomplete">
                          <mat-option *ngFor="let hour of hours" [value]="hour" (onSelectionChange)="selectedFromHour = hour">
                            {{hour}}
                          </mat-option>
                        </mat-autocomplete>
                      </mat-form-field>
                    </div>

                    <div class="flex-auto">
                      <label for="endHour">Hora de fin de cursos</label>
                      <mat-form-field style="width: 100%;">
                        <input id="endHour" type="text" placeholder="Hora" matInput [matAutocomplete]="matHourTo" formControlName="endHour">
                        <mat-autocomplete #matHourTo="matAutocomplete">
                          <mat-option *ngFor="let hour of filteredHours" [value]="hour" (onSelectionChange)="selectedToHour = hour">
                            {{hour}}
                          </mat-option>
                        </mat-autocomplete>
                      </mat-form-field>
                    </div>
                  </div>

                  <div class="sm:flex-row gap-2 sm:gap-6">
                    <div *ngFor="let holiday of holidays; let i = index" style="width: 49%; float:left;" [ngClass]="{'margin-right': isEven(i)}">
                      <div style="width: 5%;float: left;margin: 4% 0 0 0;">
                        <mat-icon svgIcon="mat:delete" style="color:red;cursor:pointer" (click)="deleteHoliday(i)"></mat-icon>

                      </div>
                      <div style="width: 95%; float:left;">
                        <label for="holiday-{{i}}">Día festivo</label>

                        <mat-form-field style="width: 100%">
                          <input matInput [matDatepicker]="picker" [min]="today" id="holiday-{{i}}" (dateChange)="onDateSelect($event)"  [value]="holiday">
                          <mat-datepicker-toggle matSuffix [for]="picker" ></mat-datepicker-toggle>
                          <mat-datepicker #picker [startAt]="today"></mat-datepicker>
                        </mat-form-field>
                      </div>
                    </div>
                  </div>
                  <div style="width: 100%; margin: 2% 0 0 0; float:left;border: 1px solid #e6e6e6;padding: 1%;">
                    <div style="width: 5%; float:left;">

                      <button class="add-date" mat-fab (click)="addHoliday()">
                        <mat-icon svgIcon="mat:add" class="icon-date"></mat-icon>
                      </button>
                    </div>
                    <div style="width: 95%; float:left;margin: 1% 0 0 0;">
                      <p>Añadir día festivo</p>
                    </div>
                  </div>
                </div>
              </div>

              <div style="width: 100%; float: left;padding: 1%">
                <div style="padding: 1%;width: 100%;float: left;border: #e6e6e6 1px solid;">
                  <div style="float:left; width:30%">

                    <p style="font-weight: bold; color:#808080">Datos (Para emails)</p>
                  </div>
                  <div style="float:left; width:70%">
                    <button mat-raised-button color="accent" style="background: #E91E63;height: 30px;width: 15%;float: right;color: #fff;" (click)="saveContactData()">Save contact data</button>
                  </div>
                </div>
                <div style="width: 100%; float: left; border:#e6e6e6 1px solid;padding: 1%;">
                  <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
                    <mat-form-field class="flex-auto">
                      <mat-label>Calle</mat-label>

                      <input formControlName="contact_phone" matInput required type="text" [(ngModel)]="defaultsSchoolData.contact_address">
                    </mat-form-field>

                    <mat-form-field class="flex-auto">
                      <mat-label>Nº</mat-label>
                      <input formControlName="contact_address" matInput required type="text" [(ngModel)]="defaultsSchoolData.contact_address_number">

                    </mat-form-field>
                  </div>
                  <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
                    <mat-form-field class="flex-auto">
                      <mat-label>CP</mat-label>

                      <input formControlName="contact_address_number" matInput required type="text" [(ngModel)]="defaultsSchoolData.contact_cp">
                    </mat-form-field>

                    <mat-form-field class="flex-auto">
                      <mat-label>Teléfono</mat-label>
                      <input formControlName="contact_cp" matInput required type="tel" [(ngModel)]="defaultsSchoolData.contact_phone">

                    </mat-form-field>
                  </div>
                  <div class="flex flex-col sm:flex-row gap-2 sm:gap-6">
                    <mat-form-field class="vex-flex-form-field flex-auto">
                      <mat-label>Pays</mat-label>
                      <input type="text" placeholder="Selecciona una opción" matInput [formControl]="myControlCountries" [matAutocomplete]="autoCountry" formControlName="contact_city" >
                      <mat-autocomplete #autoCountry="matAutocomplete" [displayWith]="displayFnCountry">
                        <mat-option *ngFor="let country of filteredCountries | async" [value]="country" (onSelectionChange)="defaultsSchoolData.contact_city = country.id">
                          {{country.name}}
                        </mat-option>
                      </mat-autocomplete>
                    </mat-form-field>

                    <mat-form-field class="vex-flex-form-field flex-auto">
                      <mat-label>Canton</mat-label>
                      <input type="text" placeholder="Selecciona una opción" matInput [formControl]="myControlProvinces" [matAutocomplete]="autoProvince" formControlName="contact_province" >
                      <mat-autocomplete #autoProvince="matAutocomplete" [displayWith]="displayFnProvince">
                        <mat-option *ngFor="let province of filteredProvinces | async" [value]="province" (onSelectionChange)="defaultsSchoolData.contact_province = province.id">
                          {{province.name}}
                        </mat-option>
                      </mat-autocomplete>
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </vex-page-layout-content>
          </vex-page-layout>
        </mat-tab>
        <mat-tab label="Sports">
          <mat-tab-group>
            <mat-tab label="Deportes Activos">
              <vex-page-layout>
                <vex-page-layout-content class="-mt-6 fullwidth" style="margin: 1% 0 0 0">
                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Deportes activos</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Selecciona los deportes de tu escuela.<br>
                      No es necesario que los selecciones todos ahora, podrás hacerlo mas adelante según las necesidades
                    </p>
                    <button mat-raised-button color="accent" style="color: #fff;background: #f53d7c;padding: 1%;width: 15%;" (click)="saveSchoolSports()">Guardar Cambios</button>

                  </div>
                  <div style="float: left; width: 100%;padding: 0 5% 5% 3%;">
                    <p style="padding: 2%;font-size: 30px;font-weight: bold;color: #808080;">Invierno</p>
                    <ng-container *ngFor="let item of sports">
                      <div style="float: left; width: 5%; margin: 0 0 1% 6%;cursor:pointer"*ngIf="item.sport_type === 1" (click)="setSport(item.id)">

                        <div style="float: left; width: 100%; border-radius: 10px;"
                        [ngClass]="{'unselected-icon': sportsList.indexOf(item.id) === -1, 'selected-icon': sportsList.indexOf(item.id) !== -1}" *ngIf="item.sport_type === 1">
                          <div style="float: left; width: 100%;">
                            <img style="float: left; width: 100%;" [src]="sportsList.indexOf(item.id) !== -1 ? item.icon_selected : item.icon_unselected"/>
                          </div>
                        </div>

                        <div style="float: left; width: 100%; text-wrap: nowrap;" *ngIf="item.sport_type === 1">
                          <p style="float: left; width: 100%;text-align: center;">{{ item.name }}</p>
                        </div>
                      </div>
                    </ng-container>
                  </div>

                  <div style="float: left; width: 100%;padding: 0 5% 5% 3%;">
                    <p style="padding: 2%;font-size: 30px;font-weight: bold;color: #808080;">Verano</p>
                    <ng-container *ngFor="let item of sports">
                      <div style="float: left; width: 5%; margin: 0 0 1% 6%;cursor:pointer" *ngIf="item.sport_type === 2" (click)="setSport(item.id)">

                        <div style="float: left; width: 100%;  border-radius: 10px;" *ngIf="item.sport_type === 2"
                        [ngClass]="{'unselected-icon': sportsList.indexOf(item.id) === -1, 'selected-icon': sportsList.indexOf(item.id) !== -1}">
                          <div style="float: left; width: 100%;">
                            <img style="float: left; width: 100%;" [src]="sportsList.indexOf(item.id) !== -1 ? item.icon_selected : item.icon_unselected"/>
                          </div>
                        </div>

                        <div style="float: left; width: 100%; text-wrap: nowrap;" *ngIf="item.sport_type === 2">
                          <p style="float: left; width: 100%;text-align: center;">{{ item.name }}</p>
                        </div>
                      </div>
                    </ng-container>
                  </div>

                  <div style="float: left; width: 100%;padding: 0 5% 5% 3%;">

                    <p style="padding: 2%;font-size: 30px;font-weight: bold;color: #808080;">All sessions</p>
                    <ng-container *ngFor="let item of sports">
                      <div style="float: left; width: 5%; margin: 0 0 1% 6%;cursor:pointer" (click)="setSport(item.id)">

                        <div style="float: left; width: 100%; border-radius: 10px;" [ngClass]="{'unselected-icon': sportsList.indexOf(item.id) === -1, 'selected-icon': sportsList.indexOf(item.id) !== -1}">
                          <div style="float: left; width: 100%;">
                            <img style="float: left; width: 100%;" [src]="sportsList.indexOf(item.id) !== -1 ? item.icon_selected : item.icon_unselected"/>
                          </div>
                        </div>

                        <div style="float: left; width: 100%; text-wrap: nowrap;">
                          <p style="float: left; width: 100%;text-align: center;">{{ item.name }}</p>
                        </div>
                      </div>
                    </ng-container>
                  </div>

                </vex-page-layout-content>
              </vex-page-layout>
            </mat-tab>
            <mat-tab label="Niveles">
              <vex-page-layout>
                <vex-page-layout-content class="-mt-6 fullwidth" style="margin: 1% 0 0 0">
                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Niveles</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Configura los niveles como mejor se adapten a tu escuela.<br>
                      Los colores son fijos, no se pueden modificar.<br>
                      Recuerda que los hemos clasificado de menor a mayor, siendo el verde el nivel más bajo.
                    </p>
                    <button mat-raised-button color="accent" style="color: #fff;background: #f53d7c;padding: 1%;width: 15%;" (click)="updateSportDegrees()">Guardar Cambios</button>

                  </div>

                  <div style="float: left; width: 100%;padding: 0 5% 5% 3%;">
                    <ng-container *ngFor="let item of schoolSports; let i = index">
                      <div
                      style="float: left; width: 5%;margin-left: 6%">
                      <!-- Contenido del div (aplicar estilos selected)-->
                        <div style="float: left; width: 100%; border-radius: 10px;" (click)="selectSport(item.id)"
                          [ngStyle]="{
                            'background': selectedSport === item.id ? '#e91e63' : '#e6e6e6'
                          }">
                          <div style="float: left; width: 100%;cursor:pointer" (click)="dataSourceLevels.data = item.degrees">
                            <img style="float: left; width: 100%;" [src]="item.icon_selected"/>
                          </div>
                        </div>

                        <div style="float: left; width: 100%; text-wrap: nowrap;">
                          <p style="float: left; width: 100%;text-align: center;">{{ item.name }}</p>
                        </div>
                      </div>
                    </ng-container>
                  </div>

                  <div style="float: left; width: 100%;padding: 0 5% 5% 3%;">
                    <!-- añadir mat table de niveles-->
                    <table #reductionTable id="table-level" mat-table [dataSource]="dataSourceLevels" matSort style="border: 1px solid #e6e6e6">

                      <ng-container matColumnDef="ageMin">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Edad Desde</th>
                        <td mat-cell *matCellDef="let element">
                          <mat-form-field class="flex-auto">
                            <input matInput placeholder="Acronym" type="number" [value]="element.age_min" [(ngModel)]="element.age_min">
                          </mat-form-field>
                        </td>                      </ng-container>

                      <ng-container matColumnDef="ageMax">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Edad Hasta</th>
                        <td mat-cell *matCellDef="let element">
                          <mat-form-field class="flex-auto">
                            <input matInput placeholder="Acronym" type="number" [value]="element.age_max" [(ngModel)]="element.age_max">
                          </mat-form-field>
                        </td>
                      </ng-container>

                      <ng-container matColumnDef="annotation">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Acrónimo </th>
                        <td mat-cell *matCellDef="let element">

                          <mat-form-field class="flex-auto">
                            <input matInput placeholder="Acronym" type="text" [value]="element.annotation" [(ngModel)]="element.annotation">
                          </mat-form-field>

                        </td>
                      </ng-container>

                      <ng-container matColumnDef="name">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Nombre </th>
                        <td mat-cell *matCellDef="let element">
                          <mat-form-field class="flex-auto">
                            <input matInput placeholder="Name" type="text" [value]="element.name" [(ngModel)]="element.name">
                          </mat-form-field>
                        </td>
                      </ng-container>

                      <ng-container matColumnDef="status">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Estado </th>
                        <td mat-cell *matCellDef="let element">
                          <mat-slide-toggle [checked]="element.active" [(ngModel)]="element.active"></mat-slide-toggle>
                        </td>
                      </ng-container>

                      <ng-container matColumnDef="color">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Color </th>
                        <td mat-cell *matCellDef="let element">
                          <div style="width: 50%;float: left;height: 35px;border-radius: 5px;" [style.background-color]="element.color">

                          </div>
                        </td>
                      </ng-container>

                      <ng-container matColumnDef="edit">
                        <th mat-header-cell *matHeaderCellDef>  </th>
                        <td mat-cell *matCellDef="let element; let idx = index">
                          <mat-icon svgIcon="mat:edit" (click)="editGoal(element, idx)"></mat-icon>
                        </td>
                      </ng-container>

                      <tr mat-header-row *matHeaderRowDef="displayedLevelsColumns"></tr>
                      <tr mat-row *matRowDef="let row; columns: displayedLevelsColumns;"></tr>
                    </table>
                  </div>
                </vex-page-layout-content>
              </vex-page-layout>
            </mat-tab>
          </mat-tab-group>

        </mat-tab>
        <mat-tab label="Cursos">
          <ng-template matStepLabel>Prices</ng-template>
          <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin:2%;">
            <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Tabla de precios</h1>
            <p style="padding: 1%; color:#808080;float: left; width: 75%;">
              Configura los precios como mejor se adapten a tu escuela.<br>
            </p>
            <button mat-raised-button color="accent" style="color: #fff;background: #f53d7c;padding: 1%;width: 15%;" (click)="savePrices()">Guardar Cambios</button>

          </div>
          <div class="p-6">

            <mat-form-field class="flex-auto">
              <input matInput placeholder="Enter people number" type="number" [value]="people" [(ngModel)]="people" (ngModelChange)="updateTable()">
            </mat-form-field>

            <div class="table-container" >
              <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" #scrollContainer>
                <caption>Price in CFH</caption>

                <!-- Intervalo Column -->
                <ng-container matColumnDef="intervalo">
                  <th mat-header-cell *matHeaderCellDef> Intervalo </th>
                  <td mat-cell *matCellDef="let row"> {{row.intervalo}} </td>
                </ng-container>

                <!-- Personas Columns -->
                <ng-container *ngFor="let col of displayedColumns.slice(1)" [matColumnDef]="col">
                  <th mat-header-cell *matHeaderCellDef> {{col}} </th>
                  <td mat-cell *matCellDef="let row">
                    <mat-form-field class="flex-auto">
                      <input class="flex-auto" matInput [(ngModel)]="row[col]" style="margin-top:3%">
                    </mat-form-field>
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
              </table>
            </div>
          </div>
        </mat-tab>
        <mat-tab label="Página de Reservas">
          <vex-page-layout>
            <vex-page-layout-content class="-mt-6 fullwidth" style="margin: 1% 0 0 0">
              <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Página de reservas</h1>
                <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                  Gracias a las múltiples opciones configurables y a otros servicios, tu escuela podrá aportar a<br>
                  sus clientes un gran valor añadido.
                </p>
                <button mat-raised-button color="accent" style="color: #fff;background: #f53d7c;padding: 1%;width: 15%;" (click)="setTheme()">Guardar Cambios</button>

              </div>

              <div style="float: left; width: 100%;margin: 0 0 2% 0;">
                <div style="width:100%; float:left;">

                  <div style="padding: 1%;width: 100%;float: left;border: #e6e6e6 1px solid;">
                    <div style="width: 100%; float: left; ">
                      <div class="flex flex-col sm:flex-row gap-2 sm:gap-6" >
                        <div class="flex-auto">
                          <mat-radio-group [(ngModel)]="theme">
                            <mat-radio-button class="radio" [value]="'light'">
                              Claro
                            </mat-radio-button>
                            <mat-radio-button class="radio" [value]="'dark'">
                              Oscuro
                            </mat-radio-button>
                          </mat-radio-group>
                        </div>
                      </div>
                    </div>
                    <div style="float:left; width:100%">
                      <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                        Este porcentaje se aplica al importe total de la reserva y no es reembolsable en ningún caso.<br>
                        Es opcional para el cliente.<br>
                        La activación lo hace visible a la finalización del proceso de reserva junto con los importes a pagar.
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </vex-page-layout-content>
          </vex-page-layout>
        </mat-tab>
        <mat-tab label="Profesores">

          <mat-tab-group>

            <mat-tab label="Salaries">
              <vex-page-layout>
                <vex-page-layout-content class="-mt-6 fullwidth" style="margin: 1% 0 0 0">
                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Salarios</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Esta funcionalidad permite configurar los salarios de los empleados / profesores de tu escuela.<br>
                      Puedes crear tantos salarios como necesites. Luego, deberás asignarlos a cada profesor.<br>
                    </p>

                  </div>

                    <vex-aio-table [columns]="columns" [entity]="entitySalary" [title]="'Salaires'" [route]="'settings'" [createComponent]="createComponent" [createOnModal]="true" [heigthModal]="'35vh'"></vex-aio-table>
                </vex-page-layout-content>
              </vex-page-layout>
            </mat-tab>
            <mat-tab label="Bloqueos pagados">
              <vex-page-layout>
                <vex-page-layout-content class="-mt-6 fullwidth" style="margin: 1% 0 0 0">

                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Bloqueos</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Esta funcionalidad permite configurar los bloqueaos de los empleados / profesores de tu escuela.<br>
                      Puedes crear tantos bloqueaos como necesites. Luego, deberás asignarlos a cada profesor.<br>
                    </p>
                    <button mat-raised-button color="accent" style="color: #fff;background: #f53d7c;padding: 1%;width: 15%;" (click)="saveBlockages()">Guardar Cambios</button>

                  </div>

                  <div class="p-6">
                    <mat-form-field class="flex-auto" *ngFor="let item of blockages" style="width: 30%; margin: 0 2% 0 0">
                      <span matPrefix class="square-prefix" [ngStyle]="{'background-color': item.color}"></span>
                      <input matInput placeholder="Enter text" [value]="item.name" [(ngModel)]="item.name">
                    </mat-form-field>
                  </div>

                  <!--
                  <div class="p-6">
                    <div style="width: 100%; margin: 2% 0 0 0; float:left;border: 1px solid #e6e6e6;padding: 1%;">
                      <div style="width: 5%; float:left;">

                        <button class="add-date" mat-fab (click)="addBlockage()">
                          <mat-icon svgIcon="mat:add" class="icon-date"></mat-icon>
                        </button>
                      </div>
                      <div style="width: 95%; float:left;margin: 1% 0 0 0;">
                        <p>Añadir bloqueo</p>
                      </div>
                    </div>
                  </div>-->
                </vex-page-layout-content>
              </vex-page-layout>
            </mat-tab>
            <mat-tab label="Autorizaciones">
              <vex-page-layout>
                <vex-page-layout-content class="-mt-6 fullwidth" style="margin: 1% 0 0 0">
                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Niveles</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Configura las autorizaciones para los monitores de la escuela.
                    </p>
                    <button mat-raised-button color="accent" style="color: #fff;background: #f53d7c;padding: 1%;width: 15%;" (click)="saveMonitorsAuth()">Guardar Cambios</button>

                  </div>
                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Mensajes a clientes desde la app</h1>
                    <div style="width:100%; float:left;">
                      <p style="width:100%; float:left;">Por defecto</p>
                      <div>
                        <mat-checkbox [(ngModel)]="authorized" (change)="onAuthorizedChange(true)">Autorizado</mat-checkbox>
                        <mat-checkbox [(ngModel)]="!authorized" (change)="onAuthorizedChange(false)">No autorizado</mat-checkbox>
                      </div>
                    </div>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Este parámetro permite por defecto que los profesores se comuniquen con sus alumnos<br>
                      mediante el sistema de mensajería de la app Boukii Teach.<br><br>
                      Con cualquiera de las dos opciones podrás activarlo individualmente desde la ficha del profesor.
                    </p>

                  </div>
                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Reservas desde la app Boukii Teach</h1>
                    <div style="width:100%; float:left;">
                      <p style="width:100%; float:left;">Por defecto</p>
                      <div>
                        <mat-checkbox [(ngModel)]="authorizedBookingComm" (change)="onAuthorizedBookingChange(true)">Autorizado</mat-checkbox>
                        <mat-checkbox [(ngModel)]="!authorizedBookingComm" (change)="onAuthorizedBookingChange(false)">No autorizado</mat-checkbox>
                      </div>
                    </div>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Este parámetro permite por defecto que los profesores se comuniquen con sus alumnos<br>
                      mediante el sistema de mensajería de la app Boukii Teach.<br><br>
                      Con cualquiera de las dos opciones podrás activarlo individualmente desde la ficha del profesor.
                    </p>

                  </div>
                </vex-page-layout-content>
              </vex-page-layout>
            </mat-tab>
          </mat-tab-group>
        </mat-tab>
        <mat-tab label="Reservas">
          <vex-page-layout>
            <vex-page-layout-content class="-mt-6 fullwidth" style="margin: 1% 0 0 0">
              <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Reservas</h1>
                <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                  Configura los diferentes suplementos para tus reservas.
                </p>
                <button mat-raised-button color="accent" style="color: #fff;background: #f53d7c;padding: 1%;width: 15%;" (click)="saveTaxes()">Guardar Cambios</button>

              </div>
              <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">
                  <mat-slide-toggle [(ngModel)]="hasCancellationInsurance"></mat-slide-toggle> Opción Reembolso</h1>
                <div style="width:100%; float:left;">
                  <p style="width:100%; float:left;color:#808080;">Porcentaje que retiene la escuela</p>
                  <mat-form-field class="flex-auto">
                    <input matInput placeholder="Percentaje" type="number" [value]="this.school.cancellation_insurance_percent * 100" (blur)="updateInsuranceValue($event)">

                  </mat-form-field>
                </div>
                <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                  Este porcentaje se aplica al importe total de la reserva y no es reembolsable en ningún caso.<br>
                  Es opcional para el cliente.<br>
                  La activación lo hace visible a la finalización del proceso de reserva junto con los importes a pagar.
                </p>

              </div>
              <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">
                  <mat-slide-toggle [(ngModel)]="hasBoukiiCare"></mat-slide-toggle> Boukii Care <span style="color: #e6e6e6">(Seguro adicional)</span></h1>
                <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                  Boukii Care es un seguro que ponemos a vuestra disposición para cubrir posibles<br>
                  eventualidades del cliente, desligando a la escuela de cualquier trámite burocrático.<br>
                  El importe será deducido de la factura final emitida desde la plataforma Boukii Pay.<br><br>
                  Puedes consultar las condiciones de utilización aqui: <a href="" style="text-decoration:none; color: #f53d7c;">Enlace</a>
                </p>
                <div style="width:100%; float:left;">
                  <p style="width:100%; float:left;color:#808080;">Precio fijo del seguro</p>
                  <mat-form-field class="flex-auto">
                    <input matInput placeholder="Percentaje" type="number" [value]="this.school.bookings_comission_boukii_pay"  (blur)="updateBoukiiCareValue($event)">

                  </mat-form-field>
                </div>
              </div>
              <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Anulaciones</h1>
                <div style="width:100%; float:left;">
                  <p style="width:100%; float:left;color:#808080;">Anulación posible con reembolso total (Sin "Opción reembolso")</p>
                  <mat-form-field class="flex-auto">
                    <mat-select>
                      <mat-option value="10">
                        78h antes del inicio del curso
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div style="width:100%; float:left;">
                  <p style="width:100%; float:left;color:#808080;">Anulación posible con reembolso total (Con "Opción reembolso")</p>
                  <mat-form-field class="flex-auto">
                    <mat-select>
                      <mat-option value="10">
                        24h antes del inicio del curso
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                  Estas limitaciones afectan únicamente a las reservas realizadas por el cliente desde.<br>
                  la página de reservas y la app. La escuela tiene libre control desde el panel de admin.<br>
                </p>
              </div>

              <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">
                  <mat-slide-toggle [(ngModel)]="hasTVA"></mat-slide-toggle>TVA</h1>
                <div style="width:100%; float:left;">
                  <p style="width:100%; float:left;color:#808080;">Porcentaje del impuesto</p>
                  <mat-form-field class="flex-auto">
                    <input matInput placeholder="TVA" type="number" [value]="this.school.bookings_comission_cash * 100" (blur)="updateTVAValue($event)">

                  </mat-form-field>
                </div>
                <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                  Se aplica al importe total de la reserva
                </p>

              </div>
            </vex-page-layout-content>
          </vex-page-layout>
        </mat-tab>

        <mat-tab label="Extras">
          <mat-tab-group>

            <mat-tab label="Alquiler" *ngIf="false">


              <vex-page-layout>
                <vex-page-layout-content class="-mt-6 fullwidth" style="margin: 1% 0 0 0">
                  <div style="float: left; width: 100%;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Extras / Opciones de curso</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Esta funcionalidad permite configurar los productos / servicios asociados a un curso.<br>
                      Al asociarlos tomarán como referencia tantas fechas como fechas tenga el curso.<br>
                      Ejemplo: <strong>5 días de curso colectivo</strong> (si activamos la opcion Material se relaizará un alquiler por los 5 días / fechas de ese curso)
                    </p>

                  </div>

                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Alquiler</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Crea los productos que estarán como opción para poderlos alquilar durante la reserva.<br>
                      Podrás crear un máximo de 5 items por deporte para sección.<br>
                    </p>

                  </div>

                  <div style="float: left; width: 100%;padding: 1%;margin: 0 0 2% 0;">
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Elije que deportes de tu escuela tienen opciones para alquilar
                    </p>
                    <div style="float: left;width: 100%;padding: 1%">
                      <p style="color:#808080;float: left; width: 100%;">
                        Deporte
                      </p>
                      <mat-checkbox [checked]="true">Ski</mat-checkbox>
                      <mat-checkbox>Snowboard</mat-checkbox>
                      <mat-checkbox>Randonée</mat-checkbox>
                    </div>
                    <div style="float: left;width: 100%;padding: 1%">
                      <div style="float: left; width: 10%;">
                        <div style="float: left; width: 100%;">
                          <img style="float: left; width: 40%;background: #e6e6e6; border-radius: 10px;border: solid 1px #808080" src="https://school.boukii.com/assets/apps/sports/Ski.png"/>
                        </div>
                      </div>
                      <div style="float: left;width: 90%;">

                        <table #extrasSportTable id="table-extras-sports" mat-table [dataSource]="dataSourceSport" matSort style="border: 1px solid #e6e6e6">

                          <ng-container matColumnDef="id">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Id </th>
                            <td mat-cell *matCellDef="let element"> 1 </td>
                          </ng-container>

                          <ng-container matColumnDef="sport">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Deporte </th>
                            <td mat-cell *matCellDef="let element"> Ski </td>
                          </ng-container>

                          <ng-container matColumnDef="name">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Nombre </th>
                            <td mat-cell *matCellDef="let element"> Botas de esqui </td>
                          </ng-container>

                          <ng-container matColumnDef="price">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Prix - CHF / Dia </th>
                            <td mat-cell *matCellDef="let element"> 30 chf/dia </td>
                          </ng-container>

                          <ng-container matColumnDef="tva">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> TVA </th>
                            <td mat-cell *matCellDef="let element">
                              0%
                            </td>
                          </ng-container>

                          <ng-container matColumnDef="status">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
                            <td mat-cell *matCellDef="let element">
                              <mat-slide-toggle [checked]="true"></mat-slide-toggle>

                            </td>
                          </ng-container>

                          <ng-container matColumnDef="edit">
                            <th mat-header-cell *matHeaderCellDef>  </th>
                            <td mat-cell *matCellDef="let element; let idx = index">
                              <mat-icon svgIcon="mat:edit" (click)="editGoal(element, idx)"></mat-icon>
                            </td>
                          </ng-container>

                          <ng-container matColumnDef="delete">
                            <th mat-header-cell *matHeaderCellDef>  </th>
                            <td mat-cell *matCellDef="let element; let idx = index">
                              <mat-icon svgIcon="mat:delete" (click)="editGoal(element, idx)"></mat-icon>
                            </td>
                          </ng-container>

                          <tr mat-header-row *matHeaderRowDef="displayedSportColumns"></tr>
                          <tr mat-row *matRowDef="let row; columns: displayedSportColumns;"></tr>
                        </table>
                        <div class="flex-auto" style="margin: 1% 0 0 0">
                          <button class="add-date" mat-fab >
                            <mat-icon svgIcon="mat:add" class="icon-date"></mat-icon>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </vex-page-layout-content>
              </vex-page-layout>
            </mat-tab>
            <mat-tab label="Otros">
              <vex-page-layout>
                <vex-page-layout-content class="-mt-6 fullwidth" style="margin: 1% 0 0 0">
                  <div style="float: left; width: 100%;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Extras / Opciones de curso</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Esta funcionalidad permite configurar los productos / servicios asociados a un curso.<br>
                      Al asociarlos tomarán como referencia tantas fechas como fechas tenga el curso.<br>
                      Ejemplo: <strong>5 días de curso colectivo</strong> (si activamos la opcion Material se relaizará un alquiler por los 5 días / fechas de ese curso)
                    </p>

                  </div>
                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 0 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Forfait</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Crea los productos que estarán como opción para poderlos alquilar durante la reserva.<br>
                      Podrás crear un máximo de 2 variables para sección.<br>
                    </p>

                  </div>

                  <table #forfaitTable id="table-extras-forfaits" mat-table [dataSource]="dataSourceForfait" matSort style="border: 1px solid #e6e6e6">

                    <ng-container matColumnDef="id">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Id </th>
                      <td mat-cell *matCellDef="let element"> {{ element.id }} </td>
                    </ng-container>

                    <ng-container matColumnDef="product">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Producto </th>
                      <td mat-cell *matCellDef="let element"> {{ element.product }} </td>
                    </ng-container>

                    <ng-container matColumnDef="name">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Nombre </th>
                      <td mat-cell *matCellDef="let element"> {{ element.name }} </td>
                    </ng-container>

                    <ng-container matColumnDef="price">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Prix - CHF / Dia </th>
                      <td mat-cell *matCellDef="let element"> {{ element.price }} chf/dia </td>
                    </ng-container>

                    <ng-container matColumnDef="tva">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> TVA </th>
                      <td mat-cell *matCellDef="let element">
                        {{ element.tva }}
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="status">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
                      <td mat-cell *matCellDef="let element">
                        <mat-slide-toggle [checked]="element.status" [disabled]="true"></mat-slide-toggle>

                      </td>
                    </ng-container>

                    <ng-container matColumnDef="edit">
                      <th mat-header-cell *matHeaderCellDef>  </th>
                      <td mat-cell *matCellDef="let element; let idx = index">
                      <mat-icon svgIcon="mat:edit" (click)="createExtra('Forfait', true, idx, element)"></mat-icon>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="delete">
                      <th mat-header-cell *matHeaderCellDef>  </th>
                      <td mat-cell *matCellDef="let element; let idx = index">
                        <mat-icon svgIcon="mat:delete" (click)="deleteExtra(idx, 'Forfait')"></mat-icon>
                      </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedExtrasColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedExtrasColumns;"></tr>
                  </table>
                  <div class="flex-auto" style="margin: 1% 0 0 0">
                    <button class="add-date" mat-fab (click)="createExtra('Forfait', false, null, null)" [disabled]="dataSourceForfait.data.length === 2">
                      <mat-icon svgIcon="mat:add" class="icon-date"></mat-icon>
                    </button>
                  </div>

                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 2% 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Transporte</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Crea los productos que estarán como opción para poderlos alquilar durante la reserva.<br>
                      Podrás crear un máximo de 2 variables para sección.<br>
                    </p>

                  </div>

                  <table #transportTable id="table-extras-transport" mat-table [dataSource]="dataSourceTransport" matSort style="border: 1px solid #e6e6e6">

                    <ng-container matColumnDef="id">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Id </th>
                      <td mat-cell *matCellDef="let element"> {{ element.id }} </td>
                    </ng-container>

                    <ng-container matColumnDef="product">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Producto </th>
                      <td mat-cell *matCellDef="let element"> {{ element.product }} </td>
                    </ng-container>

                    <ng-container matColumnDef="name">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Nombre </th>
                      <td mat-cell *matCellDef="let element"> {{ element.name }} </td>
                    </ng-container>

                    <ng-container matColumnDef="price">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Prix - CHF / Dia </th>
                      <td mat-cell *matCellDef="let element"> {{ element.price }} chf/dia </td>
                    </ng-container>

                    <ng-container matColumnDef="tva">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> TVA </th>
                      <td mat-cell *matCellDef="let element">
                        {{ element.tva }}
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="status">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
                      <td mat-cell *matCellDef="let element">
                        <mat-slide-toggle [checked]="element.status" [disabled]="true"></mat-slide-toggle>

                      </td>
                    </ng-container>

                    <ng-container matColumnDef="edit">
                      <th mat-header-cell *matHeaderCellDef>  </th>
                      <td mat-cell *matCellDef="let element; let idx = index">
                        <mat-icon svgIcon="mat:edit" (click)="createExtra('Transport', true, idx, element)"></mat-icon>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="delete">
                      <th mat-header-cell *matHeaderCellDef>  </th>
                      <td mat-cell *matCellDef="let element; let idx = index">
                        <mat-icon svgIcon="mat:delete" (click)="deleteExtra(idx, 'Transport')"></mat-icon>
                      </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedExtrasColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedExtrasColumns;"></tr>
                  </table>
                  <div class="flex-auto" style="margin: 1% 0 0 0">
                    <button class="add-date" mat-fab (click)="createExtra('Transport', false, null, null)" [disabled]="dataSourceTransport.data.length === 2">
                      <mat-icon svgIcon="mat:add" class="icon-date"></mat-icon>
                    </button>
                  </div>

                  <div style="float: left; width: 100%;border: 1px solid #e6e6e6;padding: 1%;margin: 2% 0 2% 0;">
                    <h1 style="color:#808080;font-size:24px;float: left; width: 100%;">Comida</h1>
                    <p style="padding: 1%; color:#808080;float: left; width: 75%;">
                      Crea los productos que estarán como opción para poderlos alquilar durante la reserva.<br>
                      Podrás crear un máximo de 2 variables para sección.<br>
                    </p>

                  </div>

                  <table #foodTable id="table-extras-food" mat-table [dataSource]="dataSourceFood" matSort style="border: 1px solid #e6e6e6">

                    <ng-container matColumnDef="id">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Id </th>
                      <td mat-cell *matCellDef="let element"> {{ element.id }} </td>
                    </ng-container>

                    <ng-container matColumnDef="product">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Producto </th>
                      <td mat-cell *matCellDef="let element"> {{ element.product }} </td>
                    </ng-container>

                    <ng-container matColumnDef="name">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Nombre </th>
                      <td mat-cell *matCellDef="let element"> {{ element.name }} </td>
                    </ng-container>

                    <ng-container matColumnDef="price">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Prix - CHF / Dia </th>
                      <td mat-cell *matCellDef="let element"> {{ element.price }} chf/dia </td>
                    </ng-container>

                    <ng-container matColumnDef="tva">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> TVA </th>
                      <td mat-cell *matCellDef="let element">
                        {{ element.tva }}
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="status">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
                      <td mat-cell *matCellDef="let element">
                        <mat-slide-toggle [checked]="element.status" [disabled]="true"></mat-slide-toggle>

                      </td>
                    </ng-container>

                    <ng-container matColumnDef="edit">
                      <th mat-header-cell *matHeaderCellDef>  </th>
                      <td mat-cell *matCellDef="let element; let idx = index">
                        <mat-icon svgIcon="mat:edit" (click)="createExtra('Food', true, idx, element)"></mat-icon>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="delete">
                      <th mat-header-cell *matHeaderCellDef>  </th>
                      <td mat-cell *matCellDef="let element; let idx = index">
                        <mat-icon svgIcon="mat:delete" (click)="deleteExtra(idx, 'Food')"></mat-icon>
                      </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedExtrasColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedExtrasColumns;"></tr>
                  </table>

                  <div class="flex-auto" style="margin: 1% 0 0 0">
                    <button class="add-date" mat-fab (click)="createExtra('Food', false, null, null)" [disabled]="dataSourceFood.data.length === 2">
                      <mat-icon svgIcon="mat:add" class="icon-date"></mat-icon>
                    </button>
                  </div>
                </vex-page-layout-content>
              </vex-page-layout>
            </mat-tab>
          </mat-tab-group>
        </mat-tab>
      </mat-tab-group>
    </div>
  </vex-page-layout-content>

</vex-page-layout>
