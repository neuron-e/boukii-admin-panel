<vex-secondary-toolbar current>
  <vex-breadcrumbs [crumbs]="[
    {icon:'cursos'},
    {text:'courses.title', title: true,  link: '/courses'},
    {text: (mode !== 'update' ? 'courses.new' : 'courses.update'), subtitle: true},
    ]" class="flex"></vex-breadcrumbs>
</vex-secondary-toolbar>

<vex-flux-toolbad [Modal]="ModalProgress" [Flux]="ModalFlux"
  (Check)="ModalFlux=$event;Confirm(0)"></vex-flux-toolbad>
<vex-flux-layout>
  <mat-spinner loading *ngIf="loading" style="margin:0 auto"></mat-spinner>
  <div body *ngIf="!loading">
    <div class="flex flex-col" style="padding: 20px 20px 0;"
      *ngIf="ModalFlux===0"
      [formGroup]="courseFormGroup">
      <mat-radio-group class="flex"
        style="flex-wrap: wrap;gap: 16px;justify-content: space-between;"
        formControlName="sport_id">
        <mat-radio-button
          class="sport_checkbox"
          *ngFor="let item of sportData"
          [value]="item.sport_id">
          <div style="display: flex;align-items: center;">
            <img [src]="item.icon_selected"
              *ngIf="courseFormGroup.controls['sport_id'].value===item.sport_id"
              class="sport_icon selected">
            <img [src]="item.icon_unselected"
              *ngIf="courseFormGroup.controls['sport_id'].value!==item.sport_id"
              class="sport_icon noselected">
            {{item.name}}
          </div>
        </mat-radio-button>
      </mat-radio-group>
    </div>
    <div class="flex flex-col"
      *ngIf="ModalFlux===1"
      [formGroup]="courseFormGroup">
      <mat-tab-group class="tabsWrapper"
        (selectedIndexChange)="courseFormGroup.patchValue({course_type:$event+1})"
        [selectedIndex]="courseFormGroup.controls['course_type'].value-1||0">
        <mat-tab>
          <ng-template mat-tab-label>
            <mat-icon style="color: #E5962A;"
              class="icon16">circle</mat-icon>
            Curso Colectivo
          </ng-template>
        </mat-tab>
        <mat-tab>
          <ng-template mat-tab-label>
            <mat-icon style="color: #2FAA41;"
              class="icon16">circle</mat-icon>
            Curso Privado
          </ng-template>
        </mat-tab>
        <mat-tab>
          <ng-template mat-tab-label>
            <mat-icon style="color: #0AB0BC;"
              class="icon16">circle</mat-icon>
            Actividad
          </ng-template>
        </mat-tab>
      </mat-tab-group>
      <div style="padding: 20px 20px 0;">
        <mat-checkbox> {{'Fechas flexibles' | translate }} </mat-checkbox>
        <vex-flux-upload-img
          (upload)="this.courseFormGroup.patchValue({img:$event})"
          style="margin-top: 10px;"></vex-flux-upload-img>
        <mat-form-field appearance="outline" style="width: 100%">
          <mat-label>{{'courses.coursename' | translate}}</mat-label>
          <input id="courseName" formControlName="course_name"
            matInput required type="text">
        </mat-form-field>
        <div style="margin: 10px 0;">
          <angular-editor id="summary" style="width: 100%"
            [placeholder]="'courses.summary' | translate"
            formControlName="summary" [config]="editor1Config">
          </angular-editor>
        </div>
        <div style="margin: 20px 0;">
          <angular-editor id="description" style="width: 100%"
            [placeholder]="'courses.desc' | translate"
            formControlName="description" [config]="editor2Config">
          </angular-editor>
        </div>
        <div style="display: flex; flex-wrap: wrap; column-gap: 20px;">
          <mat-form-field appearance="outline"
            style="width: calc(50% - 10px);">
            <mat-label>{{'Precio por fecha' | translate}}</mat-label>
            <input id="price" formControlName="price"
              matInput required type="number">
            <span matTextSuffix>CHF</span>
          </mat-form-field>
          <mat-form-field appearance="outline"
            style="width: calc(50% - 10px);">
            <mat-label>{{'N° max. participantes por grupo' |
              translate}}</mat-label>
            <input id="participants" formControlName="participants"
              matInput required type="number">
          </mat-form-field>
          <ng-container *ngIf="courseFormGroup.controls['course_type'].value>1">
            <mat-form-field appearance="outline"
              style="width: calc(50% - 10px);">
              <mat-label>{{'Edad mínima' | translate}}</mat-label>
              <input id="age_min" formControlName="age_min"
                matInput required type="number">
            </mat-form-field>
            <mat-form-field appearance="outline"
              style="width: calc(50% - 10px);">
              <mat-label>{{'Edad máxima' | translate}}</mat-label>
              <input id="age_max" formControlName="age_max"
                matInput required type="number">
            </mat-form-field>
          </ng-container>
        </div>
      </div>
    </div>
    <div class="flex flex-col" *ngIf="ModalFlux===2">
      <span style="margin: 20px;">
        {{'Fechas de reservas' | translate}}
      </span>
      <div [formGroup]="courseFormGroup"
        style="margin: 0 20px; display: flex; flex-wrap: nowrap; column-gap: 20px;">
        <mat-form-field
          appearance="outline">
          <mat-label>{{'Reservable desde' | translate}}</mat-label>
          <input
            matInput
            [matDatepicker]="date_reservable"
            [min]="minDate"
            [max]="maxDate"
            formControlName="reserve_from" />
          <mat-datepicker-toggle matSuffix
            [for]="date_reservable"></mat-datepicker-toggle>
          <mat-datepicker #date_reservable [startAt]="nowDate"></mat-datepicker>
        </mat-form-field>
        <mat-form-field
          appearance="outline">
          <mat-label>{{'Reservable hasta' |
            translate}}</mat-label>
          <input
            matInput
            [matDatepicker]="date_reservable_to"
            [min]="minDate"
            [max]="maxDate"
            formControlName="reserve_to" />
          <mat-datepicker-toggle
            matSuffix
            [for]="date_reservable_to"></mat-datepicker-toggle>
          <mat-datepicker #date_reservable_to
            [startAt]="nowDate"></mat-datepicker>
        </mat-form-field>
        <mat-form-field appearance="outline"
          *ngIf="courseFormGroup.controls['course_type'].value>1">
          <mat-label>{{'Duración mínima' | translate}}</mat-label>
          <input
            type="text"
            placeholder="{{'hour' | translate}}"
            aria-label="Number"
            matInput
            [matAutocomplete]="auto"
            formControlName="duration_min" />
          <mat-autocomplete #auto="matAutocomplete"
            [displayWith]="displayFn">
            <mat-option
              *ngFor="let hour of hours"
              [value]="hour">
              {{hour}}
            </mat-option>
          </mat-autocomplete>
          <mat-icon matSuffix svgIcon="mat:keyboard_arrow_down"></mat-icon>
        </mat-form-field>
      </div>
      <ng-container *ngIf="courseFormGroup.controls['course_type'].value===1">
        <div
          *ngFor="let item of courseFormGroup.controls['reserve_date'].value, index as i">
          <div
            style="width: 100%;background-color: #EFF2F5;height: 60px;border-top: 1px solid #C7D0D3;padding: 0 24px;align-content: space-evenly;">
            <span>
              {{'Fecha '+ (i+1)| translate}}
            </span>
            <mat-icon *ngIf="i!==0"
              (click)="courseFormGroup.controls['reserve_date'].value.splice(i,1)"
              style="cursor: pointer;float: inline-end;">delete</mat-icon>
          </div>
          <div
            style="margin: 20px 20px 0px; display: flex; flex-wrap: nowrap; column-gap: 20px;">
            <mat-form-field
              appearance="outline">
              <mat-label>{{'courses.date' | translate}}</mat-label>
              <input
                matInput
                [matDatepicker]="date_reservable"
                [min]="minDate"
                [max]="maxDate"
                [(ngModel)]="courseFormGroup.controls['reserve_date'].value[i].date" />
              <mat-datepicker-toggle
                matSuffix
                [for]="date_reservable"></mat-datepicker-toggle>
              <mat-datepicker
                #date_reservable
                [startAt]="minDate"></mat-datepicker>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>{{'hour' | translate}}</mat-label>
              <input
                type="text"
                placeholder="{{'hour' | translate}}"
                aria-label="Number"
                matInput
                [matAutocomplete]="auto"
                [(ngModel)]="courseFormGroup.controls['reserve_date'].value[i].hour_start" />
              <mat-autocomplete #auto="matAutocomplete"
                [displayWith]="displayFn">
                <mat-option
                  *ngFor="let hour of hours"
                  [value]="hour">
                  {{hour}}
                </mat-option>
              </mat-autocomplete>
              <mat-icon matSuffix svgIcon="mat:keyboard_arrow_down"></mat-icon>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>{{'Duración' | translate}}</mat-label>
              <input
                type="text"
                placeholder="{{'Duración' | translate}}"
                aria-label="Number"
                matInput
                [matAutocomplete]="auto"
                [(ngModel)]="courseFormGroup.controls['reserve_date'].value[i].Duracion" />
              <mat-autocomplete #auto="matAutocomplete"
                [displayWith]="displayFn">
                <mat-option
                  *ngFor="let hour of hours"
                  [value]="hour">
                  {{hour}}
                </mat-option>
              </mat-autocomplete>
              <mat-icon matSuffix svgIcon="mat:keyboard_arrow_down"></mat-icon>
            </mat-form-field>
          </div>
        </div>
        <div style="padding: 20px;border-top: 1px solid #DEE6EA;">
          <button
            style="border: 1px solid #222222; border-radius: 3px;float: inline-end;height: 38px;width: 110px;"
            type="button"
            (click)="courseFormGroup.controls['reserve_date'].value.push({ date:  nowDate, hour_start: '08:00', Duracion: 1 })"
            class="client-button">
            {{'Añadir fecha' | translate }}
          </button>
        </div>
        <div style="background-color: #E9E9E9;height: 20px;width: 100%;"> </div>
        <div>
          <div style="margin: 20px;">
            <span>
              {{'Descuentos según cantidad de fechas reservadas' | translate}}
            </span>
          </div>
          <div style="margin: 0 20px;"
            *ngFor="let item of courseFormGroup.controls['discount'].value, index as i">
            <mat-form-field appearance="outline"
              style="width: calc(49% - 20px);margin-right: 1%;">
              <mat-label>{{'courses.date_reservable' | translate}}</mat-label>
              <input
                [(ngModel)]="courseFormGroup.controls['discount'].value[i].day"
                type="text"
                placeholder="{{'N. fechas reservadas' | translate}}"
                matInput
                [matAutocomplete]="auto" />
              <mat-autocomplete #auto="matAutocomplete"
                [displayWith]="displayFn">
                <mat-option
                  *ngFor="let day of ndays"
                  [value]="day">
                  {{day}}
                </mat-option>
              </mat-autocomplete>
              <mat-icon matSuffix svgIcon="mat:keyboard_arrow_down"></mat-icon>
            </mat-form-field>
            <mat-form-field appearance="outline"
              style="width: calc(49% - 20px);margin-left:1%;">
              <mat-label>{{'Reducción % (0-100)' | translate}}</mat-label>
              <input
                [(ngModel)]="courseFormGroup.controls['discount'].value[i].reduccion"
                matInput required type="number">
              <span matTextSuffix>%</span>
            </mat-form-field>
            <mat-icon
              class="icon24"
              style="margin-left: 16px"
              [style.color]="i===0?'gray':'black'"
              [style.cursor]="i===0?'':'pointer'"
              (click)="i>0?courseFormGroup.controls['discount'].value.splice(i,1):''">delete</mat-icon>
          </div>
          <div style="margin: 0 20px;">
            <button
              (click)="courseFormGroup.controls['discount'].value.push({ day: 2, reduccion: 10 })"
              style="margin-top: 0px !important;height: 38px;"
              color="primary"
              mat-button
              type="button"
              class="client-button">
              <mat-icon>add</mat-icon>
              {{'Añadir descuento por fecha' | translate }}
            </button>
          </div>
        </div>
      </ng-container>
      <ng-container *ngIf="courseFormGroup.controls['course_type'].value>1">
        <mat-tab-group class="tabsWrapper" style="margin: 20px 20px 0;"
          (selectedIndexChange)="PeriodoFecha=$event;$event===0?courseFormGroup.patchValue({reserve_date:[courseFormGroup.controls['reserve_date'].value[0]]}):''"
          [selectedIndex]="courseFormGroup.controls['reserve_date'].value.length>1?1:0">
          <mat-tab>
            <ng-template mat-tab-label>
              Un periodo
            </ng-template>
          </mat-tab>
          <mat-tab>
            <ng-template mat-tab-label>
              Multiples periodos
            </ng-template>
          </mat-tab>
        </mat-tab-group>
        <div style=" display: flex; flex-direction: column;padding: 10px;">
          <div style="display: flex;column-gap: 20px;"
            *ngFor="let item of courseFormGroup.controls['reserve_date'].value;index as i">
            <ng-container *ngIf="PeriodoFecha>0 || i===0">
              <mat-form-field
                appearance="outline">
                <mat-label>{{'courses.date_reservable' |
                  translate}}</mat-label>
                <input
                  matInput
                  [matDatepicker]="date_inicio"
                  [min]="minDate"
                  [max]="maxDate"
                  [(ngModel)]="courseFormGroup.controls['reserve_date'].value[i].date" />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="date_inicio"></mat-datepicker-toggle>
                <mat-datepicker
                  #date_inicio
                  [startAt]="nowDate"></mat-datepicker>
              </mat-form-field>
              <mat-form-field
                appearance="outline">
                <mat-label>{{'courses.date_reservable' |
                  translate}}</mat-label>
                <input
                  matInput
                  [matDatepicker]="date_fin"
                  [min]="minDate"
                  [max]="maxDate"
                  [(ngModel)]="courseFormGroup.controls['reserve_date'].value[i].date_end" />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="date_fin"></mat-datepicker-toggle>
                <mat-datepicker
                  #date_fin
                  [startAt]="nowDate"></mat-datepicker>
              </mat-form-field>
            </ng-container>
          </div>
          <div *ngIf="PeriodoFecha>0">
            <button
              (click)="courseFormGroup.controls['reserve_date'].value.push({ date: nowDate, hour_start: '08:00',
              Duracion: '01:00', date_end: nowDate, hour_end: '09:00', Semana: [] })"
              style="margin-top: 0px !important;height: 38px; width: 200px;"
              color="primary"
              mat-button
              type="button"
              class="client-button">
              <mat-icon>add</mat-icon>
              {{'Añadir fecha' | translate }}
            </button>
          </div>
          <div
            style="display: flex; flex-wrap: wrap;gap: 16px;margin-bottom: 20px;">
            <mat-checkbox
              style="width: calc(25% - 16px);"
              (change)="selectAllweek($event)">
              {{"Cada día" | translate}}
            </mat-checkbox>
            <mat-checkbox *ngFor="let item of weekSelect"
              style="width: calc(25% - 16px);"
              [(ngModel)]="courseFormGroup.controls['settings'].value.weekDays[item]">
              {{item | translate}}
            </mat-checkbox>
          </div>
          <div style="display: flex;column-gap: 20px;">
            <mat-form-field appearance="outline">
              <mat-label>{{'hour' | translate}}</mat-label>
              <input
                type="text"
                placeholder="{{'hour' | translate}}"
                aria-label="Number"
                matInput
                [matAutocomplete]="auto"
                [(ngModel)]="courseFormGroup.controls['reserve_date'].value[0].hour_start" />
              <mat-autocomplete #auto="matAutocomplete"
                [displayWith]="displayFn">
                <mat-option
                  *ngFor="let hour of hours"
                  [value]="hour">
                  {{hour}}
                </mat-option>
              </mat-autocomplete>
              <mat-icon matSuffix
                svgIcon="mat:keyboard_arrow_down"></mat-icon>
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>{{'hour' | translate}}</mat-label>
              <input
                type="text"
                placeholder="{{'hour' | translate}}"
                aria-label="Number"
                matInput
                [matAutocomplete]="auto"
                [(ngModel)]="courseFormGroup.controls['reserve_date'].value[0].hour_end" />
              <mat-autocomplete #auto="matAutocomplete"
                [displayWith]="displayFn">
                <mat-option
                  *ngFor="let hour of hours"
                  [value]="hour">
                  {{hour}}
                </mat-option>
              </mat-autocomplete>
              <mat-icon matSuffix
                svgIcon="mat:keyboard_arrow_down"></mat-icon>
            </mat-form-field>
          </div>
        </div>
      </ng-container>
    </div>
    <div class="flex flex-col" *ngIf="ModalFlux===3">
      <ng-container *ngIf="courseFormGroup.controls['course_type'].value===1">
        <div class="level"
          style="width: 100%; height: 100%; padding: 10px; background: #D2EFFF; border-radius: 8px; justify-content: flex-start; align-items: center; gap: 8px; display: inline-flex">
          <mat-icon style="color: #006fcb;" class="icon24">info</mat-icon>
          <div
            style="flex: 1 1 0; color: #222222; font-size: 14px; font-weight: 400; line-height: 18px; word-wrap: break-word">Elije
            los niveles aquí. Podrás asignar los monitores en un segundo
            momento.
          </div>
        </div>
        <div class="level"
          style="display: flex;flex-direction: column;padding: 20px; border-radius: 8px; gap: 10px;">
          <ng-container *ngFor="let level of levels;index as i">
            <div style="display: flex;gap: 16px;">
              <mat-checkbox
                style="height: 46px; border-radius: 3px; min-width: 225px;font-size: 12px;align-content: space-evenly;"
                [style.backgroundColor]="courseFormGroup.controls['levelGrop'].value[i].active?level.color:level.color+'33'"
                [style.color]="level.color"
                [style.border]="'1px solid '+level.color"
                (click)="selectLevel($event,i) ">
                {{level.annotation}} {{level.level}}
              </mat-checkbox>
              <ng-container
                *ngIf="courseFormGroup.controls['levelGrop'].value[i].active">
                <mat-form-field appearance="outline">
                  <mat-label>{{'Edad mínima' | translate}}</mat-label>
                  <input matInput type="number"
                    [(ngModel)]="courseFormGroup.controls['levelGrop'].value[i].age_min">
                </mat-form-field>
                <mat-form-field appearance="outline">
                  <mat-label>{{'Edad máxima' | translate}}</mat-label>
                  <input matInput type="number"
                    [(ngModel)]="courseFormGroup.controls['levelGrop'].value[i].age_max">
                </mat-form-field>
                <mat-form-field appearance="outline">
                  <mat-label>{{'Participante máxima' | translate}}</mat-label>
                  <input matInput type="number"
                    [(ngModel)]="courseFormGroup.controls['levelGrop'].value[i].PartMax">
                </mat-form-field>
                <mat-icon
                  (click)="addLevelSubgroup(i,1)"
                  color="primary"
                  style="height: 46px;min-width: 30px;border-radius: 15px; cursor: pointer; font-size: 30px;align-content: space-evenly;">add</mat-icon>
              </ng-container>
            </div>
            <ng-container
              *ngFor="let item of [].constructor(courseFormGroup.controls['levelGrop'].value[i].Subgrupo); index as i">
              <div
                style="background-color: #EFF2F5; display: flex;width: 100%; height: 46px;justify-content: space-between;align-items: center; border-radius: 4px;padding: 10px;">
                {{level.annotation}} {{level.level}} {{("00"+(i+1)).slice(-2)}}
                <mat-icon
                  (click)="addLevelSubgroup(i,-1)"
                  style="height: 46px;width: 20px;cursor: pointer; font-size: 20px;align-content: space-evenly;">
                  delete </mat-icon>
              </div>
              <div style="width: 100%;height: 350px;">
                <vex-flux-disponibilidad
                  [courseFormGroup]="courseFormGroup"></vex-flux-disponibilidad>
              </div>
            </ng-container>
          </ng-container>
        </div>
      </ng-container>
      <ng-container *ngIf="courseFormGroup.controls['course_type'].value===2">
        <div class="table-container"
          style="overflow: auto;max-height: 100vh;">
          <table mat-table [dataSource]="hours" class="mat-elevation-z8"
            #scrollContainer>
            <ng-container matColumnDef="intervalo">
              <th mat-header-cell *matHeaderCellDef> {{'interval'|translate}}
              </th>
              <td mat-cell *matCellDef="let row"> {{row}} </td>
            </ng-container>
            <ng-container *ngFor="let col of displayedColumns.slice(1)"
              [matColumnDef]="col">
              <th mat-header-cell *matHeaderCellDef> {{col}} </th>
              <td mat-cell *matCellDef="let row">
                <mat-form-field appearance="outline" class="flex-auto">
                  <input class="flex-auto" matInput style="margin-top:3%">
                  <span matTextSuffix>CHF</span>
                </mat-form-field>
              </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>
      </ng-container>
      <ng-container *ngIf="courseFormGroup.controls['course_type'].value===3">
        <div
          *ngFor="let item of courseFormGroup.controls['categoryPart'].value, index as i">
          <div
            style="width: 100%;background-color: #EFF2F5;height: 60px;border-top: 1px solid #C7D0D3;padding: 0 24px;align-content: space-evenly;">
            <span>
              {{'CATEGORIA PARTICIPANTE  '+ (i+1)| translate}}
            </span>
            <mat-icon *ngIf="i!==0"
              (click)="courseFormGroup.controls['categoryPart'].value.splice(i,1)"
              style="cursor: pointer;float: inline-end;">delete</mat-icon>
          </div>
          <div
            style="margin: 20px 20px 0px; display: flex; flex-wrap: wrap; column-gap: 20px;">
            <mat-form-field appearance="outline">
              <mat-label>{{'Nombre categoría' | translate}}</mat-label>
              <input matInput type="text"
                [(ngModel)]="courseFormGroup.controls['categoryPart'].value[i].name">
            </mat-form-field>
            <mat-form-field appearance="outline"
              style="width: calc(50% - 10px);">
              <mat-label>{{'Edad mínma' | translate}}</mat-label>
              <input matInput type="number"
                [(ngModel)]="courseFormGroup.controls['categoryPart'].value[i].age_min">
            </mat-form-field>
            <mat-form-field appearance="outline"
              style="width: calc(50% - 10px);">
              <mat-label>{{'Edad máxima' | translate}}</mat-label>
              <input matInput type="number"
                [(ngModel)]="courseFormGroup.controls['categoryPart'].value[i].age_max">
            </mat-form-field>
            <mat-form-field appearance="outline"
              style="width: calc(50% - 10px);">
              <mat-label>{{'N. mín.' | translate}}</mat-label>
              <input matInput type="number"
                [(ngModel)]="courseFormGroup.controls['categoryPart'].value[i].num_min">
            </mat-form-field>
            <mat-form-field appearance="outline"
              style="width: calc(50% - 10px);">
              <mat-label>{{'N. máx' | translate}}</mat-label>
              <input matInput type="number"
                [(ngModel)]="courseFormGroup.controls['categoryPart'].value[i].num_max">
            </mat-form-field>
          </div>
        </div>
        <div style="padding: 20px;border-top: 1px solid #DEE6EA;">
          <button
            (click)="courseFormGroup.controls['categoryPart'].value.push({
            name: '',
            age_min: this.courseFormGroup.controls['age_min'].value || 0,
            age_max: this.courseFormGroup.controls['age_max'].value || 99,
            num_min: this.courseFormGroup.controls['participants'].value || 0,
            num_max: this.courseFormGroup.controls['participants'].value || 0,
          })"
            style="margin-top: 0px !important;height: 38px;"
            color="primary"
            mat-button
            type="button"
            class="client-button">
            <mat-icon>add</mat-icon>
            {{'Añadir categoria' | translate }}
          </button>
        </div>
      </ng-container>
    </div>
    <div class="flex flex-col" *ngIf="ModalFlux===4" style="padding: 24px;"
      [formGroup]="courseFormGroup">
      <section class="flex"
        style="flex-wrap: wrap;gap: 16px;justify-content: space-around;">
        <div
          style="color: black; font-size: 12px; font-weight: 400; line-height: 16px; margin-bottom: 20px;width: 100%;">
          Seleccionar los extras que pueden ser añadidos haciendo la reserva:
        </div>
        <ng-container
          *ngFor="let item of courseFormGroup.controls['course_type'].value===3?courseFormGroup.controls['categoryPart'].value:[1];index as i">
          <div
            style="width: 100%;background-color: #EFF2F5;height: 60px;border-top: 1px solid #C7D0D3;padding: 0 24px;align-content: space-evenly;">
            <span>
              {{courseFormGroup.controls['categoryPart'].value[i].name}}
            </span>
          </div>
          <div
            *ngFor="let item of extras"
            style="width: calc(50% - 8px); height: 64px; padding: 12px; border-radius: 3px; border: 1px #8B9099 solid; justify-content: flex-start; align-items: center; gap: 10px; display: inline-flex">
            <mat-checkbox [value]="item.id"
              (change)="selectExtra($event,item)">
            </mat-checkbox>
            <div
              style="flex-direction: column; justify-content: flex-start; align-items: flex-start; display: inline-flex">
              <div
                style="align-self: stretch; color: #222222; font-size: 14px; font-weight: 600; line-height: 18px; word-wrap: break-word">
                {{item.product}}
              </div>
              <div
                style="align-self: stretch; color: #8B9099; font-size: 12px; font-weight: 400; line-height: 16px; word-wrap: break-word">
                {{item.name}}
              </div>
            </div>
            <div
              style="flex: 1 1 0; text-align: right; color: #222222; font-size: 14px; font-weight: 400; line-height: 18px; word-wrap: break-word">
              {{item.price}} CHF/Día
            </div>
          </div>
          <div
            (click)="extrasModal=!extrasModal"
            style="width: calc(50% - 8px); height: 64px; padding-left: 12px; padding-right: 12px; padding-top: 10px; padding-bottom: 10px; border-radius: 3px; border: 1px #E91E63 dotted; flex-direction: column; justify-content: space-between; align-items: center; display: inline-flex;cursor: pointer;">
            <div style="width: 24px; height: 24px; position: relative">
              <mat-icon
                color="primary"
                style="height: 30px;min-width: 30px;border-radius: 15px; cursor: pointer; font-size: 30px;align-content: space-evenly;">add</mat-icon>
            </div>
            <div
              style="width: 259px; text-align: center; color: #E91E63; font-size: 14px; font-weight: 400; line-height: 18px; word-wrap: break-word">Crear
              extra</div>
          </div>
        </ng-container>
      </section>
    </div>
    <div class="flex flex-col" *ngIf="ModalFlux===5"
      [formGroup]="courseFormGroup">
      <mat-accordion>
        <mat-expansion-panel *ngFor="let item of Translate">
          <mat-expansion-panel-header
            style="background-color: #eff2f5; border-top: 1px #C7D0D3 solid;
          color: #222222;
          font-size: 14px;
          font-family: Montserrat;
          font-weight: 400;
          text-transform: uppercase;
          line-height: 20px;
          word-wrap: break-word">
            <mat-panel-title> {{item.Name | translate}} </mat-panel-title>
          </mat-expansion-panel-header>
          <ng-template matExpansionPanelContent>
            <mat-form-field appearance="outline"
              style="width: 100%;margin-top: 10px;">
              <mat-label>{{'courses.coursename' | translate}}</mat-label>
              <input id="courseName"
                [formControlName]="'course_name_'+item.Code"
                matInput required type="text">
            </mat-form-field>
            <div style="margin: 10px 0;">
              <angular-editor id="summary" style="width: 100%"
                [placeholder]="'courses.summary' | translate"
                [formControlName]="'summary_'+item.Code"
                [config]="editor1Config">
              </angular-editor>
            </div>
            <div style="margin: 20px 0;">
              <angular-editor id="description" style="width: 100%"
                [placeholder]="'courses.desc' | translate"
                [formControlName]="'description_'+item.Code"
                [config]="editor2Config">
              </angular-editor>
            </div>
          </ng-template>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
    <div style="margin: 20px;display: flex;justify-content: space-between;">
      <button
        *ngIf="ModalFlux>0"
        (click)="ModalFlux=ModalFlux-1"
        style="margin-top: 0px !important;height: 38px; width: 128px;"
        color="primary"
        mat-button
        type="button"
        class="client-button">
        <mat-icon>arrow_back</mat-icon>
        {{'Atrás' | translate }}
      </button>
      <button
        (click)="Confirm(1);"
        style="margin-top: 0px !important;height: 38px; width: 128px;margin-left: auto;"
        color="primary"
        mat-raised-button
        type="button"
        class="client-button">
        {{mode==='create'?'Confirmar':'Seguiente' | translate }}
      </button>
    </div>
  </div>
  <vex-course-detail-card
    card
    *ngIf="!loading"
    [mode]="mode"
    [courseFormGroup]="courseFormGroup">
  </vex-course-detail-card>
  <vex-course-detail-card
    card2
    *ngIf="!loading"
    [mode]="mode"
    [courseFormGroup]="courseFormGroup">
  </vex-course-detail-card>
</vex-flux-layout>

<vex-flux-modal *ngIf="extrasModal" (Close)="extrasModal=false"
  [width]="670" title="Crear extra">
  <div body style="display: flex; column-gap: 20px; flex-wrap: wrap;"
    [formGroup]="extrasFormGroup">
    <mat-form-field appearance="outline"
      style="width: calc(50% - 10px);margin-top: 10px;">
      <mat-label>{{'Producto' | translate}}</mat-label>
      <input matInput required type="text"
        formControlName="product">
    </mat-form-field>
    <mat-form-field appearance="outline"
      style="width: calc(50% - 10px);margin-top: 10px;">
      <mat-label>{{'Nombre' | translate}}</mat-label>
      <input matInput required type="text" formControlName="name">
    </mat-form-field>
    <mat-form-field appearance="outline"
      style="width: calc(50% - 10px)">
      <mat-label>{{'Precio por día' | translate}}</mat-label>
      <input matInput required type="number" formControlName="price">
    </mat-form-field>
    <mat-form-field appearance="outline"
      style="width: calc(50% - 10px)">
      <mat-label>{{'IVA' | translate}}</mat-label>
      <input matInput required type="number" formControlName="iva">
    </mat-form-field>
    <div style="width: 100%">
      <mat-slide-toggle [checked]="true"> Activo </mat-slide-toggle>
    </div>
    <button
      style="margin-top: 0px !important;height: 38px; width: 128px;margin-left: auto;"
      color="primary"
      mat-stroked-button
      (click)="extrasModal=false"
      type="button"
      class="client-button">
      {{'Cancelar' | translate }}
    </button>
    <button
      style="margin-top: 0px !important;height: 38px; width: 128px;"
      color="primary"
      mat-raised-button
      (click)="extrasModal=false;extras.push(extrasFormGroup.getRawValue());extrasFormGroup.reset()"
      type="button"
      class="client-button">
      {{'Crear extras' | translate }}
    </button>
  </div>
</vex-flux-modal>

<vex-flux-modal *ngIf="confirmModal" (Close)="confirmModal=false"
  [width]="670" title="Casi estás!">
  <div body style="display: flex; gap: 20px; flex-wrap: wrap;">
    <div
      style="width: 100;
        color: black;
    font-size: 14px;
    font-weight: 400;
    line-height: 18px;
    word-wrap: break-word">
      {{mode==='create'?"El curso ha sido creado!":""}} Confirma estas
      opciones:
    </div>
    <div style="width: 100%">
      <mat-slide-toggle [checked]="true">
        <span style="
        color: #222222;
        font-size: 14px;
        font-weight: 600;
        line-height: 18px;
        word-wrap: break-word">
          {{"Visible en la página de reservas" | translate}}
        </span>
        <br>
        <span style="
        color: #8B9099;
        font-size: 12px;
        font-weight: 400;
        line-height: 16px;
        word-wrap: break-word">
          {{"El curso serà visible y online desde ahora" | translate}}
        </span>
      </mat-slide-toggle>
    </div>
    <div style="width: 100%">
      <mat-slide-toggle [checked]="true">
        <span style="
        color: #222222;
        font-size: 14px;
        font-weight: 600;
        line-height: 18px;
        word-wrap: break-word">
          {{"Activo" | translate}}
        </span>
        <br>
        <span style="
        color: #8B9099;
        font-size: 12px;
        font-weight: 400;
        line-height: 16px;
        word-wrap: break-word">
          {{"El curso es activo y reservable" | translate}}
        </span>
      </mat-slide-toggle>
    </div>
    <button
      style="margin-top: 0px !important;height: 38px; width: 128px;margin-left: auto;"
      color="primary"
      mat-stroked-button
      (click)="confirmModal=false"
      type="button"
      class="client-button">
      {{'Cancelar' | translate }}
    </button>
    <button
      style="margin-top: 0px !important;height: 38px; width: 200px;"
      color="primary"
      mat-raised-button
      (click)="confirmModal=false"
      type="button"
      class="client-button">
      {{mode==='create'?'Finalizar creación curso':'Finalizar edición curso' |
      translate }}
    </button>
  </div>
</vex-flux-modal>